See discussions, stats, and author profiles for this publication at: https://www.researchgate.net/publication/202924343
Stochastic Differential Equations: An Introduction with Applications
Book in Journal of the American Statistical Association · January 2000
DOI: 10.1007/978-3-662-03185-8

CITATIONS
2,583
1 author: Bernt Øksendal University of Oslo 351 PUBLICATIONS 13,542 CITATIONS
SEE PROFILE

READS
10,182

Some of the authors of this publication are also working on these related projects: Stochastic integration and differentiation View project

All content following this page was uploaded by Bernt Øksendal on 16 May 2014.
The user has requested enhancement of the downloaded file.

Bernt Øksendal
Stochastic Differential Equations
An Introduction with Applications Fifth Edition, Corrected Printing Springer-Verlag Heidelberg New York
Springer-Verlag
Berlin Heidelberg NewYork London Paris Tokyo Hong Kong Barcelona Budapest

To My Family Eva, Elise, Anders and Karina

2

The front cover shows four sample paths Xt(1), Xt(2), Xt(3) and Xt(4) of a geometric Brownian motion Xt(), i.e. of the solution of a (1-dimensional) stochastic differential equation of the form

dXt dt

= (r

+  · Wt)Xt

t  0 ; X0 = x

where x, r and  are constants and Wt = Wt() is white noise. This process is often used to model "exponential growth under uncertainty". See Chapters 5,
10, 11 and 12.
The figure is a computer simulation for the case x = r = 1,  = 0.6.
The mean value of Xt, E[Xt] = exp(t), is also drawn. Courtesy of Jan Ubøe, Stord/Haugesund College.

We have not succeeded in answering all our problems. The answers we have found only serve to raise a whole set of new questions. In some ways we feel we are as confused as ever, but we believe we are confused on a higher level and about more important things.
Posted outside the mathematics reading room,
Tromsø University

Preface to Corrected Printing, Fifth Edition
The main corrections and improvements in this corrected printing are from Chaper 12. I have benefitted from useful comments from a number of people, including (in alphabetical order) Fredrik Dahl, Simone Deparis, Ulrich Haussmann, Yaozhong Hu, Marianne Huebner, Carl Peter Kirkebø, Nikolay Kolev, Takashi Kumagai, Shlomo Levental, Geir Magnussen, Anders Øksendal, Ju¨rgen Potthoff, Colin Rowat, Stig Sandnes, Lones Smith, Setsuo Taniguchi and Bjørn Thunestvedt.
I want to thank them all for helping me making the book better. I also want to thank Dina Haraldsson for proficient typing.
Blindern, May 2000 Bernt Øksendal

VI

Preface to the Fifth Edition

The main new feature of the fifth edition is the addition of a new chapter, Chapter 12, on applications to mathematical finance. I found it natural to include this material as another major application of stochastic analysis, in view of the amazing development in this field during the last 10­20 years. Moreover, the close contact between the theoretical achievements and the applications in this area is striking. For example, today very few firms (if any) trade with options without consulting the Black & Scholes formula!
The first 11 chapters of the book are not much changed from the previous edition, but I have continued my efforts to improve the presentation throughout and correct errors and misprints. Some new exercises have been added. Moreover, to facilitate the use of the book each chapter has been divided into subsections. If one doesn't want (or doesn't have time) to cover all the chapters, then one can compose a course by choosing subsections from the chapters. The chart below indicates what material depends on which sections.

Chapter 1-5

Chapter 6

Chapter 8

Section 8.6

Chapter 7 Chapter 10

Section Chapter 9 9.1 Chapter 11

Chapter 12 Section 12.3
For example, to cover the first two sections of the new chapter 12 it is recommended that one (at least) covers Chapters 1­5, Chapter 7 and Section 8.6.

VIII
Chapter 10, and hence Section 9.1, are necessary additional background for Section 12.3, in particular for the subsection on American options.
In my work on this edition I have benefitted from useful suggestions from many people, including (in alphabetical order) Knut Aase, Luis Alvarez, Peter Christensen, Kian Esteghamat, Nils Christian Framstad, Helge Holden, Christian Irgens, Saul Jacka, Naoto Kunitomo and his group, Sure Mataramvura, Trond Myhre, Anders Øksendal, Nils Øvrelid, Walter Schachermayer, Bjarne Schielderop, Atle Seierstad, Jan Ubøe, Gjermund V°age and Dan Zes. I thank them all for their contributions to the improvement of the book.
Again Dina Haraldsson demonstrated her impressive skills in typing the manuscript ­ and in finding her way in the LATEX jungle! I am very grateful for her help and for her patience with me and all my revisions, new versions and revised revisions . . .
Blindern, January 1998 Bernt Øksendal

Preface to the Fourth Edition

In this edition I have added some material which is particularly useful for the applications, namely the martingale representation theorem (Chapter IV), the variational inequalities associated to optimal stopping problems (Chapter X) and stochastic control with terminal conditions (Chapter XI). In addition solutions and extra hints to some of the exercises are now included. Moreover, the proof and the discussion of the Girsanov theorem have been changed in order to make it more easy to apply, e.g. in economics. And the presentation in general has been corrected and revised throughout the text, in order to make the book better and more useful.
During this work I have benefitted from valuable comments from several persons, including Knut Aase, Sigmund Berntsen, Mark H. A. Davis, Helge Holden, Yaozhong Hu, Tom Lindstrøm, Trygve Nilsen, Paulo Ruffino, Isaac Saias, Clint Scovel, Jan Ubøe, Suleyman Ustunel, Qinghua Zhang, Tusheng Zhang and Victor Daniel Zurkowski. I am grateful to them all for their help.
My special thanks go to H°akon Nyhus, who carefully read large portions of the manuscript and gave me a long list of improvements, as well as many other useful suggestions.
Finally I wish to express my gratitude to Tove Møller and Dina Haraldsson, who typed the manuscript with impressive proficiency.

Oslo, June 1995

Bernt Øksendal

X

Preface to the Third Edition

The main new feature of the third edition is that exercises have been included to each of the chapters II­XI. The purpose of these exercises is to help the reader to get a better understanding of the text. Some of the exercises are quite routine, intended to illustrate the results, while other exercises are harder and more challenging and some serve to extend the theory.
I have also continued the effort to correct misprints and errors and to improve the presentation. I have benefitted from valuable comments and suggestions from Mark H. A. Davis, H°akon Gjessing, Torgny Lindvall and H°akon Nyhus, My best thanks to them all.
A quite noticeable non-mathematical improvement is that the book is now typed in TE X. Tove Lieberg did a great typing job (as usual) and I am very grateful to her for her effort and infinite patience.

Oslo, June 1991

Bernt Øksendal

XII

Preface to the Second Edition

In the second edition I have split the chapter on diffusion processes in two, the new Chapters VII and VIII: Chapter VII treats only those basic properties of diffusions that are needed for the applications in the last 3 chapters. The readers that are anxious to get to the applications as soon as possible can therefore jump directly from Chapter VII to Chapters IX, X and XI.
In Chapter VIII other important properties of diffusions are discussed. While not strictly necessary for the rest of the book, these properties are central in today's theory of stochastic analysis and crucial for many other applications.
Hopefully this change will make the book more flexible for the different purposes. I have also made an effort to improve the presentation at some points and I have corrected the misprints and errors that I knew about, hopefully without introducing new ones. I am grateful for the responses that I have received on the book and in particular I wish to thank Henrik Martens for his helpful comments.
Tove Lieberg has impressed me with her unique combination of typing accuracy and speed. I wish to thank her for her help and patience, together with Dina Haraldsson and Tone Rasmussen who sometimes assisted on the typing.

Oslo, August 1989

Bernt Øksendal

XIV

Preface to the First Edition
These notes are based on a postgraduate course I gave on stochastic differential equations at Edinburgh University in the spring 1982. No previous knowledge about the subject was assumed, but the presentation is based on some background in measure theory.
There are several reasons why one should learn more about stochastic differential equations: They have a wide range of applications outside mathematics, there are many fruitful connections to other mathematical disciplines and the subject has a rapidly developing life of its own as a fascinating research field with many interesting unanswered questions.
Unfortunately most of the literature about stochastic differential equations seems to place so much emphasis on rigor and completeness that it scares many nonexperts away. These notes are an attempt to approach the subject from the nonexpert point of view: Not knowing anything (except rumours, maybe) about a subject to start with, what would I like to know first of all? My answer would be:
1) In what situations does the subject arise? 2) What are its essential features? 3) What are the applications and the connections to other fields?
I would not be so interested in the proof of the most general case, but rather in an easier proof of a special case, which may give just as much of the basic idea in the argument. And I would be willing to believe some basic results without proof (at first stage, anyway) in order to have time for some more basic applications.
These notes reflect this point of view. Such an approach enables us to reach the highlights of the theory quicker and easier. Thus it is hoped that these notes may contribute to fill a gap in the existing literature. The course is meant to be an appetizer. If it succeeds in awaking further interest, the reader will have a large selection of excellent literature available for the study of the whole story. Some of this literature is listed at the back.
In the introduction we state 6 problems where stochastic differential equations play an essential role in the solution. In Chapter II we introduce the basic mathematical notions needed for the mathematical model of some of these problems, leading to the concept of Ito integrals in Chapter III. In Chapter IV we develop the stochastic calculus (the Ito formula) and in Chap-

XVI

ter V we use this to solve some stochastic differential equations, including the first two problems in the introduction. In Chapter VI we present a solution of the linear filtering problem (of which problem 3 is an example), using the stochastic calculus. Problem 4 is the Dirichlet problem. Although this is purely deterministic we outline in Chapters VII and VIII how the introduction of an associated Ito diffusion (i.e. solution of a stochastic differential equation) leads to a simple, intuitive and useful stochastic solution, which is the cornerstone of stochastic potential theory. Problem 5 is an optimal stopping problem. In Chapter IX we represent the state of a game at time t by an Ito diffusion and solve the corresponding optimal stopping problem. The solution involves potential theoretic notions, such as the generalized harmonic extension provided by the solution of the Dirichlet problem in Chapter VIII. Problem 6 is a stochastic version of F.P. Ramsey's classical control problem from 1928. In Chapter X we formulate the general stochastic control problem in terms of stochastic differential equations, and we apply the results of Chapters VII and VIII to show that the problem can be reduced to solving the (deterministic) Hamilton-Jacobi-Bellman equation. As an illustration we solve a problem about optimal portfolio selection.
After the course was first given in Edinburgh in 1982, revised and expanded versions were presented at Agder College, Kristiansand and University of Oslo. Every time about half of the audience have come from the applied section, the others being so-called "pure" mathematicians. This fruitful combination has created a broad variety of valuable comments, for which I am very grateful. I particularly wish to express my gratitude to K.K. Aase, L. Csink and A.M. Davie for many useful discussions.
I wish to thank the Science and Engineering Research Council, U.K. and Norges Almenvitenskapelige Forskningsr°ad (NAVF), Norway for their financial support. And I am greatly indebted to Ingrid Skram, Agder College and Inger Prestbakken, University of Oslo for their excellent typing ­ and their patience with the innumerable changes in the manuscript during these two years.

Oslo, June 1985

Bernt Øksendal

Note: Chapters VIII, IX, X of the First Edition have become Chapters IX, X, XI of the Second Edition.

Table of Contents
1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 1.1 Stochastic Analogs of Classical Differential Equations . . . . . . . 1 1.2 Filtering Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.3 Stochastic Approach to Deterministic Boundary Value Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.4 Optimal Stopping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 1.5 Stochastic Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 1.6 Mathematical Finance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
2. Some Mathematical Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . 7 2.1 Probability Spaces, Random Variables and Stochastic Processes 7 2.2 An Important Example: Brownian Motion . . . . . . . . . . . . . . . . . 11 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
3. It^o Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 3.1 Construction of the It^o Integral . . . . . . . . . . . . . . . . . . . . . . . . . . 21 3.2 Some properties of the It^o integral . . . . . . . . . . . . . . . . . . . . . . . . 30 3.3 Extensions of the It^o integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
4. The It^o Formula and the Martingale Representation Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43 4.1 The 1-dimensional It^o formula . . . . . . . . . . . . . . . . . . . . . . . . . . . 43 4.2 The Multi-dimensional It^o Formula . . . . . . . . . . . . . . . . . . . . . . . 48 4.3 The Martingale Representation Theorem . . . . . . . . . . . . . . . . . . 49 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
5. Stochastic Differential Equations . . . . . . . . . . . . . . . . . . . . . . . . . 61 5.1 Examples and Some Solution Methods . . . . . . . . . . . . . . . . . . . . 61 5.2 An Existence and Uniqueness Result . . . . . . . . . . . . . . . . . . . . . . 66 5.3 Weak and Strong Solutions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72

XVIII Table of Contents
6. The Filtering Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81 6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81 6.2 The 1-Dimensional Linear Filtering Problem . . . . . . . . . . . . . . . 83 6.3 The Multidimensional Linear Filtering Problem . . . . . . . . . . . . 102 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
7. Diffusions: Basic Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109 7.1 The Markov Property . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109 7.2 The Strong Markov Property . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112 7.3 The Generator of an It^o Diffusion . . . . . . . . . . . . . . . . . . . . . . . . 117 7.4 The Dynkin Formula . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120 7.5 The Characteristic Operator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
8. Other Topics in Diffusion Theory . . . . . . . . . . . . . . . . . . . . . . . . . 133 8.1 Kolmogorov's Backward Equation. The Resolvent . . . . . . . . . . 133 8.2 The Feynman-Kac Formula. Killing . . . . . . . . . . . . . . . . . . . . . . . 137 8.3 The Martingale Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140 8.4 When is an It^o Process a Diffusion? . . . . . . . . . . . . . . . . . . . . . . . 142 8.5 Random Time Change . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147 8.6 The Girsanov Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 160
9. Applications to Boundary Value Problems . . . . . . . . . . . . . . . . 167 9.1 The Combined Dirichlet-Poisson Problem. Uniqueness . . . . . . . 167 9.2 The Dirichlet Problem. Regular Points . . . . . . . . . . . . . . . . . . . . 169 9.3 The Poisson Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188
10. Application to Optimal Stopping . . . . . . . . . . . . . . . . . . . . . . . . . 195 10.1 The Time-Homogeneous Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195 10.2 The Time-Inhomogeneous Case . . . . . . . . . . . . . . . . . . . . . . . . . . 207 10.3 Optimal Stopping Problems Involving an Integral . . . . . . . . . . . 212 10.4 Connection with Variational Inequalities . . . . . . . . . . . . . . . . . . . 214 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
11. Application to Stochastic Control . . . . . . . . . . . . . . . . . . . . . . . . . 225 11.1 Statement of the Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225 11.2 The Hamilton-Jacobi-Bellman Equation . . . . . . . . . . . . . . . . . . . 227 11.3 Stochastic control problems with terminal conditions . . . . . . . . 241 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 243

Table of Contents XIX
12. Application to Mathematical Finance . . . . . . . . . . . . . . . . . . . . . 249 12.1 Market, portfolio and arbitrage . . . . . . . . . . . . . . . . . . . . . . . . . . . 249 12.2 Attainability and Completeness . . . . . . . . . . . . . . . . . . . . . . . . . . 259 12.3 Option Pricing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 267 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 288
Appendix A: Normal Random Variables . . . . . . . . . . . . . . . . . . . . . . 295
Appendix B: Conditional Expectation . . . . . . . . . . . . . . . . . . . . . . . . 299
Appendix C: Uniform Integrability and Martingale Convergence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 301
Appendix D: An Approximation Result . . . . . . . . . . . . . . . . . . . . . . . 305
Solutions and Additional Hints to Some of the Exercises . . . . . . 309
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 317
List of Frequently Used Notation and Symbols . . . . . . . . . . . . . . . 325
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 329

1. Introduction

To convince the reader that stochastic differential equations is an important subject let us mention some situations where such equations appear and can be used:

1.1 Stochastic Analogs of Classical Differential Equations

If we allow for some randomness in some of the coefficients of a differential equation we often obtain a more realistic mathematical model of the situation.

Problem 1. Consider the simple population growth model

dN dt

= a(t)N (t),

N (0) = N0 (constant)

(1.1.1)

where N (t) is the size of the population at time t, and a(t) is the relative rate of growth at time t. It might happen that a(t) is not completely known, but subject to some random environmental effects, so that we have

a(t) = r(t) + "noise" ,

where we do not know the exact behaviour of the noise term, only its probability distribution. The function r(t) is assumed to be nonrandom. How do we solve (1.1.1) in this case?

Problem 2. The charge Q(t) at time t at a fixed point in an electric circuit satisfies the differential equation

L·Q

(t) + R · Q (t) +

1 C

· Q(t) = F (t),

Q(0) = Q0,

Q (0) = I0

(1.1.2)

where L is inductance, R is resistance, C is capacitance and F (t) the potential source at time t.
Again we may have a situation where some of the coefficients, say F (t), are not deterministic but of the form

F (t) = G(t) + "noise" .

(1.1.3)

2

1. Introduction

How do we solve (1.1.2) in this case? More generally, the equation we obtain by allowing randomness in the
coefficients of a differential equation is called a stochastic differential equation. This will be made more precise later. It is clear that any solution of a stochastic differential equation must involve some randomness, i.e. we can only hope to be able to say something about the probability distributions of the solutions.

1.2 Filtering Problems

Problem 3. Suppose that we, in order to improve our knowledge about the solution, say of Problem 2, perform observations Z(s) of Q(s) at times s  t. However, due to inaccuracies in our measurements we do not really measure Q(s) but a disturbed version of it:

Z(s) = Q(s) + "noise" .

(1.2.1)

So in this case there are two sources of noise, the second coming from the error of measurement.
The filtering problem is: What is the best estimate of Q(t) satisfying (1.1.2), based on the observations Zs in (1.2.1), where s  t ? Intuitively, the problem is to "filter" the noise away from the observations in an optimal way.
In 1960 Kalman and in 1961 Kalman and Bucy proved what is now known as the Kalman-Bucy filter. Basically the filter gives a procedure for estimating the state of a system which satisfies a "noisy" linear differential equation, based on a series of "noisy" observations.
Almost immediately the discovery found applications in aerospace engineering (Ranger, Mariner, Apollo etc.) and it now has a broad range of applications.
Thus the Kalman-Bucy filter is an example of a recent mathematical discovery which has already proved to be useful ­ it is not just "potentially" useful.
It is also a counterexample to the assertion that "applied mathematics is bad mathematics" and to the assertion that "the only really useful mathematics is the elementary mathematics". For the Kalman-Bucy filter ­ as the whole subject of stochastic differential equations ­ involves advanced, interesting and first class mathematics.

1.3 Stochastic Approach to Deterministic Boundary Value Problems
Problem 4. The most celebrated example is the stochastic solution of the Dirichlet problem:

1.4 Optimal Stopping

3

Given a (reasonable) domain U in Rn and a continuous function f on the boundary of U, U . Find a function f~ continuous on the closure
U of U such that (i) f~ = f on U (ii) f~ is harmonic in U , i.e.

f~: =

n i=1

2f~ x2i

=

0

in U .

In 1944 Kakutani proved that the solution could be expressed in terms of Brownian motion (which will be constructed in Chapter 2): f~(x) is the expected value of f at the first exit point from U of the Brownian motion starting at x  U .
It turned out that this was just the tip of an iceberg: For a large class of semielliptic second order partial differential equations the corresponding Dirichlet boundary value problem can be solved using a stochastic process which is a solution of an associated stochastic differential equation.

1.4 Optimal Stopping

Problem 5. Suppose a person has an asset or resource (e.g. a house, stocks, oil...) that she is planning to sell. The price Xt at time t of her asset on the open market varies according to a stochastic differential equation of the same type as in Problem 1:

dXt dt

=

rXt

+ Xt

·

"noise"

where r,  are known constants. The discount rate is a known constant . At what time should she decide to sell?
We assume that she knows the behaviour of Xs up to the present time t, but because of the noise in the system she can of course never be sure at the time of the sale if her choice of time will turn out to be the best. So what we are searching for is a stopping strategy that gives the best result in the long run, i.e. maximizes the expected profit when the inflation is taken into account.
This is an optimal stopping problem. It turns out that the solution can be expressed in terms of the solution of a corresponding boundary value problem (Problem 4), except that the boundary is unknown (free) as well and this is compensated by a double set of boundary conditions. It can also be expressed in terms of a set of variational inequalities.

4

1. Introduction

1.5 Stochastic Control
Problem 6 (An optimal portfolio problem). Suppose that a person has two possible investments:

(i) A risky investment (e.g. a stock), where the price p1(t) per unit at time t satisfies a stochastic differential equation of the type discussed in Prob-

lem 1:

dp1 dt

=

(a +  · "noise")p1

(1.5.1)

where a > 0 and   R are constants

(ii) A safe investment (e.g. a bond), where the price p2(t) per unit at time t

grows exponentially:

dp2 dt

=

bp2

(1.5.2)

where b is a constant, 0 < b < a.

At each instant t the person can choose how large portion (fraction)
ut of his fortune Xt he wants to place in the risky investment, thereby placing (1 - ut)Xt in the safe investment. Given a utility function U and a terminal time T the problem is to find the optimal portfolio ut  [0, 1] i.e. find the investment distribution ut; 0  t  T which maximizes the expected utility of the corresponding terminal fortune XT(u):

max
0ut 1

E

U (XT(u))

(1.5.3)

1.6 Mathematical Finance
Problem 7 (Pricing of options). Suppose that at time t = 0 the person in Problem 6 is offered the right (but without obligation) to buy one unit of the risky asset at a specified price K and at a specified future time t = T . Such a right is called a European call option. How much should the person be willing to pay for such an option? This problem was solved when Fischer Black and Myron Scholes (1973) used stochastic analysis and an equlibrium argument to compute a theoretical value for the price, the now famous Black and Scholes option price formula. This theoretical value agreed well with the prices that had already been established as an equilibrium price on the free market. Thus it represented a triumph for mathematical modelling in finance. It has become an indispensable tool in the trading of options and other financial derivatives. In 1997 Myron Scholes and Robert Merton were awarded the Nobel Prize

1.6 Mathematical Finance

5

in Economics for their work related to this formula. (Fischer Black died in 1995.)
We will return to these problems in later chapters, after having developed the necessary mathematical machinery. We solve Problem 1 and Problem 2 in Chapter 5. Problems involving filtering (Problem 3) are treated in Chapter 6, the generalized Dirichlet problem (Problem 4) in Chapter 9. Problem 5 is solved in Chapter 10 while stochastic control problems (Problem 6) are discussed in Chapter 11. Finally we discuss applications to mathematical finance in Chapter 12.

6

1. Introduction

2. Some Mathematical Preliminaries
2.1 Probability Spaces, Random Variables and Stochastic Processes
Having stated the problems we would like to solve, we now proceed to find reasonable mathematical notions corresponding to the quantities mentioned and mathematical models for the problems. In short, here is a first list of the notions that need a mathematical interpretation: (1) A random quantity (2) Independence (3) Parametrized (discrete or continuous) families of random quantities (4) What is meant by a "best" estimate in the filtering problem (Problem 3) (5) What is meant by an estimate "based on" some observations (Prob-
lem 3)? (6) What is the mathematical interpretation of the "noise" terms? (7) What is the mathematical interpretation of the stochastic differential
equations? In this chapter we will discuss (1)­(3) briefly. In the next chapter we will consider (6), which leads to the notion of an It^o stochastic integral (7). In Chapter 6 we will consider (4)­(5). The mathematical model for a random quantity is a random variable. Before we define this, we recall some concepts from general probability theory. The reader is referred to e.g. Williams (1991) for more information. Definition 2.1.1. If  is a given set, then a -algebra F on  is a family F of subsets of  with the following properties:
(i)   F (ii) F  F  F C  F , where F C =  \ F is the complement of F in 

(iii) A1, A2, . . .  F  A: = Ai  F
i=1
The pair (, F) is called a measurable space. A probability measure P on a measurable space (, F) is a function P : F - [0, 1] such that (a) P () = 0, P () = 1

8

2. Some Mathematical Preliminaries

(b) if A1, A2, . . .  F and {Ai} i=1 is disjoint (i.e. Ai  Aj =  if i = j) then





P

Ai = P (Ai) .

i=1

i=1

The triple (, F, P ) is called a probability space. It is called a complete probability space if F contains all subsets G of  with P -outer measure zero, i.e. with
P (G): = inf{P (F ); F  F , G  F } = 0 .

Any probability space can be made complete simply by adding to F all sets of outer measure 0 and by extending P accordingly.
The subsets F of  which belong to F are called F-measurable sets. In a probability context these sets are called events and we use the interpretation

P (F ) = "the probability that the event F occurs" .

In particular, if P (F ) = 1 we say that "F occurs with probability 1", or "almost surely (a.s.)".
Given any family U of subsets of  there is a smallest -algebra HU containing U , namely

HU = {H; H -algebra of , U  H} .

(See Exercise 2.3.) We call HU the -algebra generated by U . For example, if U is the collection of all open subsets of a topological
space  (e.g.  = Rn), then B = HU is called the Borel -algebra on  and the elements B  B are called Borel sets. B contains all open sets, all closed sets, all countable unions of closed sets, all countable intersections of such countable unions etc.
If (, F , P ) is a given probability space, then a function Y :   Rn is called F-measurable if
Y -1(U ): = {  ; Y ()  U }  F
for all open sets U  Rn (or, equivalently, for all Borel sets U  Rn). If X:   Rn is any function, then the -algebra HX generated by X is
the smallest -algebra on  containing all the sets
X-1(U ) ; U  Rn open .

It is not hard to show that
HX = {X-1(B); B  B} ,
where B is the Borel -algebra on Rn. Clearly, X will then be HX -measurable and HX is the smallest -algebra with this property.
The following result is useful. It is a special case of a result sometimes called the Doob-Dynkin lemma. See e.g. M. M. Rao (1984), Prop. 3, p. 7.

2.1 Probability Spaces, Random Variables and Stochastic Processes

9

Lemma 2.1.2. If X, Y :   Rn are two given functions,then Y is HX measurable if and only if there exists a Borel measurable function g: Rn  Rn such that
Y = g(X) .
In the following we let (, F, P ) denote a given complete probability space. A random variable X is an F -measurable function X:   Rn. Every random variable induces a probability measure µX on Rn, defined by
µX (B) = P (X-1(B)) .
µX is called the distribution of X. If |X()|dP () <  then the number


E[X]: = X()dP () = xdµX (x)



Rn

is called the expectation of X (w.r.t. P ). More generally, if f : Rn  R is Borel measurable and
|f (X())|dP () <  then we have


E[f (X)]: = f (X())dP () = f (x)dµX (x) .



Rn

The mathematical model for independence is the following:

Definition 2.1.3. Two subsets A, B  F are called independent if

P (A  B) = P (A) · P (B) .

A collection A = {Hi; i  I} of families Hi of measurable sets is independent if
P (Hi1  · · ·  Hik ) = P (Hi1 ) · · · P (Hik )
for all choices of Hi1  Hi1 , · · · , Hik  Hik with different indices i1, . . . , ik. A collection of random variables {Xi; i  I} is independent if the collec-
tion of generated -algebras HXi is independent.
If two random variables X, Y :   R are independent then

E[XY ] = E[X]E[Y ] ,

provided that E[|X|] <  and E[|Y |] < . (See Exercise 2.5.)

Definition 2.1.4. A stochastic process is a parametrized collection of random variables
{Xt}tT
defined on a probability space (, F, P ) and assuming values in Rn.

10

2. Some Mathematical Preliminaries

The parameter space T is usually (as in this book) the halfline [0, ), but
it may also be an interval [a, b], the non-negative integers and even subsets of Rn for n  1. Note that for each t  T fixed we have a random variable

  Xt() ;    . On the other hand, fixing    we can consider the function

t  Xt() ; t  T
which is called a path of Xt. It may be useful for the intuition to think of t as "time" and each 
as an individual "particle" or "experiment". With this picture Xt() would represent the position (or result) at time t of the particle (experiment) . Sometimes it is convenient to write X(t, ) instead of Xt(). Thus we may also regard the process as a function of two variables

(t, )  X(t, )

from T ×  into Rn. This is often a natural point of view in stochastic
analysis, because (as we shall see) there it is crucial to have X(t, ) jointly measurable in (t, ).
Finally we note that we may identify each  with the function t  Xt() from T into Rn. Thus we may regard  as a subset of the space  = (Rn)T of all functions from T into Rn. Then the -algebra F will contain the -algebra B generated by sets of the form

{; (t1)  F1, · · · , (tk)  Fk} , Fi  Rn Borel sets

(B is the same as the Borel -algebra on  if T = [0, ) and  is given the product topology). Therefore one may also adopt the point of view that a stochastic process is a probability measure P on the measurable space ((Rn)T , B).
The (finite-dimensional) distributions of the process X = {Xt}tT are the measures µt1,...,tk defined on Rnk, k = 1, 2, . . ., by

µt1,...,tk (F1 × F2 × · · · × Fk) = P [Xt1  F1, · · · , Xtk  Fk] ;

ti  T .

Here F1, . . . , Fk denote Borel sets in Rn. The family of all finite-dimensional distributions determine many (but
not all) important properties of the process X. Conversely, given a family {t1,...,tk ; k  N, ti  T } of probability mea-
sures on Rnk it is important to be able to construct a stochastic process Y = {Yt}tT having t1,...,tk as its finite-dimensional distributions. One of Kolmogorov's famous theorems states that this can be done provided {t1,...,tk } satisfies two natural consistency conditions: (See Lamperti (1977).)

2.2 An Important Example: Brownian Motion

11

Theorem 2.1.5 (Kolmogorov's extension theorem). For all t1, . . . , tk  T , k  N let t1,...,tk be probability measures on Rnk s.t.

 (F t(1),···,t(k) 1 × · · · × Fk) = t1,···,tk (F-1(1) × · · · × F-1(k)) for all permutations  on {1, 2, . . . , k} and

(K1)

t1,...,tk (F1×· · ·×Fk) = t1,...,tk,tk+1,...,tk+m (F1×· · ·×Fk ×Rn×· · ·×Rn) (K2)

for all m  N, where (of course) the set on the right hand side has a total of
k + m factors.
Then there exists a probability space (, F, P ) and a stochastic process {Xt} on , Xt:   Rn, s.t.

t1,...,tk (F1 × · · · × Fk) = P [Xt1  F1, · · · , Xtk  Fk] ,

for all ti  T , k  N and all Borel sets Fi.

2.2 An Important Example: Brownian Motion

In 1828 the Scottish botanist Robert Brown observed that pollen grains sus-
pended in liquid performed an irregular motion. The motion was later ex-
plained by the random collisions with the molecules of the liquid. To describe
the motion mathematically it is natural to use the concept of a stochastic
process Bt(), interpreted as the position at time t of the pollen grain . We will generalize slightly and consider an n-dimensional analog.
To construct {Bt}t0 it suffices, by the Kolmogorov extension theorem, to specify a family {t1,...,tk } of probability measures satisfying (K1) and (K2). These measures will be chosen so that they agree with our observations of
the pollen grain behaviour: Fix x  Rn and define

p(t,

x,

y)

=

(2t)-n/2

·

exp(-

|x

- y|2 2t

)

for y  Rn, t > 0 .

If 0  t1  t2  · · ·  tk define a measure t1,...,tk on Rnk by

t1,...,tk (F1 × · · · × Fk) =

(2.2.1)

=

p(t1, x, x1)p(t2 -t1, x1, x2) · · · p(tk -tk-1, xk-1, xk)dx1 · · · dxk

F1 ×···×Fk

where we use the notation dy = dy1 · · · dyk for Lebesgue measure and the convention that p(0, x, y)dy = x(y), the unit point mass at x.
Extend this definition to all finite sequences of ti's by using (K1). Since p(t, x, y)dy = 1 for all t  0, (K2) holds, so by Kolmogorov's theorem
Rn

12

2. Some Mathematical Preliminaries

there exists a probability space (, F , P x) and a stochastic process {Bt}t0 on  such that the finite-dimensional distributions of Bt are given by (2.2.1), i.e.

P x(Bt1  F1, · · · , Btk  Fk) =

=

p(t1, x, x1) · · · p(tk - tk-1, xk-1, xk)dx1 . . . dxk . (2.2.2)

F1 ×···×Fk

Definition 2.2.1. Such a process is called (a version of ) Brownian motion starting at x (observe that P x(B0 = x) = 1).

The Brownian motion thus defined is not unique, i.e. there exist several quadruples (Bt, , F , P x) such that (2.2.2) holds. However, for our purposes this is not important, we may simply choose any version to work with. As we
shall soon see, the paths of a Brownian motion are (or, more correctly, can be
chosen to be) continuous, a.s. Therefore we may identify (a.a.)    with a continuous function t  Bt() from [0, ) into Rn. Thus we may adopt the point of view that Brownian motion is just the space C([0, ), Rn) equipped with certain probability measures P x (given by (2.2.1) and (2.2.2) above).
This version is called the canonical Brownian motion. Besides having the
advantage of being intuitive, this point of view is useful for the further analysis of measures on C([0, ), Rn), since this space is Polish (i.e. a complete
separable metric space). See Stroock and Varadhan (1979).
We state some basic properties of Brownian motion:

(i) Bt is a Gaussian process, i.e. for all 0  t1  · · ·  tk the random variable Z = (Bt1 , . . . , Btk )  Rnk has a (multi)normal distribution. This means that there exists a vector M  Rnk and a non-negative definite matrix C = [cjm]  Rnk×nk (the set of all nk × nk-matrices with real entries) such that

nk
Ex exp i ujZj
j=1

= exp

-

1 2

uj cjmum + i

uj Mj

j,m

j

(2.2.3)

for

all

u

=

(u1, . . . , unk)



Rnk ,

where

i

=

 -1

is

the

imaginary

unit

and Ex denotes expectation with respect to P x. Moreover, if (2.2.3)

holds then

M = Ex[Z] is the mean value of Z

(2.2.4)

and

cjm = Ex[(Zj - Mj)(Zm - Mm)] is the covariance matrix of Z . (2.2.5)
(See Appendix A). To see that (2.2.3) holds for Z = (Bt1 , . . . , Btk ) we calculate its left hand side explicitly by using (2.2.2) (see Appendix A) and obtain (2.2.3) with

2.2 An Important Example: Brownian Motion

13

M = Ex[Z] = (x, x, · · · , x)  Rnk

(2.2.6)

and
Hence and

C

=

 

t1In t1In
...

t1In t2In
...

··· ···

t1In t2In
...

 

.

t1In t2In · · · tkIn

Ex[Bt] = x for all t  0

(2.2.7) (2.2.8)

Ex[(Bt - x)2] = nt, Ex[(Bt - x)(Bs - x)] = n min(s, t) .

Moreover, since

Ex[(Bt - Bs)2] = n(t - s) if t  s ,

(2.2.9) (2.2.10)

Ex[(Bt - Bs)2] = Ex[(Bt - x)2 - 2(Bt - x)(Bs - x) + (Bs - x)2] = n(t - 2s + s) = n(t - s), when t  s .

(ii) Bt has independent increments, i.e.

Bt1 , Bt2 - Bt1 , · · · , Btk - Btk-1 are independent for all 0  t1 < t2 · · · < tk .

(2.2.11)

To prove this we use the fact that normal random variables are independent iff they are uncorrelated. (See Appendix A). So it is enough to prove that

Ex[(Bti - Bti-1 )(Btj - Btj-1 )] = 0 which follows from the form of C:

when ti < tj ,

(2.2.12)

Ex[Bti Btj - Bti-1 Btj - Bti Btj-1 + Bti-1 Btj-1 ]
= n(ti - ti-1 - ti + ti-1) = 0 .
From this we deduce that Bs - Bt is independent of Ft if s > t. (iii) Finally we ask: Is t  Bt() continuous for almost all ? Stated like this
the question does not make sense, because the set H = {; t  Bt() is continuous} is not measurable with respect to the Borel -algebra B on (Rn)[0,) mentioned above (H involves an uncountable number of t's). However, if modified slightly the question can be given a positive answer. To explain this we need the following important concept:

14

2. Some Mathematical Preliminaries

Definition 2.2.2. Suppose that {Xt} and {Yt} are stochastic processes on (, F , P ). Then we say that {Xt} is a version of (or a modification of) {Yt} if
P ({; Xt() = Yt()}) = 1 for all t .
Note that if Xt is a version of Yt, then Xt and Yt have the same finitedimensional distributions. Thus from the point of view that a stochastic process is a probability law on (Rn)[0,) two such processes are the same, but nevertheless their path properties may be different. (See Exercise 2.9.)

The continuity question of Brownian motion can be answered by using another famous theorem of Kolmogorov:

Theorem 2.2.3 (Kolmogorov's continuity theorem). Suppose that the
process X = {Xt}t0 satisfies the following condition: For all T > 0 there exist positive constants , , D such that

E[|Xt - Xs|]  D · |t - s|1+ ;

0  s, t  T .

(2.2.13)

Then there exists a continuous version of X.

For a proof see for example Stroock and Varadhan (1979, p. 51). For Brownian motion Bt it is not hard to prove that (See Exercise 2.8)

Ex[|Bt - Bs|4] = n(n + 2)|t - s|2 .

(2.2.14)

So Brownian motion satisfies Kolmogorov's condition (2.2.13) with  = 4,
D = n(n + 2) and  = 1, and therefore it has a continuous version. From now
on we will assume that Bt is such a continuous version. Finally we note that

If Bt = (Bt(1), · · · , Bt(n)) is n-dimensional Brownian motion, then

the 1-dimensional processes {Bt(j)}t0, 1  j  n are independent,

1-dimensional Brownian motions .

(2.2.15)

Exercises

2.1. Suppose that X:   R is a function which assumes only countably many values a1, a2, . . .  R. a) Show that X is a random variable if and only if

X-1(ak)  F for all k = 1, 2, . . .

(2.2.16)

b) Suppose (2.2.16) holds. Show that


E[|X|] = |ak|P [X = ak] .
k=1

(2.2.17)

Exercises

15

c) If (2.2.16) holds and E[|X|] < , show that


E[X] = akP [X = ak] .
k=1

d) If (2.2.16) holds and f : R  R is measurable and bounded, show that

E[f (X)] = f (ak)P [X = ak] .
k=1
2.2. Let X:   R be a random variable. The distribution function F of X is defined by F (x) = P [X  x] .

a) Prove that F has the following properties:

(i) 0  F  1, lim F (x) = 0, lim F (x) = 1 .

x-

x

(ii) F is increasing (= non-decreasing).

(iii) F is right-continuous, i.e. F (x) = lim h0 F (x + h) .
h>0

b) Let g: R  R be measurable such that E[|g(X)|] < . Prove that


E[g(X)] = g(x)dF (x) ,
-

where the integral on the right is interpreted in the LebesgueStieltjes sense. c) Let p(x)  0 be a measurable function on R. We say that X has the density p if

x
F (x) = p(y)dy
-

for all x .

Thus from (2.2.1)­(2.2.2) we know that 1-dimensional Brownian motion Bt at time t with B0 = 0 has the density

p(x)

=

1 2t

exp(-

x2 2t

);

xR.

Find the density of Bt2. 2.3. Let {Hi}iI be a family of -algebras on . Prove that

H = {Hi; i  I}

is again a -algebra.

16

2. Some Mathematical Preliminaries

2.4. a) Let X:   Rn be a random variable such that

E[|X|p] <  for some p, 0 < p <  .

Prove Chebychev's inequality:

P [|X|



]



1 p

E

[|X

|p

]

for all   0 .

Hint: |X|pdP  |X|pdP , where A = {: |X|  } .



A

b) Suppose there exists k > 0 such that

M = E[exp(k|X|)] <  .

Prove that P [|X|  ]  M e-k for all   0 .

2.5. Let X, Y :   R be two independent random variables and assume for simplicity that X and Y are bounded. Prove that

E[XY ] = E[X]E[Y ] .

Hint: Assume |X|  M , |Y |  N . Approximate X and Y by sim-

m

n

ple functions () = aiXFi (), () = bjXGj (), respectively,

i=1

j=1

where Fi = X-1([ai, ai+1)), Gj = Y -1([bj , bj+1)), -M = a0 < a1 <

. . . < am = M , -N = b0 < b1 < . . . < bn = N . Then

E[X]  E[] = aiP (Fi), E[Y ]  E[] = bjP (Gj)

i

j

and E[XY ]  E[] = aibjP (Fi  Gj) . . . .
i,j
2.6. Let (, F, P ) be a probability space and let A1, A2, . . . be sets in F such that

P (Ak) <  .
k=1
Prove the Borel-Cantelli lemma:



P(

Ak) = 0 ,

m=1 k=m

i.e. the probability that  belongs to infinitely many Aks is zero.

Exercises

17

2.7. a) Suppose G1, G2, . . . , Gn are disjoint subsets of  such that
n
 = Gi .
i=1

Prove that the family G consisting of  and all unions of some (or all) of G1, . . . , Gn constitutes a -algebra on . b) Prove that any finite -algebra F on  is of the type described in a). c) Let F be a finite -algebra on  and let X:   R be Fmeasurable. Prove that X assumes only finitely many possible values. More precisely, there exists a disjoint family of subsets F1, . . . , Fm  F and real numbers c1, . . . , cm such that
m
X() = ciXFi () .
i=1
2.8. Let Bt be Brownian motion on R, B0 = 0. Put E = E0. a) Use (2.2.3) to prove that

E [eiuBt

]

=

exp(-

1 2

u2t)

for all u  R .

b) Use the power series expansion of the exponential function on both sides, compare the terms with the same power of u and deduce that

E[Bt4] = 3t2

and more generally that

E

Bt2k

=

(2k)! 2k · k!

tk

;

kN.

c) If you feel uneasy about the lack of rigour in the method in b), you can proceed as follows: Prove that (2.2.2) implies that

E[f (Bt)]

=

1 2t

f

(x)e-

x2 2t

dx

R

for all functions f such that the integral on the right converges. Then apply this to f (x) = x2k and use integration by parts and
induction on k.
d) Prove (2.2.14), for example by using b) and induction on n.

2.9. To illustrate that the (finite-dimensional) distributions alone do not give all the information regarding the continuity properties of a process, consider the following example:

18

2. Some Mathematical Preliminaries

Let (, F, P ) = ([0, ), B, µ) where B denotes the Borel -algebra on

[0, ) and µ is a probability measure on [0, ) with no mass on single

points. Define

Xt() =

1 0

if t =  otherwise

and

Yt() = 0 for all (t, )  [0, ) × [0, ) .

Prove that {Xt} and {Yt} have the same distributions and that Xt is a version of Yt. And yet we have that t  Yt() is continuous for all , while t  Xt() is discontinuous for all .

2.10. A stochastic process Xt is called stationary if {Xt} has the same distribution as {Xt+h} for any h > 0. Prove that Brownian motion Bt has stationary increments, i.e. that the process {Bt+h - Bt}h0 has the same distribution for all t.

2.11. Prove (2.2.15).

2.12. Let Bt be Brownian motion and fix t0  0. Prove that

Bt: = Bt0+t - Bt0 ;

t0

is a Brownian motion.

2.13. Let Bt be 2-dimensional Brownian motion and put

D = {x  R2; |x| < } for  > 0 .

Compute

P 0[Bt  D] .

2.14. Let Bt be n-dimensional Brownian motion and let K  Rn have zero n-dimensional Lebesgue measure. Prove that the expected total length

of time that Bt spends in K is zero. (This implies that the Green measure associated with Bt is absolutely continuous with respect to Lebesgue measure. See Chapter 9).

2.15. Let Bt be n-dimensional Brownian motion starting at 0 and let U  Rn×n be a (constant) orthogonal matrix, i.e. U U T = I. Prove that

Bt: = U Bt is also a Brownian motion.

2.16. (Brownian scaling). Let Bt be a 1-dimensional Brownian motion and let c > 0 be a constant. Prove that

Bt: =

1 c

Bc2

t

is also a Brownian motion.

Exercises

19

2.17. If Xt(·):   R is a continuous stochastic process, then for p > 0 the

p'th variation process of Xt,

X, X

(p) t

is

defined

by

X, X

(p) t

()

= lim
tk 0

tk t

Xtk+1 ()-Xtk () p

(limit in probability)

where 0 = t1 < t2 < . . . < tn = t and tk = tk+1 - tk. In particular, if p = 1 this process is called the total variation process and if p = 2
this is called the quadratic variation process. (See Exercise 4.7.) For
Brownian motion Bt  R we now show that the quadratic variation process is simply

B, B t() = B, B (t2)() = t a.s.

Proceed as follows: a) Define

Bk = Btk+1 - Btk

and put

Y (t, ) = (Bk())2 ,
tk t

Show that

E[( (Bk)2 - t)2] = 2 (tk)2

tk t

tk t

and deduce that Y (t, ·)  t in L2(P ) as tk   . b) Use a) to prove that a.a. paths of Brownian motion do not have
a bounded variation on [0, t], i.e. the total variation of Brownian
motion is infinite, a.s.

20

2. Some Mathematical Preliminaries

3. It^o Integrals

3.1 Construction of the It^o Integral

We now turn to the question of finding a reasonable mathematical interpretation of the "noise" term in the equation of Problem 1 in the Introduction:

dN dt

= (r(t) + "noise")N (t)

or more generally in equations of the form

dX dt

= b(t, Xt) + (t, Xt) ·

"noise" ,

(3.1.1)

where b and  are some given functions. Let us first concentrate on the case when the noise is 1-dimensional. It is reasonable to look for some stochastic process Wt to represent the noise term, so that

dX dt

=

b(t, Xt) + (t, Xt) · Wt

.

(3.1.2)

Based on many situations, for example in engineering, one is led to assume that Wt has, at least approximately, these properties:

(i) t1 = t2  Wt1 and Wt2 are independent. (ii) {Wt} is stationary, i.e. the (joint) distribution of {Wt1+t, . . . , Wtk+t}
does not depend on t. (iii) E[Wt] = 0 for all t.

However, it turns out there does not exist any "reasonable" stochastic process satisfying (i) and (ii): Such a Wt cannot have continuous paths. (See Exercise 3.11.) If we require E[Wt2] = 1 then the function (t, )  Wt() cannot even be measurable, with respect to the -algebra B × F, where B is the Borel -algebra on [0, ]. (See Kallianpur (1980, p. 10).)
Nevertheless it is possible to represent Wt as a generalized stochastic process called the white noise process.
That the process is generalized means that it can be constructed as a probability measure on the space S of tempered distributions on [0, ), and not as a probability measure on the much smaller space R[0,), like an

22

3. It^o Integrals

ordinary process can. See e.g. Hida (1980), Adler (1981), Rozanov (1982),

Hida, Kuo, Potthoff and Streit (1993) or Holden, Øksendal, Ubøe and Zhang

(1996).

We will avoid this kind of construction and rather try to rewrite equation

(3.1.2) in a form that suggests a replacement of Wt by a proper stochastic process: Let 0 = t0 < t1 < · · · < tm = t and consider a discrete version of (3.1.2):

Xk+1 - Xk = b(tk, Xk)tk + (tk, Xk)Wktk ,

(3.1.3)

where

Xj = X(tj ), Wk = Wtk , tk = tk+1 - tk .

We abandon the Wk-notation and replace Wktk by Vk = Vtk+1 - Vtk , where {Vt}t0 is some suitable stochastic process. The assumptions (i), (ii) and (iii) on Wt suggest that Vt should have stationary independent increments with mean 0. It turns out that the only such process with continuous paths
is the Brownian motion Bt. (See Knight (1981)). Thus we put Vt = Bt and obtain from (3.1.3):

k-1

k-1

Xk = X0 + b(tj, Xj)tj + (tj, Xj)Bj .

j=0

j=0

(3.1.4)

Is it possible to prove that the limit of the right hand side of (3.1.4) exists,
in some sense, when tj  0? If so, then by applying the usual integration notation we should obtain

t

t

Xt = X0 + b(s, Xs)ds + " (s, Xs)dBs"

0

0

(3.1.5)

and we would adopt as a convention that (3.1.2) really means that Xt = Xt() is a stochastic process satisfying (3.1.5).
Thus, in the remainder of this chapter we will prove the existence, in a certain sense, of
t
" f (s, )dBs()"
0
where Bt() is 1-dimensional Brownian motion starting at the origin, for a wide class of functions f : [0, ] ×   R. Then, in Chapter 5, we will return to the solution of (3.1.5).
Suppose 0  S < T and f (t, ) is given. We want to define

T
f (t, )dBt() .
S

(3.1.6)

3.1 Construction of the It^o Integral

23

It is reasonable to start with a definition for a simple class of functions f and then extend by some approximation procedure. Thus, let us first assume that f has the form

(t, ) = ej () · X[j·2-n,(j+1)2-n)(t) ,
j0

(3.1.7)

where X denotes the characteristic (indicator) function and n is a natural number. For such functions it is reasonable to define

T

(t, )dBt() = ej()[Btj+1 - Btj ]() ,

S

j0

(3.1.8)

where





 k · 2-n if S  k · 2-n  T 

tk = tk(n) = 

S T

if if

k · 2-n < S k · 2-n > T



However, without any further assumptions on the functions ej() this leads
to difficulties, as the next example shows. Here ­ and in the following ­ E means the same as E0, the expectation
w.r.t. the law P 0 for Brownian motion starting at 0. And P means the same as P 0.

Example 3.1.1. Choose

1(t, ) =

Bj·2-n () · X[j·2-n,(j+1)2-n)(t)

j0

2(t, ) =

B(j+1)2-n () · X[j·2-n,(j+1)2-n)(t) .

j0

Then
T

E 1(t, )dBt() = E[Btj (Btj+1 - Btj )] = 0 ,

0

j0

since {Bt} has independent increments. But

T

E

2(t, )dBt() =

E[Btj+1 · (Btj+1 - Btj )]

0

j0

=

E[(Btj+1 - Btj )2] = T ,

j0

by (2.2.10) .

So, in spite of the fact that both 1 and 2 appear to be very reasonable approximations to

24

3. It^o Integrals

f (t, ) = Bt() ,
their integrals according to (3.1.8) are not close to each other at all, no matter how large n is chosen.
This only reflects the fact that the variations of the paths of Bt are too big to enable us to define the integral (3.1.6) in the Riemann-Stieltjes sense. In fact, one can show that the paths t  Bt of Brownian motion are nowhere differentiable, almost surely (a.s.). (See Breiman (1968)). In particular, the total variation of the path is infinite, a.s.
In general it is natural to approximate a given function f (t, ) by
f (tj , ) · X[tj,tj+1)(t)
j
where the points tj belong to the intervals [tj, tj+1], and then define
T
f (t, )dBt() as the limit (in a sense that we will explain) of
S
f (tj, )[Btj+1 - Btj ]() as n  . However, the example above shows
j
that ­ unlike the Riemann-Stieltjes integral ­ it does make a difference here what points tj we choose. The following two choices have turned out to be the most useful ones:
1) tj = tj (the left end point), which leads to the It^o integral, from now on denoted by
T
f (t, )dBt() ,
S
and 2) tj = (tj +tj+1)/2 (the mid point), which leads to the Stratonovich integral,
denoted by
T
f (t, )  dBt() .
S
(See Protter (1990, Th. V. 5.30)).
In the end of this chapter we will explain why these choices are the best and discuss the relations and distinctions between the corresponding integrals.
In any case one must restrict oneself to a special class of functions f (t, ) in (3.1.6), also if they have the particular form (3.1.7), in order to obtain a reasonable definition of the integral. We will here present It^o's choice tj = tj. The approximation procedure indicated above will work out successfully provided that f has the property that each of the functions   f (tj, ) only depends on the behaviour of Bs() up to time tj. This leads to the following important concepts:

3.1 Construction of the It^o Integral

25

Definition 3.1.2. Let Bt() be n-dimensional Brownian motion. Then we define Ft = Ft(n) to be the -algebra generated by the random variables Bs(·); s  t. In other words, Ft is the smallest -algebra containing all sets of the form
{; Bt1 ()  F1, · · · , Btk ()  Fk} , where tj  t and Fj  Rn are Borel sets, j  k = 1, 2, . . . (We assume that all sets of measure zero are included in Ft).
One often thinks of Ft as "the history of Bs up to time t". A function h() will be Ft-measurable if and only if h can be written as the pointwise a.e. limit of sums of functions of the form
g1(Bt1 )g2(Bt2 ) · · · gk(Btk ) ,
where g1, . . . , gk are bounded continuous functions and tj  t for j  k, k = 1, 2, . . . . (See Exercise 3.14.) Intuitively, that h is Ft-measurable means that the value of h() can be decided from the values of Bs() for s  t. For example, h1() = Bt/2() is Ft-measurable, while h2() = B2t() is not.
Note that Fs  Ft for s < t (i.e. {Ft} is increasing) and that Ft  F for all t.
Definition 3.1.3. Let {Nt}t0 be an increasing family of -algebras of subsets of . A process g(t, ): [0, ) ×   Rn is called Nt-adapted if for each t  0 the function
  g(t, )
is Nt-measurable.
Thus the process h1(t, ) = Bt/2() is Ft-adapted, while h2(t, ) = B2t() is not.
We now describe our class of functions for which the It^o integral will be defined:
Definition 3.1.4. Let V = V(S, T ) be the class of functions
f (t, ): [0, ) ×   R
such that
(i) (t, )  f (t, ) is B × F-measurable, where B denotes the Borel algebra on [0, ).
(ii) f (t, ) is Ft-adapted.
T
(iii) E f (t, )2dt < .
S

26

3. It^o Integrals

The It^o Integral

For functions f  V we will now show how to define the It^o integral
T
I[f ]() = f (t, )dBt() ,
S
where Bt is 1-dimensional Brownian motion. The idea is natural: First we define I[] for a simple class of functions
. Then we show that each f  V can be approximated (in an appropriate sense) by such 's and we use this to define f dB as the limit of dB as   f.
We now give the details of this construction: A function   V is called elementary if it has the form

(t, ) = ej () · X[tj,tj+1)(t) .
j

(3.1.9)

Note that since   V each function ej must be Ftj -measurable. Thus in Example 3.1.1 above the function 1 is elementary while 2 is not.
For elementary functions (t, ) we define the integral according to
(3.1.8), i.e.

T

(t, )dBt() = ej()[Btj+1 - Btj ]() .

S

j0

Now we make the following important observation:

(3.1.10)

Lemma 3.1.5 (The It^o isometry). If (t, ) is bounded and elementary

then
T

2

T

E

(t, )dBt() = E (t, )2dt .

(3.1.11)

S

S

Proof. Put Bj = Btj+1 - Btj . Then

E[eiejBiBj] =

0

if

E[e2j ] · (tj+1 - tj) if

i=j i=j

using that eiejBi and Bj are independent if i < j. Thus

T

2

E

dB

=

E[eiej BiBj ] = E[ej2] · (tj+1 - tj )

S

i,j

j

T

= E 2dt .

S

3.1 Construction of the It^o Integral

27

The idea is now to use the isometry (3.1.11) to extend the definition from elementary functions to functions in V. We do this in several steps:

Step 1. Let g  V be bounded and g(·, ) continuous for each . Then there exist elementary functions n  V such that

T
E (g - n)2dt  0
S

as n   .

Proof. Define n(t, ) = g(tj, ) · X[tj,tj+1)(t). Then n is elementary since
j
g  V, and

T
(g - n)2dt  0
S

as n  , for each  ,

T
since g(·, ) is continuous for each . Hence E[ (g - n)2dt]  0 as n  ,
S
by bounded convergence.

Step 2. Let h  V be bounded. Then there exist bounded functions gn  V such that gn(·, ) is continuous for all  and n, and

T
E (h - gn)2dt  0 .
S

Proof. Suppose |h(t, )|  M for all (t, ). For each n let n be a nonnegative, continuous function on R such that

(i)

n(x)

=

0

for

x



-

1 n

and

x



0

and



(ii) n(x)dx = 1

-

Define
t
gn(t, ) = n(s - t)h(s, )ds .
0
Then gn(·, ) is continuous for each  and |gn(t, )|  M . Since h  V we can show that gn(t, ·) is Ft-measurable for all t. (This is a subtle point; see e.g. Karatzas and Shreve (1991), p. 133 for details.) Moreover,

28

3. It^o Integrals

T
(gn(s, ) - h(s, ))2ds  0

as n  , for each  ,

S

since {n}n constitutes an approximate identity. (See e.g. Hoffman (1962, p. 22).) So by bounded convergence

T
E (h(t, ) - gn(t, ))2dt  0
S
as asserted.

as n   ,

Step 3. Let f  V. Then there exists a sequence {hn}  V such that hn is bounded for each n and

T
E (f - hn)2dt  0 as n   .
S

Proof. Put

  -n if f (t, ) < -n

hn(t,

)

=



f

(t, n

)

if if

-n  f (t, )  n f (t, ) > n .

Then the conclusion follows by dominated convergence. That completes the approximation procedure.

We are now ready to complete the definition of the It^o integral

T

f (t, )dBt() for f  V .

S

If f  V we choose, by Steps 1-3, elementary functions n  V such that

T
E |f - n|2dt  0 .

S

Then define

T

T

I[f ](): =

f

(t,

)dBt():

=

lim
n

n(t, )dBt() .

S

S

The limit exists as an element of L2(P ), since
Cauchy sequence in L2(P ), by (3.1.11). We summarize this as follows:

T
n(t, )dBt()
S

forms a

3.1 Construction of the It^o Integral

29

Definition 3.1.6 (The It^o integral). Let f  V(S, T ). Then the Ito^ integral of f (from S to T ) is defined by

T

T

f

(t,

)dBt()

=

lim
n

n(t, )dBt()

S

S

(limit in L2(P ))

where {n} is a sequence of elementary functions such that

(3.1.12)

T
E (f (t, ) - n(t, ))2dt  0

as n   .

(3.1.13)

S

Note that such a sequence {n} satisfying (3.1.13) exists by Steps 1­3 above. Moreover, by (3.1.11) the limit in (3.1.12) exists and does not depend
on the actual choice of {n}, as long as (3.1.13) holds. Furthermore, from (3.1.11) and (3.1.12) we get the following important

Corollary 3.1.7 (The It^o isometry).

T

2

T

E

f (t, )dBt = E f 2(t, )dt for all f  V(S, T ) . (3.1.14)

S

S

Corollary 3.1.8. If f (t, )  V(S, T ) and fn(t, )  V(S, T ) for n = 1, 2, . . .
T
and E (fn(t, ) - f (t, ))2dt  0 as n  , then
S

T

T

fn(t, )dBt()  f (t, )dBt() in L2(P ) as n   .

S

S

We illustrate this integral with an example:

Example 3.1.9. Assume B0 = 0. Then

t

BsdBs

=

1 2

Bt2

-

1 2

t

.

0

Proof. Put n(s, ) = Bj () · X[tj,tj+1)(s), where Bj = Btj . Then

t

tj+1

E (n - Bs)2ds = E

(Bj - Bs)2ds

0

j tj

tj+1

=

(s - tj)ds =

1 2

(tj+1

-

tj )2



0

j tj

j

as tj  0 .

30

3. It^o Integrals

So by Corollary 3.1.8

t

t

0

BsdBs

=

lim
tj 0

0

ndBs

=

lim
tj 0

j

Bj Bj .

(See also Exercise 3.13.) Now

(Bj2) = Bj2+1 - Bj2 = (Bj+1 - Bj )2 + 2Bj (Bj+1 - Bj ) = (Bj)2 + 2BjBj ,

and therefore, since B0 = 0,

Bt2 = (Bj2) = (Bj )2 + 2 BjBj

j

j

j

or

Bj Bj

=

1 2

Bt2

-

1 2

(Bj)2 .

j

j

Since (Bj)2  t in L2(P ) as tj  0 (Exercise 2.17), the result follows.
j

The

extra

term

-

1 2

t

shows

that

the

It^o

stochastic

integral

does

not

behave

like ordinary integrals. In the next chapter we will establish the It^o formula,

which explains the result in this example and which makes it easy to calculate

many stochastic integrals.

3.2 Some properties of the It^o integral

First we observe the following:

Theorem 3.2.1. Let f, g  V(0, T ) and let 0  S < U < T . Then

T

U

T

(i) f dBt = f dBt + f dBt for a.a. 

S

S

U

T

T

T

(ii) (cf + g)dBt = c · f dBt + gdBt (c constant) for a.a. 

S

S

S

T

(iii) E f dBt = 0

S

T

(iv) f dBt is FT -measurable.

S

Proof. This clearly holds for all elementary functions, so by taking limits we obtain this for all f, g  V(0, T ).

An important property of the It^o integral is that it is a martingale:

3.2 Some properties of the It^o integral

31

Definition 3.2.2. A filtration (on (, F )) is a family M = {Mt}t0 of -algebras Mt  F such that

0  s < t  Ms  Mt

(i.e. {Mt} is increasing). An n-dimensional stochastic process {Mt}t0 on (, F , P ) is called a martingale with respect to a filtration {Mt}t0 (and with respect to P ) if

(i) Mt is Mt-measurable for all t, (ii) E[|Mt|] <  for all t
and (iii) E[Ms|Mt] = Mt for all s  t.
Here the expectation in (ii) and the conditional expectation in (iii) is taken with respect to P = P 0. (See Appendix B for a survey of conditional expectation).

Example 3.2.3. Brownian motion Bt in Rn is a martingale w.r.t. the algebras Ft generated by {Bs; s  t}, because
E[|Bt|]2  E[|Bt|2] = |B0|2 + nt and if s  t then E[Bs|Ft] = E[Bs - Bt + Bt|Ft]
= E[Bs - Bt|Ft] + E[Bt|Ft] = 0 + Bt = Bt .

Here we have used that E[(Bs - Bt)|Ft] = E[Bs - Bt] = 0 since Bs - Bt is independent of Ft (see (2.2.11) and Theorem B.2.d)) and we have used that E[Bt|Ft] = Bt since Bt is Ft-measurable (see Theorem B.2.c)).
For continuous martingales we have the following important inequality due to Doob: (See e.g. Stroock and Varadhan (1979), Theorem 1.2.3 or Revuz and Yor (1991), Theorem II.1.7)

Theorem 3.2.4 (Doob's martingale inequality). If Mt is a martingale

such that t  Mt() is continuous a.s., then for all p  1, T  0 and all

>0

P [ sup
0tT

|Mt|



]



1 p

·

E[|MT |p]

.

We now use this inequality to prove that the It^o integral

t
f (s, )dBs
0
can be chosen to depend continuously on t :

32

3. It^o Integrals

Theorem 3.2.5. Let f  V(0, T ). Then there exists a t-continuous version
of
t

f (s, )dBs() ; 0  t  T ,

0
i.e. there exists a t-continuous stochastic process Jt on (, F , P ) such that

t

P [Jt = f dB] = 1 for all t, 0  t  T .

(3.2.1)

0

Proof. Let n = n(t, ) = j e(jn)()X[tj(n),tj(n+)1)(t) be elementary functions such that
T
E (f - n)2dt  0 when n   .

0
Put
t

In(t, ) = n(s, )dBs()

0
and
t

It = I(t, ) = f (s, )dBs() ; 0  t  T .

0
Then In(·, ) is continuous, for all n. Moreover, In(t, ) is a martingale with respect to Ft, for all n :

t

s

E[In(s, )|Ft] = E

ndB + ndB Ft

0

t

t

= ndB + E

e(jn)Bj |Ft

0

ttj(n) tj(n+)1 s

t

=
0

ndB +

j

E E[e(jn)Bj |Ft(jn) ]|Ft

t

=
0

ndB +

j

E e(jn)E[Bj |Ftj(n) ]|Ft

t

= ndB = In(t, )

(3.2.2)

0

3.2 Some properties of the It^o integral

33

when t < s, using Theorem B.3. and Theorem B.2.d).
Hence In - Im is also an Ft-martingale, so by the martingale inequality (Theorem 3.2.4) it follows that

P sup |In(t, ) - Im(t, )| >
0tT



1
2

·E

|In(T, ) - Im(T, )|2

T

=

1
2

E

(n - m)2ds  0

as m, n   .

0

Hence we may choose a subsequence nk   s.t.

P sup |Ink+1 (t, ) - Ink (t, )| > 2-k < 2-k .
0tT

By the Borel-Cantelli lemma

P sup |Ink+1 (t, ) - Ink (t, )| > 2-k for infinitely many k = 0 .
0tT

So for a.a.  there exists k1() such that sup |Ink+1 (t, ) - Ink (t, )|  2-k
0tT

for k  k1() .

Therefore Ink (t, ) is uniformly convergent for t  [0, T ], for a.a.  and so the limit, denoted by Jt(), is t-continuous for t  [0, T ], a.s. Since Ink (t, ·)  I(t, ·) in L2[P ] for all t, we must have

It = Jt a.s. , for all t  [0, T ] .

That completes the proof.
t
From now on we shall always assume that f (s, )dBs() means a t-
0
continuous version of the integral.

Corollary 3.2.6. Let f (t, )  V(0, T ) for all T . Then

t

Mt() = f (s, )dBs

0

is a martingale w.r.t. Ft and

T

P

sup |Mt|  
0tT



1 2

·E

f (s, )2ds ;

0

, T > 0 .

(3.2.3)

Proof. This follows from (3.2.2), the a.s. t-continuity of Mt and the martingale inequality (Theorem 3.2.4), combined with the It^o isometry (3.1.14).

34

3. It^o Integrals

3.3 Extensions of the It^o integral

The It^o integral f dB can be defined for a larger class of integrands f than V. First, the measurability condition (ii) of Definition 3.1.4 can be relaxed to the following:

(ii)' There exists an increasing family of -algebras Ht; t  0 such that a) Bt is a martingale with respect to Ht and b) ft is Ht-adapted.

Note that a) implies that Ft  Ht. The essence of this extension is that we can allow ft to depend on more than Ft as long as Bt remains a martingale with respect to the "history" of fs; s  t. If (ii)' holds, then E[Bs-Bt|Ht] = 0 for all s > t and if we inspect our proofs above, we see that this is sufficient
to carry out the construction of the It^o integral as before.
The most important example of a situation where (ii)' applies (and (ii)
doesn't) is the following:
Suppose Bt() = Bk(t, ) is the k'th coordinate of n-dimensional Brownian motion (B1, . . . , Bn). Let Ft(n) be the -algebra generated by B1(s1, ·), · · ·, Bn(sn, ·); sk  t. Then Bk(t, ) is a martingale with respect to Ft(n) because Bk(s, ·) - Bk(t, ·) is independent of Ft(n) when s > t. Thus we have now defined t f (s, )dBk(s, ) for Ft(n)-adapted integrands f (t, ). That includes
0
integrals like

B2dB1 or

sin(B12 + B22) dB2

involving several components of n-dimensional Brownian motion. (Here we
have used the notation dB1 = dB1(t, ) etc.) This allows us to define the multi-dimensional It^o integral as follows:

Definition 3.3.1. Let B = (B1, B2, . . . , Bn) be n-dimensional Brownian motion. Then VHm×n(S, T ) denotes the set of m × n matrices v = [vij(t, )] where each entry vij(t, ) satisfies (i) and (iii) of Definition 3.1.4 and (ii)' above, with respect to some filtration H = {Ht}t0.
If v  VHm×n(S, T ) we define, using matrix notation

T

T  v11 · · · v1n   dB1 

vdB =  ...

...   ... 

S

S vm1 · · · vmn

dBn

to be the m × 1 matrix (column vector) whose i'th component is the following sum of (extended) 1-dimensional It^o integrals:

nT
vij(s, )dBj(s, ) .
j=1 S

3.3 Extensions of the It^o integral

35

If H = VHn (S, T

F (n) = {Ft(n)}t0 ) (respectively Vn(S,

we T ))

write V instead

m×n(S, T ) and of VHn×1(S, T )

if m = 1 we (respectively

write

Vn×1(S, T )). We also put

Vm×n = Vm×n(0, ) = Vm×n(0, T ) .
T >0

The next extension of the It^o integral consists of weakening condition (iii) of Definition 3.1.4 to
T
(iii)' P f (s, )2ds <  = 1 .
S
Definition 3.3.2. WH(S, T ) denotes the class of processes f (t, )  R satisfying (i) of Definition 3.1.4 and (ii)', (iii)' above. Similarly to the notation for V we put WH = WH(0, T ) and in the matrix case we write WHm×n(S, T )
T >0
etc. If H = F (n) we write W(S, T ) instead of WF(n) (S, T ) etc. If the dimension is clear from the context we sometimes drop the superscript and write F for F (n) and so on.

Let Bt denote 1-dimensional Brownian motion. If f  WH one can show
t
that for all t there exist step functions fn  WH such that |fn - f |2ds  0
0
in probability, i.e. in measure with respect to P . For such a sequence one has
t
that fn(s, )dBs converges in probability to some random variable and the
0
limit only depends on f , not on the sequence {fn}. Thus we may define

t

t

f

(s,

)dBs()

=

lim
n

fn(s, )dBs() (limit in probability) for f  WH .

0

0

(3.3.1)

As before there exists a t-continuous version of this integral. See Friedman

(1975, Chap. 4) or McKean (1969, Chap. 2) for details. Note, however, that

this integral is not in general a martingale. See for example Dudley's Theorem

(Theorem 12.1.5). It is, however, a local martingale. See Karatzas and Shreve

(1991), p. 146. See also Exercise 7.12.

A comparison of It^o and Stratonovich integrals

Let us now return to our original question in this chapter: We have argued that the mathematical interpretation of the white noise equation

dX dt

=

b(t, Xt) + (t, Xt) · Wt

(3.3.2)

36

3. It^o Integrals

is that Xt is a solution of the integral equation

t

t

Xt = X0 + b(s, Xs)ds + " (s, Xs)dBs" ,

0

0

(3.3.3)

for some suitable interpretation of the last integral in (3.3.3). However, as indicated earlier, the It^o interpretation of an integral of the form

t

" f (s, )dBs()"

()

0

is just one of several reasonable choices. For example, the Stratonovich integral is another possibility, leading (in general) to a different result. So the question still remains: Which interpretation of () makes (3.3.3) the "right" mathematical model for the equation (3.3.2)? Here is an argument that indicates that the Stratonovich interpretation in some situations may be the most appropriate: Choose t-continuously differentiable processes Bt(n) such that for a.a. 
B(n)(t, )  B(t, ) as n  

uniformly (in t) in bounded intervals. For each  let Xt(n)() be the solution of the corresponding (deterministic) differential equation

dXt dt

=

b(t,

Xt)

+

(t,

Xt

)

dBt(n) dt

.

(3.3.4)

Then Xt(n)() converges to some function Xt() in the same sense: For a.a.  we have that Xt(n)()  Xt() as n  , uniformly (in t) in bounded intervals.
It turns out (see Wong and Zakai (1969) and Sussman (1978)) that this solution Xt coincides with the solution of (3.3.3) obtained by using Stratonovich integrals, i.e.

t

t

Xt = X0 + b(s, Xs)ds + (s, Xs)  dBs .

0

0

(3.3.5)

This implies that Xt is the solution of the following modified It^o equation:

t

t

t

Xt = X0 +

b(s,

Xs)ds

+

1 2

 (s, Xs)(s, Xs)ds +

(s, Xs)dBs , (3.3.6)

0

0

0

where  denotes the derivative of (t, x) with respect to x. (See Stratonovich (1966)).

Exercises

37

Therefore, from this point of view it seems reasonable to use (3.3.6) (i.e. the Stratonovich interpretation) ­ and not the It^o interpretation

t

t

Xt = X0 + b(s, Xs)ds + (s, Xs)dBs

0

0

(3.3.7)

as the model for the original white noise equation (3.3.2). On the other hand, the specific feature of the It^o model of "not looking
into the future" (as explained after Example 3.1.1) seems to be a reason for choosing the It^o interpretation in many cases, for example in biology (see the discussion in Turelli (1977)). The difference between the two interpretations is illustrated in Example 5.1.1. Note that (3.3.6) and (3.3.7) coincide if (t, x) does not depend on x. For example, this is the situation in the linear case handled in the filtering problem in Chapter 6.
In any case, because of the explicit connection (3.3.6) between the two models (and a similar connection in higher dimensions ­ see (6.1.3)), it will for many purposes suffice to do the general mathematical treatment for one of the two types of integrals. In general one can say that the Stratonovich integral has the advantage of leading to ordinary chain rule formulas under a transformation (change of variable), i.e. there are no second order terms in the Stratonovich analogue of the It^o transformation formula (see Theorems 4.1.2 and 4.2.1). This property makes the Stratonovich integral natural to use for example in connection with stochastic differential equations on manifolds (see Elworthy (1982) or Ikeda and Watanabe (1989)).
However, Stratonovich integrals are not martingales, as we have seen that Ito^ integrals are. This gives the It^o integral an important computational advantage, even though it does not behave so nicely under transformations (as Example 3.1.9 shows). For our purposes the It^o integral will be most convenient, so we will base our discussion on that from now on.

Exercises

Unless otherwise stated Bt denotes Brownian motion in R, B0 = 0.

3.1. Prove directly from the definition of It^o integrals (Definition 3.1.6)

that

t

t

sdBs = tBt - Bsds .

0

0

(Hint: Note that

(sj Bj ) = sj Bj + Bj+1sj .)

j

j

j

38

3. It^o Integrals

3.2. Prove directly from the definition of It^o integrals that

t

t

Bs2dBs

=

1 3

Bt3

-

Bsds .

0

0

3.3. If Xt:   Rn is a stochastic process, let Ht = Ht(X) denote the algebra generated by {Xs(·); s  t} (i.e. {Ht(X)}t0 is the filtration of the process {Xt}t0).
a) Show that if Xt is a martingale w.r.t. some filtration {Nt}t0, then Xt is also a martingale w.r.t. its own filtration {Ht(X)}t0 .
b) Show that if Xt is a martingale w.r.t Ht(X), then

E[Xt] = E[X0] for all t  0 .

()

c) Give an example of a stochastic process Xt satisfying () and which is not a martingale w.r.t. its own filtration.

3.4. Check whether the following processes Xt are martingales w.r.t. {Ft}: (i) Xt = Bt + 4t (ii) Xt = Bt2
t
(iii) Xt = t2Bt - 2 sBsds
0
(iv) Xt = B1(t)B2(t), where (B1(t), B2(t)) is 2-dimensional Brownian motion.

3.5. Prove directly (without using Example 3.1.9) that

Mt = Bt2 - t

is an Ft-martingale.
3.6. Prove that Nt = Bt3 - 3tBt is a martingale.
3.7. A famous result of It^o (1951) gives the following formula for n times iterated It^o integrals:

n! · · · ( (

n
dBu1 )dBu2 ) · · · dBun = t 2 hn

Bt t

0u1 ···un t

(3.3.8)

where hn is the Hermite polynomial of degree n, defined by

hn(x)

=

(-1)n

e

x2 2

dn dxn

e-

x2 2

;

n = 0, 1, 2, . . .

(Thus h0(x) = 1, h1(x) = x, h2(x) = x2 - 1, h3(x) = x3 - 3x.) a) Verify that in each of these n It^o integrals the integrand satisfies
the requirements in Definition 3.1.4.

Exercises

39

b) Verify formula (3.3.8) for n = 1, 2, 3 by combining Example 3.1.9 and Exercise 3.2.
c) Use b) to give a new proof of the statement in Exercise 3.6.
3.8. a) Let Y be a real valued random variable on (, F, P ) such that

E[|Y |] <  .

Define

Mt = E[Y |Ft] ; t  0 .

Show that Mt is an Ft-martingale. b) Conversely, let Mt; t  0 be a real valued Ft-martingale such that

sup E[|Mt|p] < 
t0

for some p > 1 .

Show that there exists Y  L1(P ) such that

Mt = E[Y |Ft] .

(Hint: Use Corollary C.7.)
3.9. Suppose f  V(0, T ) and that t  f (t, ) is continuous for a.a. . Then we have shown that

T

0

f

(t,

)dBt()

=

lim
tj 0

j

f (tj, )Bj

in L2(P ) .

Similarly we define the Stratonovich integral of f by

T

f

(t,



)dBt

()

=

lim
tj 0

0

j

f (tj, )Bj ,

where

tj

=

1 2

(tj

+

tj+1)

,

whenever the limit exists in L2(P ). In general these integrals are different. For example, compute

T
Bt  dBt
0
and compare with Example 3.1.9.
3.10. If the function f in Exercise 3.9 varies "smoothly" with t then in fact the It^o and Stratonovich integrals of f coincide. More precisely, assume that there exists K <  and > 0 such that

E[|f (s, ·) - f (t, ·)|2]  K|s - t|1+ ; 0  s , t  T .

40

3. It^o Integrals

Prove that then we have

T

0

f (t,

)dBt

=

lim
tj 0

j

f (tj, )Bj

(limit in L1(P ))

for any choice of tj  [tj, tj+1]. In particular,

T

T

f (t, )dBt = f (t, )  dBt .

0

0

(Hint: Consider E | f (tj, )Bj - f (tj, )Bj| .)

j

j

3.11. Let Wt be a stochastic process satisfying (i), (ii) and (iii) (below (3.1.2)). Prove that Wt cannot have continuous paths. (Hint: Consider E[(Wt(N) - Ws(N))2], where

Wt(N) = (-N )  (N  Wt), N = 1, 2, 3, . . .) .

3.12. As in Exercise 3.9 we let dBt denote Stratonovich differentials. (i) Use (3.3.6) to transform the following Stratonovich differential equations into It^o differential equations: (a) dXt = Xtdt + Xt  dBt (b) dXt = sin Xt cos Xtdt + (t2 + cos Xt)  dBt (ii) Transform the following It^o differential equations into Stratonovich differential equations: (a) dXt = rXtdt + XtdBt (b) dXt = 2e-Xt dt + Xt2dBt
3.13. A stochastic process Xt(·):   R is continuous in mean square if E[Xt2] <  for all t and

lim
st

E[(Xs

-

Xt)2]

=

0

for all t  0 .

a) Prove that Brownian motion Bt is continuous in mean square. b) Let f : R  R be a Lipschitz continuous function, i.e. there exists
C <  such that

|f (x) - f (y)|  C|x - y| for all x, y  R .

Prove that

Yt: = f (Bt)

is continuous in mean square.

Exercises

41

c) Let Xt be a stochastic process which is continuous in mean square and assume that Xt  V(S, T ), T < . Show that

T

T

XtdBt

=

lim
n

n(t, )dBt()

S

S

(limit in L2(P ))

where

n(t, ) = j Xtj(n) ()X[tj(n),tj(n+)1)(t) , (Hint: Consider

T <.

T
E (Xt - n(t))2dt = E
S

tj(n+)1

j

(Xt - Xt(jn) )2dt
tj(n)

).

3.14. Show that a function h() is Ft-measurable if and only if h is a pointwise limit (for a.a. ) of sums of functions of the form

g1(Bt1 ) · g2(Bt2 ) · · · gk(Btk )
where g1, . . . , gk are bounded continuous functions and tj  t for j  k, k = 1, 2, . . . Hint: Complete the following steps: a) We may assume that h is bounded. b) For n = 1, 2, . . . and j = 1, 2, . . . put tj = t(jn) = j · 2-n. For
fixed n let Hn be the -algebra generated by {Btj (·)}tjt. Then by Corollary C.9

h

=

E[h|Ft]

=

lim
n

E[h|Hn]

(pointwise a.e. limit)

c) Define hn: = E[h|Hn]. Then by the Doob-Dynkin lemma (Lemma 2.1.2) we have

hn() = Gn(Bt1 (), . . . , Btk ())
for some Borel function Gn:Rk  R, where k = max{j; j · 2-n  t}. Now use that any Borel function G: Rk  R can be approximated pointwise a.e. by a continuous function F : Rk  R and complete the proof by applying the Stone-Weierstrass theorem.
3.15. Suppose f, g  V(S, T ) and that there exist constants C, D such that

T

T

C + f (t, )dBt() = D + g(t, )dBt()

S

S

for a.a.    .

42

3. It^o Integrals

Show that

C =D

and f (t, ) = g(t, ) for a.a. (t, )  [S, T ] ×  .

3.16. Let X:   R be a random variable such that E[X2] <  and let H  F be a -algebra. Show that

E (E[X|H])2  E[X2] .

(See Lemma 6.1.1. See also the Jensen inequality for conditional expectation (Appendix B).)
3.17. Let (, F, P ) be a probability space and let X:   R be a random variable with E[|X|] < . If G  F is a finite -algebra, then by
n
Exercise 2.7 there exists a partition  = Gi such that G consists
i=1
of  and unions of some (or all) of G1, . . . , Gn. a) Explain why E[X|G]() is constant on each Gi. (See Exercise 2.7 c).) b) Assume that P [Gi] > 0. Show that

E[X|G]() =

Gi XdP P (Gi)

for   Gi .

c) Suppose X assumes only finitely many values a1, . . . , am. Then from elementary probability theory we know that (see Exercise 2.1)

m
E[X|Gi] = akP [X = ak|Gi] .
k=1

Compare with b) and verify that

E[X|Gi] = E[X|G]() for   Gi .
Thus we may regard the conditional expectation as defined in Appendix B as a (substantial) generalization of the conditional expectation in elementary probability theory.

4. The It^o Formula and the Martingale Representation Theorem

4.1 The 1-dimensional It^o formula

Example 3.1.9 illustrates that the basic definition of It^o integrals is not very useful when we try to evaluate a given integral. This is similar to the situation for ordinary Riemann integrals, where we do not use the basic definition but rather the fundamental theorem of calculus plus the chain rule in the explicit calculations.
In this context, however, we have no differentiation theory, only integration theory. Nevertheless it turns out that it is possible to establish an It^o integral version of the chain rule, called the It^o formula. The It^o formula is, as we will show by examples, very useful for evaluating It^o integrals.
From the example

t

t

BsdBs

=

1 2

Bt2

-

1 2

t

or

1 2

Bt2

=

1 2

t

+

BsdBs ,

0

0

(4.1.1)

t

we see that the image of the It^o integral Bt =

dBs

by

the

map

g(x)

=

1 2

x2

0

is not again an It^o integral of the form

t
f (s, )dBs()

0

but a combination of a dBs-and a ds-integral:

t

t

1 2

Bt2

=

1 2

ds

+

BsdBs .

0

0

(4.1.2)

It turns out that if we introduce It^o processes (also called stochastic integrals)
as sums of a dBs-and a ds-integral then this family of integrals is stable under smooth maps. Thus we define

Definition 4.1.1 (1-dimensional It^o processes). Let Bt be 1-dimensional Brownian motion on (, F , P ). A (1-dimensional)

44

4. The It^o Formula and the Martingale ...

Ito^ process (or stochastic integral) is a stochastic process Xt on (, F , P ) of

the form

t

t

Xt = X0 + u(s, )ds + v(s, )dBs ,

(4.1.3)

0

0

where v  WH, so that

t
P v(s, )2ds <  for all t  0 = 1

(4.1.4)

0

(see Definition 3.3.2). We also assume that u is Ht-adapted (where Ht is as in (ii)', Section 3.3) and

t
P |u(s, )|ds <  for all t  0 = 1 .

(4.1.5)

0

If Xt is an It^o process of the form (4.1.3) the equation (4.1.3) is sometimes written in the shorter differential form

dXt = udt + vdBt . For example, (4.1.1) (or (4.1.2)) may be represented by

(4.1.6)

d

1 2

Bt2

=

1 2

dt

+

BtdBt

.

We are now ready to state the first main result in this chapter:

Theorem 4.1.2 (The 1-dimensional It^o formula). Let Xt be an It^o process given by

dXt = udt + vdBt .

Let g(t, x)  C2([0, ) × R) (i.e. g is twice continuously differentiable on [0, ) × R). Then
Yt = g(t, Xt)
is again an It^o process, and

dYt

=

g t

(t,

Xt

)dt

+

g x

(t,

Xt)dXt

+

1 2

2g x2

(t,

Xt

)

·

(dXt)2

,

where (dXt)2 = (dXt) · (dXt) is computed according to the rules

(4.1.7)

dt · dt = dt · dBt = dBt · dt = 0 , dBt · dBt = dt .

(4.1.8)

Before we prove It^o's formula let us look at some examples.

4.1 The 1-dimensional It^o formula

45

Example 4.1.3. Let us return to the integral

t

I = BsdBs from Chapter 3 .

0

Choose

Xt

=

Bt

and

g(t, x)

=

1 2

x2

.

Then

Yt

=

g(t, Bt)

=

1 2

Bt2

.

Then by It^o's formula,

dYt

=

g t

dt

+

g x

dBt

+

1 2

2g x2

(dBt

)2

=

BtdBt

+

1 2

(dBt

)2

=

BtdBt

+

1 2

dt

.

Hence In other words,

d(

1 2

Bt2

)

=

BtdBt

+

1 2

dt

.

t

1 2

Bt2

=

BsdBs

+

1 2

t,

0

as in Chapter 3 .

Example 4.1.4. What is
t

sdBs ?

0
From classical calculus it seems reasonable that a term of the form tBt should appear, so we put
g(t, x) = tx

and Then by It^o's formula,

Yt = g(t, Bt) = tBt .

dYt = Btdt + tdBt + 0

i.e.

d(tBt) = Btdt + tdBt

or

t

t

tBt = Bsds + sdBs

0

0

or

t

t

sdBs = tBt - Bsds ,

0

0

which is reasonable from an integration-by-parts point of view.

46

4. The It^o Formula and the Martingale ...

More generally, the same method gives
Theorem 4.1.5 (Integration by parts). Suppose f (s, ) = f (s) only depends on s and that f is continuous and of bounded variation in [0, t]. Then

t

t

f (s)dBs = f (t)Bt - Bsdfs .

0

0

Note that it is crucial for the result to hold that f does not depend on . (See Exercise 4.3.)

Sketch of proof of the It^o formula. First observe that if we substitute

dXt = udt + vdBt in (4.1.7) and use (4.1.8) we get the equivalent expression

t
g(t, Xt) = g(0, X0) +
0

g s

(s,

Xs)

+

us

g x

(s,

Xs)

+

1 2

vs2

·

2g x2

(s, Xs)

ds

t

+

vs

·

g x

(s,

Xs)dBs

where us = u(s, ), vs = v(s, ) .

(4.1.9)

0

Note that (4.1.9) is an It^o process in the sense of Definition 4. 1.1.

in

We this

may case

assume that g, we obtain the

g t

,

g x

and

2g x2

general case

are bounded, for if (4.1.9) by approximating by C2

is proved functions

gn

such

that

gn,

gn t

,

gn x

and

 2 gn x2

are

bounded

for

each n

and

converge

uniformly

on

compact

subsets

of

[0, )

×

R

to

g,

g t

,

g x

,

2g x2

,

respectively.

(See Exercise 4.9.) Moreover, from (3.3.1) we see that we may assume that

u(t, ) and v(t, ) are elementary functions. Using Taylor's theorem we get

g(t, Xt) = g(0, X0) +

g(tj, Xj) = g(0, X0) +

g t

tj

+

g x

Xj

j

j

j

+

1 2

2g t2

(tj

)2

+

2g tx

(tj

)(Xj

)

+

1 2

2g x2

(Xj

)2

+

Rj ,

j

j

j

j

where

g t

,

g x

etc.

are

evaluated

at

the

points

(tj , Xtj ),

tj = tj+1 - tj , Xj = Xtj+1 - Xtj , g(tj , Xj ) = g(tj+1, Xtj+1 ) - g(tj , Xj )

and Rj = o(|tj|2 + |Xj|2) for all j. If tj  0 then

4.1 The 1-dimensional It^o formula

47

t

g t

tj

=

g t

(tj

,

Xj

)tj



g t

(s,

Xs)ds

j

j

0

t

g x

Xj

=

g x

(tj

,

Xj

)Xj



g x

(s,

Xs)dXs

.

j

j

0

Moreover, since u and v are elementary we get

(4.1.10) (4.1.11)

2g x2

(Xj )2

=

2g x2

u2j

(tj

)2

+

2

2g x2

uj

vj

(tj

)(Bj

)

j

j

j

+

2g x2

vj2

·

(Bj

)2,

where uj = u(tj, ), vj = v(tj, ) .

(4.1.12)

j

The first two terms here tend to 0 as tj  0. For example,

E

2g x2

uj

vj

(tj

)(Bj

)

2

=

j

=E
j

2g x2

uj

vj

2
(tj)3  0

as tj  0 .

We claim that the last term tends to

t

2g x2

v

2ds

0

in L2(P ), as tj  0 .

To

prove

this,

put

a(t)

=

2g x2

(t,

Xt

)v2

(t,

),

aj

=

a(tj )

and

consider

2

E

aj(Bj)2- ajtj = E[aiaj((Bi)2-ti)((Bj)2-tj)] .

j

j

i,j

If i < j then aiaj((Bi)2 - ti) and (Bj)2 - tj are independent so the terms vanish in this case, and similarly if i > j. So we are left with

E[a2j ((Bj)2 - tj)2] = E[a2j ] · E[(Bj)4 - 2(Bj)2tj + (tj)2]

j

j

= E[aj2] · (3(tj)2 - 2(tj)2 + (tj)2) = 2 E[aj2] · (tj)2

j

j

 0 as tj  0 .

In other words, we have established that

48

4. The It^o Formula and the Martingale ...

t

aj(Bj)2  a(s)ds

j

0

in L2(P ) as tj  0

and this is often expressed shortly by the striking formula

(dBt)2 = dt .

(4.1.13)

The argument above also proves that Rj  0 as tj  0. That completes the proof of the It^o formula.

Remark. Note that it is enough that g(t, x) is C2 on [0, ) × U , if U  R is an open set such that Xt()  U for all t  0,   . Moreover, it is sufficient that g(t, x) is C1 w.r.t. t and C2 w.r.t. x.

4.2 The Multi-dimensional It^o Formula

We now turn to the situation in higher dimensions: Let B(t, ) = (B1(t, ), . . ., Bm(t, )) denote m-dimensional Brownian motion. If each of the processes ui(t, ) and vij(t, ) satisfies the conditions given in Definition 4.1.1 (1  i  n, 1  j  m) then we can form the following n It^o processes



ddXX... n1

= =

u1dt + v11dB1 + · · · + v1mdBm

...

...

undt + vn1dB1 + · · · + vnmdBm

(4.2.1)

Or, in matrix notation simply

dX(t) = udt + vdB(t) ,

(4.2.2)

where

X (t)

 =

X1...(t),

Xn(t)

u

 =

u1 ...

 ,

un

v =v1...1

···

v1m ...

 ,

vn1 · · · vnm

dB(t)

 =

dB1(t) ...

 

dBm(t)

(4.2.3)

Such a process X(t) is called an n-dimensional It^o process (or just an It^o

process).

We now ask: What is the result of applying a smooth function to X? The

answer is given by

Theorem 4.2.1 (The general It^o formula). Let
dX(t) = udt + vdB(t)
be an n-dimensional It^o process as above. Let g(t, x) = (g1(t, x), . . . , gp(t, x)) be a C2 map from [0, ) × Rn into Rp. Then the process

4.3 The Martingale Representation Theorem

49

Y (t, ) = g(t, X(t))

is again an It^o process, whose component number k, Yk, is given by

dYk

=

gk t

(t, X)dt

+

i

gk xi

(t,

X )dXi

+

1 2

i,j

2gk xixj

(t,

X

)dXidXj

where dBidBj = ijdt, dBidt = dtdBi = 0.

The proof is similar to the 1-dimensional version (Theorem 4.1.2) and is omitted.

Example 4.2.2. Let B = (B1, . . . , Bn) be Brownian motion in Rn, n  2, and consider

R(t, )

=

|B(t, )|

=

(B12

(t,

)

+

·

·

·

+

Bn2

(t,

))

1 2

,

i.e. the distance to the origin of B(t, ). The function g(t, x) = |x| is not C2
at the origin, but since Bt never hits the origin, a.s. when n  2 (see Exercise 9.7) It^o's formula still works and we get

dR =

n

BidBi R

+

n-1 2R

dt

.

i=1

The process R is called the n-dimensional Bessel process because its generator

(Chapter 7) is the Bessel differential operator Af (x) =

1 2

f

(x)

+

n-1 2x

f

(x).

See Example 8.4.1.

4.3 The Martingale Representation Theorem

Let B(t) = (B1(t), . . . , Bn(t)) be n-dimensional Brownian motion. In Chapter 3 (Corollary 3.2.6) we proved that if v  Vn then the It^o integral

t
Xt = X0 + v(s, )dB(s) ;
0

t0

is always a martingale w.r.t. filtration Ft(n) (and w.r.t. the probability measure P ). In this section we will prove that the converse is also true: Any Ft(n)-martingale (w.r.t. P ) can be represented as an It^o integral. This result, called the martingale representation theorem, is important for many applications, for example in mathematical finance. See Chapter 12. For simplicity we prove the result only when n = 1, but the reader can easily verify that essentially the same proof works for arbitrary n.

We first establish some auxiliary results.

50

4. The It^o Formula and the Martingale ...

Lemma 4.3.1. Fix T > 0. The set of random variables

{(Bt1 , . . . , Btn ); ti  [0, T ],   C0(Rn), n = 1, 2, . . .} is dense in L2(FT , P ). Proof. Let {ti} i=1 be a dense subset of [0, T ] and for each n = 1, 2, . . . let Hn be the -algebra generated by Bt1 (·), . . . , Btn (·). Then clearly
Hn  Hn+1
and FT is the smallest -algebra containing all the Hn's. Choose g  L2(FT , P ). Then by the martingale convergence theorem Corollary C.9 (Appendix C) we have that

g

=

E[g|FT

]

=

lim
n

E[g|Hn]

.

The limit is pointwise a.e. (P ) and in L2(FT , P ). By the Doob-Dynkin Lemma (Lemma 2.1.2) we can write, for each n,

E[g|Hn] = gn(Bt1 , . . . , Btn ) for some Borel measurable function gn: Rn  R. Each such gn(Bt1 , . . . , Btn ) can be approximated in L2(FT , P ) by functions n(Bt1 , . . . , Btn ) where n  C0(Rn) and the result follows. Lemma 4.3.2. The linear span of random variables of the type

T

T

exp

h(t)dBt()

-

1 2

h2(t)dt ;

h  L2[0, T ] (deterministic)

0

0

(4.3.1)

is dense in L2(FT , P ).

Proof. Suppose g  L2(FT , P ) is orthogonal (in L2(FT , P )) to all functions of the form (4.3.1). Then in particular

G(): = exp{1Bt1 () + · · · + nBtn ()}g()dP () = 0


(4.3.2)

for all  = (1, . . . , n)  Rn and all t1, . . . , tn  [0, T ]. The function G() is real analytic in   Rn and hence G has an analytic extension to the complex space Cn given by

G(z) = exp{z1Bt1 () + · · · + znBtn ()}g()dP ()


(4.3.3)

4.3 The Martingale Representation Theorem

51

for all z = (z1, . . . , zn)  Cn. (See the estimates in Exercise 2.8 b).) Since G = 0 on Rn and G is analytic, G = 0 on Cn. In particular, G(iy1, iy2, . . . , iyn) = 0 for all y = (y1, . . . , yn)  Rn. But then we get, for   C0(Rn),

(Bt1 , . . . , Btn )g()dP ()


= (2)-n/2

(y)ei(y1Bt1 +···+ynBtn )dy g()dP ()



Rn

= (2)-n/2 (y)

ei(y1Bt1 +···+ynBtn )g()dP () dy

Rn



= (2)-n/2 (y)G(iy)dy = 0 ,

(4.3.4)

Rn

where

(y) = (2)-n/2 (x)e-i x·ydx

Rn
is the Fourier transform of  and we have used the inverse Fourier transform theorem
(x) = (2)-n/2 (y)ei x·ydy

Rn
(see e.g. Folland (1984)). By (4.3.4) and Lemma 4.3.1 g is orthogonal to a dense subset of L2(FT , P )
and we conclude that g = 0. Therefore the linear span of the functions in (4.3.1) must be dense in L2(FT , P ) as claimed.
Suppose B(t) = (B1(t), . . . , Bn(t)) is n-dimensional. If v(s, )  Vn(0, T ) then the random variable

T
V (): = v(t, )dB(t)

(4.3.5)

0

is FT(n)-measurable and by the It^o isometry

T
E[V 2] = E[v2(t, ·)]dt <  ,
0

so V  L2(FT(n), P ) .

The next result states that any F  L2(FT(n), P ) can be represented this way:

Theorem 4.3.3 (The It^o representation theorem).

Let F V n (0,

 L2(FT(n), P T ) such that

).

Then

there

exists

a

unique

stochastic

process

f (t, ) 

52

4. The It^o Formula and the Martingale ...

T
F () = E[F ] + f (t, )dB(t) .

(4.3.6)

0

Proof. Again we consider only the case n = 1. (The proof in the general case is similar.) First assume that F has the form (4.3.1), i.e.

F () = exp

T

T

h(t)dBt()

-

1 2

h2(t)dt

0

0

for some h(t)  L2[0, T ]. Define

t

t

Yt() = exp

h(s)dBs()

-

1 2

h2(s)ds ;

0

0

0tT .

Then by It^o's formula

dYt

=

Yt(h(t)dBt

-

1 2

h2(t)dt)

+

1 2

Yt(h(t)dBt

)2

=

Yth(t)dBt

so that
t

Yt = 1 + Ysh(s)dBs ; t  [0, T ] .

Therefore

0 T

F = YT = 1 + Ysh(s)dBs

0
and hence E[F ] = 1. So (4.3.6) holds in this case. By linearity (4.3.6) also holds for linear combinations of functions of the form (4.3.1). So if F  L2(FT , P ) is arbitrary, we approximate F in L2(FT , P ) by linear combinations Fn of functions of the form (4.3.1). Then for each n we have

T
Fn() = E[Fn] + fn(s, )dBs(),
0
By the It^o isometry

where fn  V(0, T ) .

T
E[(Fn - Fm)2] = E (E[Fn - Fm] + (fn - fm)dB)2
0 T
= (E[Fn - Fm])2 + E[(fn - fm)2]dt  0 as n, m  
0

4.3 The Martingale Representation Theorem

53

so {fn} is a Cauchy sequence in L2([0, T ] × ) and hence converges to some f  L2([0, T ] × ). Since fn  V(0, T ) we have f  V(0, T ). (A subsequence of {fn(t, )} converges to f (t, ) for a.a. (t, )  [0, T ] × . Therefore f (t, ·) is Ft-measurable for a.a. t. So by modifying f (t, ) on a t-set of measure 0 we can obtain that f (t, ) is Ft-adapted.) Again using the It^o isometry we see that

F

=

lim
n

Fn

=

lim
n

T
E[Fn] + fndB
0

T
= E[F ] + f dB ,
0

the limit being taken in L2(FT , P ). Hence the representation (4.3.6) holds for all F  L2(FT , P ).
The uniqueness follows from the It^o isometry: Suppose

T

T

F () = E[F ] + f1(t, )dBt() = E[F ] + f2(t, )dBt()

0

0

with f1, f2  V(0, T ). Then

T

T

0 = E[( (f1(t, ) - f2(t, ))dBt())2] = E[(f1(t, ) - f2(t, ))2]dt

0

0

and therefore f1(t, ) = f2(t, ) for a.a. (t, )  [0, T ] × .

Remark. The process f (t, ) can be expressed in terms of the Frechet derivative and also in terms of the Malliavin derivative of F (). See Clark (1970/71) and Ocone (1984).

Theorem 4.3.4 (The martingale representation theorem). Let B(t) = (B1(t), . . . , Bn(t)) be n-dimensional. Suppose Mt is an Ft(n)martingale (w.r.t. P ) and that Mt  L2(P ) for all t  0. Then there exists a unique stochastic process g(s, ) such that g  V(n)(0, t) for all t  0 and

t
Mt() = E[M0] + g(s, )dB(s)
0

a.s., for all t  0 .

Proof (n = 1). By Theorem 4.3.3 applied to T = t, F = Mt, we have that for all t there exists a unique f (t)(s, )  L2(Ft, P ) such that

t

t

Mt() = E[Mt] + f (t)(s, )dBs() = E[M0] + f (t)(s, )dBs() .

0

0

Now assume 0  t1 < t2. Then

54

4. The It^o Formula and the Martingale ...

t2
Mt1 = E[Mt2 |Ft1 ] = E[M0] + E f (t2)(s, )dBs()|Ft1
0 t1
= E[M0] + f (t2)(s, )dBs() .
0
But we also have
t1
Mt1 = E[M0] + f (t1)(s, )dBs() .
0
Hence, comparing (4.3.7) and (4.3.8) we get that

(4.3.7) (4.3.8)

0=E and therefore

t1

2

t1

(f (t2) - f (t1))dB

= E[(f (t2) - f (t1))2]ds

0

0

f (t1)(s, ) = f (t2)(s, ) for a.a. (s, )  [0, t1] ×  . So we can define f (s, ) for a.a. s  [0, ) ×  by setting

f (s, ) = f (N)(s, ) if s  [0, N ]

and then we get

t

t

Mt = E[M0]+ f (t)(s, )dBs() = E[M0]+ f (s, )dBs()

0

0

for all t  0 .

Exercises
4.1. Use It^o's formula to write the following stochastic processes Xt on the standard form dXt = u(t, )dt + v(t, )dBt for suitable choices of u  Rn, v  Rn×m and dimensions n, m: a) Xt = Bt2, where Bt is 1-dimensional b) Xt = 2 + t + eBt (Bt is 1-dimensional) c) Xt = B12(t) + B22(t) where (B1, B2) is 2-dimensional d) Xt = (t0 + t, Bt) (Bt is 1-dimensional) e) Xt = (B1(t)+B2(t)+B3(t), B22(t)-B1(t)B3(t)), where (B1, B2, B3) is 3-dimensional.

Exercises

55

4.2. Use It^o's formula to prove that

t

t

Bs2dBs

=

1 3

Bt3

-

Bsds .

0

0

4.3. Let Xt, Yt be It^o processes in R. Prove that

d(XtYt) = XtdYt + YtdXt + dXt · dYt .

Deduce the following general integration by parts formula

t

t

t

XsdYs = XtYt - X0Y0 - YsdXs - dXs · dYs .

0

0

0

4.4. (Exponential martingales) Suppose (t, ) = (1(t, ), . . . , n(t, ))  Rn with k(t, )  V[0, T ] for k = 1, . . . , n, where T  . Define

Zt = exp

t

t

(s,

)dB(s)

-

1 2

2(s, )ds ;

0

0

where B(s)  Rn and 2 =  ·  (dot product). a) Use It^o's formula to prove that

0tT

dZt = Zt(t, )dB(t) .

b) Deduce that Zt is a martingale for t  T , provided that

Ztk(t, )  V[0, T ] for 1  k  n .

Remark. A sufficient condition that Zt be a martingale is the Kazamaki condition

E exp

t

1 2

(s, )dB(s)

0

<

for all t  T .

(4.3.9)

This is implied by the following (stronger) Novikov condition

E exp

T

1 2

2(s, )ds

0

<.

(4.3.10)

See e.g. Ikeda & Watanabe (1989), Section III.5, and the references therein.

56

4. The It^o Formula and the Martingale ...

4.5. Let Bt  R, B0 = 0. Define k(t) = E[Btk] ; k = 0, 1, 2, . . . ; t  0 .
Use It^o's formula to prove that

t

k (t)

=

1 2

k(k

-

1)

k-2(s)ds ;

0

k2.

Deduce that and find

E[Bt4] = 3t2 (see (2.2.14)) E[Bt6] .

4.6. a) For c,  constants, Bt  R define

Xt = ect+Bt .

Prove that

dXt

=

(c

+

1 2

2)Xtdt

+

XtdBt

.

b) For c, 1, . . . , n constants, Bt = (B1(t), . . . , Bn(t))  Rn define

n
Xt = exp ct + jBj(t) .
j=1

Prove that

n

n

dXt =

c

+

1 2

j2 Xtdt + Xt

j dBj .

j=1

j=1

4.7. Let Xt be an It^o integral dXt = v(t, )dBt() where v  Rn, v  V(0, T ), Bt  Rn, 0  t  T . a) Give an example to show that Xt2 is not in general a martingale. b) Prove that if v is bounded then

t
Mt: = Xt2 - |vs|2ds
0

is a martingale .

t
The process X, X t: = |vs|2ds is called the quadratic variation
0
process of the martingale Xt. For general processes Xt it is defined by

Exercises

57

X, X

t

=

lim
tk 0

tk

t

|Xtk+1-Xtk

|2

(limit in probability) (4.3.11)

where 0 = t1 < t2 · · · < tn = t and tk = tk+1 - tk. The limit can be shown to exist for continuous square integrable martingales Xt. See e.g. Karatzas and Shreve (1991).

4.8. a) Let Bt denote n-dimensional Brownian motion and let f : Rn  R be C2. Use It^o's formula to prove that

t

t

f (Bt) = f (B0) +

f (Bs)dBs

+

1 2

f (Bs)ds ,

0

0

where



=

n i=1

2  x2i

is

the

Laplace

operator.

b) Assume that g : R  R is C1 everywhere and C2 outside finitely

many points z1, . . . , zN with |g (x)|  M for x / {z1, . . . , zN }. Let Bt be 1-dimensional Brownian motion. Prove that the 1dimensional version of a) still holds, i.e.

t

t

g(Bt) = g(B0) +

g

(Bs)dBs

+

1 2

g (Bs)ds .

0

0

(Hint: Choose fk  C2(R) s.t. fk  g uniformly, fk  g uniformly and |fk |  M, fk  g outside z1, . . . , zN . Apply a) to fk and let k  ).

4.9. Prove that we may assume that g and its first two derivatives are
bounded in the proof of the It^o formula (Theorem 4.1.2) by proceeding
as follows: For fixed t  0 and n = 1, 2, . . . choose gn as in the statement such that gn(s, x) = g(s, x) for all s  t and all |x|  n. Suppose we have proved that (4.1.9) holds for each gn. Define the stochastic time

n = n() = inf{s > 0; |Xs()|  n}

(n is called a stopping time (See Chapter 7)) and prove that

t

v

gn x

(s,

Xs

)Xsn

dBs

:

=

0

tn
v

gn x

(s,

Xs

)dBs

=

tn
v

g x

(s,

Xs

)dBs

0

0

for each n. This gives that

58

4. The It^o Formula and the Martingale ...

g(t  n, Xtn ) = g(0, X0)

tn
+

g s

+

u

g x

+

1 2

v2

2g x2

0

ds +

tn
v

g x

dBs

0

and since

P [n > t]  1 as n  

we can conclude that (4.1.9) holds (a.s.) for g.

4.10. (Tanaka's formula and local time). What happens if we try to apply the It^o formula to g(Bt) when Bt is 1-dimensional and g(x) = |x| ? In this case g is not C2 at x = 0, so we modify g(x) near x = 0 to g (x) as follows:

where > 0.

g (x) =

|x| if |x| 

1 2

(

+ x2 )

if

|x| <

a) Apply Exercise 4.8 b) to show that

t

g (Bt) = g (B0) +

g

(Bs)dBs

+

1 2

· |{s  [0, t]; Bs  (-

,

)}|

0

where |F | denotes the Lebesgue measure of the set F . b) Prove that

t

t

g (Bs) · XBs(- , )dBs =

Bs · XBs(- , )dBs  0

0

0

in L2(P ) as  0. (Hint: Apply the It^o isometry to

E

t
Bs · XBs(- , )dBs

2

.

0

Exercises

59

c) By letting  0 prove that

t

|Bt| = |B0| + sign(Bs)dBs + Lt() ,

(4.3.12)

0

where

Lt

=

lim
0

1 2

· |{s  [0, t]; Bs  (-

,

)}|

(limit in L2(P ))

and

sign(x) =

-1 1

for for

x0 x>0

.

Lt is called the local time for Brownian motion at 0 and (4.3.12) is the Tanaka formula (for Brownian motion). (See e.g. Rogers and
Williams (1987)).

4.11. Use It^o's formula (for example in the form of Exercise 4.3) to prove

that the following stochastic processes are {Ft}-martingales:

a)

Xt

=

e

1 2

t

cos

Bt

(Bt  R)

b)

Xt

=

e

1 2

t

sin Bt

(Bt  R)

c)

Xt = (Bt + t)exp(-Bt -

1 2

t)

(Bt  R).

4.12. Let dXt = u(t, )dt + v(t, )dBt be an It^o process in Rn such that

t

t

E |u(r, )|dr + E |vvT (r, )|dr < 

for all t  0 .

0

0

Suppose Xt is an {Ft(n)}-martingale. Prove that

u(s, ) = 0 for a.a. (s, )  [0, ) ×  .

(4.3.13)

Remarks:

0) 1) This result may be regarded as a special case of the Martingale
Representation Theorem. 2) The conclusion (4.3.13) does not hold if the filtration Ft(n) is re-
placed by the -algebras Mt generated by Xs(·); s  t, i.e. if we only assume that Xt is a martingale w.r.t. its own filtration. See e.g. the Brownian motion characterization in Chapter 8.

Hint for the solution: If Xt is an Ft(n)-martingale, then deduce that

s
E u(r, )dr|Ft(n) = 0

for all s  t .

t

60

4. The It^o Formula and the Martingale ...

Differentiate w.r.t. s to deduce that E[u(s, )|Ft(n)] = 0 a.s., for a.a. s > t .
Then let t  s and apply Corollary C.9.

4.13. Let dXt = u(t, )dt + dBt (u  R, Bt  R) be an It^o process and assume for simplicity that u is bounded. Then from Exercise 4.12

we know that unless u = 0 the process Xt is not an Ft-martingale. However, it turns out that we can construct an Ft-martingale from Xt by multiplying by a suitable exponential martingale. More precisely,

define

Yt = XtMt

where

t

t

Mt = exp -

u(r,

)dBr

-

1 2

u2(r, )dr .

0

0

Use It^o's formula to prove that

Remarks:

Yt is an Ft-martingale .

a) a) Compare with Exercise 4.11 c). b) This result is a special case of the important Girsanov Theorem. It can be interpreted as follows: {Xt}tT is a martingale w.r.t the measure Q defined on FT by
dQ = MT dP (T < ) .
See Section 8.6.

4.14. In each of the cases below find the process f (t, )  V[0, T ] such that (4.3.6) holds, i.e.

T

F () = E[F ] + f (t, )dBt() .

0

a) F () = BT ()
c) F () = BT2 () e) F () = eBT ()

T
b) F () = Bt()dt
0
d) F () = BT3 ()
f) F () = sin BT ()

4.15. Let x > 0 be a constant and define

Show that

Xt

=

(x1/3

+

1 3

Bt)3

;

t0.

dXt

=

1 3

Xt1/3dt

+

Xt2/3dBt

;

X0 = x .

5. Stochastic Differential Equations

5.1 Examples and Some Solution Methods

We now return to the possible solutions Xt() of the stochastic differential equation

dXt dt

=

b(t, Xt) + (t, Xt)Wt,

b(t, x)  R, (t, x)  R

(5.1.1)

where Wt is 1-dimensional "white noise". As discussed in Chapter 3 the It^o interpretation of (5.1.1) is that Xt satisfies the stochastic integral equation

t

t

Xt = X0 + b(s, Xs)ds + (s, Xs)dBs

0

0

or in differential form

dXt = b(t, Xt)dt + (t, Xt)dBt .

(5.1.2)

Therefore, to get from (5.1.1) to (5.1.2) we formally just replace the white

noise

Wt

by

dBt dt

in

(5.1.1)

and

multiply

by

dt.

It

is

natural

to

ask:

(A) Can one obtain existence and uniqueness theorems for such equations?

What are the properties of the solutions?

(B) How can one solve a given such equation?

We will first consider question (B) by looking at some simple examples, and then in Section 5.2 we will discuss (A).
It is the It^o formula that is the key to the solution of many stochastic differential equations. The method is illustrated in the following examples.

Example 5.1.1. Let us return to the population growth model in Chapter 1:

dNt dt

=

atNt

,

N0 given

where at = rt + Wt, Wt = white noise,  = constant. Let us assume that rt = r = constant. By the It^o interpretation (5.1.2)
this equation is equivalent to (here (t, x) = x)

62

5. Stochastic Differential Equations

dNt = rNtdt + NtdBt

(5.1.3)

or

dNt Nt

=

rdt + dBt

.

Hence

t

dNs Ns

=

rt + Bt

0

(B0 = 0) .

(5.1.4)

To evaluate the integral on the left hand side we use the It^o formula for the function
g(t, x) = ln x ; x > 0

and obtain

d(ln Nt)

=

1 Nt

·

dNt

+

1 2

-

1 Nt2

(dNt)2

=

dNt Nt

-

1 2Nt2

·

2Nt2dt

=

dNt Nt

-

1 2

2dt

.

Hence

dNt Nt

=

d(ln Nt) +

1 2

2dt

so from (5.1.4) we conclude

ln

Nt N0

=

(r -

1 2

2)t

+

Bt

or

Nt

=

N0

exp((r

-

1 2

2

)t

+

Bt)

.

(5.1.5)

For comparison, referring to the discussion at the end of Chapter 3, the Stratonovich interpretation of (5.1.3),

dN t = rN tdt + N t  dBt , would have given the solution

N t = N0 exp(rt + Bt) .

(5.1.6)

The solutions Nt, N t are both processes of the type

Xt = X0 exp(µt + Bt) (µ,  constants) .

Such processes are called geometric Brownian motions. They are important also as models for stochastic prices in economics. See Chapters 10, 11, 12.

5.1 Examples and Some Solution Methods

63

Remark. It seems reasonable that if Bt is independent of N0 we should

have

E[Nt] = E[N0]ert,

()

i.e. the same as when there is no noise in at. To see if this is indeed the case, we let
Yt = eBt

and apply It^o's formula:

dYt

=

eBt dBt

+

1 2

2

eBt

dt

or

t

t

Yt = Y0 + 

eBs dBs

+

1 2

2

eBs ds .

0

0

t
Since E[ eBs dBs] = 0 (Theorem 3.2.1 (iii)), we get
0

t

E[Yt]

=

E[Y0]

+

1 2

2

E[Ys]ds

0

i.e.

d dt

E

[Yt]

=

1 2

2E

[Yt],

E

[Y0]

=

1

.

So

E[Yt]

=

e1 2

2

t

,

and therefore ­ as anticipated ­ we obtain

E[Nt] = E[N0]ert .

For the Stratonovich solution, however, the same calculation gives

E[N t]

=

E

[N0

]e(r+

1 2

2

)t

.

Now that we have found the explicit solutions Nt and N t in (5.1.5), (5.1.6) we can use our knowledge about the behaviour of Bt to gain information on these solutions. For example, for the It^o solution Nt we get the following:

(i)

If

r

>

1 2

2

then

Nt





as

t



,

a.s.

(ii)

If

r

<

1 2

2

then

Nt



0

as

t



,

a.s.

(iii)

If

r

=

1 2

2

then

Nt

will

fluctuate

between

arbitrary

large

and

arbitrary

small values as t  , a.s.

These conclusions are direct consequences of the formula (5.1.5) for Nt together with the following basic result about 1-dimensional Brownian motion
Bt:

64

5. Stochastic Differential Equations

Theorem 5.1.2 (The law of iterated logarithm).

lim sup
t

 Bt 2t log log t

=

1

a.s.

For a proof we refer to Lamperti (1977), §22.
For the Stratonovich solution N t we get by the same argument that N t  0 a.s. if r < 0 and N t   a.s. if r > 0.
Thus the two solutions have fundamentally different properties and it is an
interesting question what solution gives the best description of the situation.

Example 5.1.3. Let us return to the equation in Problem 2 of Chapter 1:

LQt

+ RQt

+

1 C

Qt

=

Ft

=

Gt

+

Wt

.

(5.1.7)

We introduce the vector

X

=

X(t, )

=

 

X1 X2

 

=

 

Qt Qt

 

and obtain

X1 = X2

LX2

=

-RX2

-

1 C

X1

+

Gt

+

Wt

or, in matrix notation,

(5.1.8)

dX = dX(t) = AX(t)dt + H(t)dt + KdBt

(5.1.9)

where

dX =

dX1 dX2

, A=

0

-

1 CL

1

-

R L

, H(t) =

0

1 L

Gt

, K=

0
 L

, (5.1.10)

and Bt is a 1-dimensional Brownian motion. Thus we are led to a 2-dimensional stochastic differential equation. We
rewrite (5.1.9) as

exp(-At)dX(t) - exp(-At)AX(t)dt = exp(-At)[H(t)dt + KdBt] , (5.1.11)

where for a general n × n matrix F we define exp(F ) to be the n × n matrix



given by exp(F ) =

1 n!

F

n

.

Here

it

is

tempting

to

relate

the

left

hand

side

n=0

to

d(exp(-At)X(t)) .

To do this we use a 2-dimensional version of the It^o formula (Theorem 4.2.1). Applying this result to the two coordinate functions g1, g2 of

g: [0, ) × R2  R2

given by

g(t, x1, x2) = exp(-At)

x1 x2

,

5.1 Examples and Some Solution Methods

65

we obtain that

d(exp(-At)X(t)) = (-A) exp(-At)X(t)dt + exp(-At)dX(t) .

Substituted in (5.1.11) this gives

t

t

exp(-At)X(t) - X(0) = exp(-As)H(s)ds + exp(-As)KdBs

0

0

or

X(t) = exp(At)[X(0) + exp(-At)KBt
t
+ exp(-As)[H(s) + AKBs]ds] ,
0
by integration by parts (Theorem 4.1.5).

(5.1.12)

Example 5.1.4. Choose X = B, 1-dimensional Brownian motion, and

g(t, x) = eix = (cos x, sin x)  R2 for x  R .

Then

Y = g(t, X) = eiB = (cos B, sin B)

is by It^o's formula again an It^o process. Its coordinates Y1, Y2 satisfy

dY1(t)

=

-

sin(B)dB

-

1 2

cos(B)dt

dY2(t)

=

cos(B)dB

-

1 2

sin(B)dt

.

Thus the process Y = (Y1, Y2), which we could call Brownian motion on the unit circle, is the solution of the stochastic differential equations

Or, in matrix notation,

dY1

=

-

1 2

Y1dt

-

Y2dB

dY2

=

-

1 2

Y2dt

+

Y1dB

.

(5.1.13)

dY

=

-

1 2

Y

dt

+

KY

dB

,

where K =

0 -1 10

.

Other examples and solution methods can be found in the exercises of this chapter.
For a comprehensive description of reduction methods for 1-dimensional stochastic differential equations see Gard (1988), Chapter 4.

66

5. Stochastic Differential Equations

5.2 An Existence and Uniqueness Result

We now turn to the existence and uniqueness question (A) above.
Theorem 5.2.1. (Existence and uniqueness theorem for stochastic differential equations).
Let T > 0 and b(·, ·): [0, T ] × Rn  Rn, (·, ·): [0, T ] × Rn  Rn×m be measurable functions satisfying

|b(t, x)| + |(t, x)|  C(1 + |x|) ; x  Rn, t  [0, T ]

(5.2.1)

for some constant C, (where ||2 = |ij|2) and such that |b(t, x) - b(t, y)| + |(t, x) - (t, y)|  D|x - y| ; x, y  Rn, t  [0, T ] (5.2.2)

for some constant D. Let Z be a random variable which is independent of the -algebra F(m) generated by Bs(·), s  0 and such that
E[|Z|2] <  .

Then the stochastic differential equation

dXt = b(t, Xt)dt + (t, Xt)dBt , 0  t  T, X0 = Z

(5.2.3)

has a unique t-continuous solution Xt() with the property that

Xt() is adapted to the filtration FtZ generated by Z and Bs(·); s  t (5.2.4)

and
T

E |Xt|2dt <  .

(5.2.5)

0

Remarks. Conditions (5.2.1) and (5.2.2) are natural in view of the following two simple examples from deterministic differential equations (i.e.  = 0):

a) The equation

dXt dt

=

Xt2,

X0 = 1

(5.2.6)

corresponding to b(x) = x2 (which does not satisfy (5.2.1)) has the

(unique) solution

Xt

=

1

1 -

t

;

0t<1.

Thus it is impossible to find a global solution (defined for all t) in this case. More generally, condition (5.2.1) ensures that the solution Xt() of (5.2.3) does not explode, i.e. that |Xt()| does not tend to  in a finite time.

5.2 An Existence and Uniqueness Result

67

b) The equation

dXt dt

=

3Xt2/3

;

X0 = 0

has more than one solution. In fact, for any a > 0 the function

(5.2.7)

Xt =

0 (t - a)3

for for

ta t>a

solves (5.2.7). In this case b(x) = 3x2/3 does not satisfy the Lipschitz condition (5.2.2) at x = 0. Thus condition (5.2.2) guarantees that equation (5.2.3) has a unique solution. Here uniqueness means that if X1(t, ) and X2(t, ) are two tcontinuous processes satisfying (5.2.3), (5.2.4) and (5.2.5) then

X1(t, ) = X2(t, ) for all t  T , a.s.

(5.2.8)

Proof of Theorem 5.2.1. The uniqueness follows from the It^o isometry (Corollary 3.1.7) and the Lipschitz property (5.2.2): Let X1(t, ) = Xt() and X2(t, ) = Xt() be solutions with initial values Z, Z respectively, i.e. X1(0, ) = Z(), X2(0, ) = Z(),   . For our purposes here we only need the case Z = Z, but the following more general estimate will be useful for us later, in connection with Feller continuity (Chapter 8).
Put a(s, ) = b(s, Xs) - b(s, Xs) and (s, ) = (s, Xs) - (s, Xs). Then

t

t

2

E[|Xt - Xt|2] = E Z - Z + ads + dBs

 3E[|Z - Z|2] + 3E

0

0

t

2

ads + 3E

t

2

dBs

 3E[|Z - Z|2] + 3tE

0 t
a2ds + 3E

0 t
2ds

0

0

t

 3E[|Z - Z|2] + 3(1 + t)D2 E[|Xs - Xs|2]ds .

0

So the function

satisfies

v(t) = E[|Xt - Xt|2] ;
t
v(t)  F + A v(s)ds ,

0tT

(5.2.9)

0
where F = 3E[|Z - Z|2] and A = 3(1 + T )D2 .

68

5. Stochastic Differential Equations

By the Gronwall inequality (Exercise 5.17) we conclude that

v(t)  F exp(At) .

(5.2.10)

Now assume that Z = Z. Then F = 0 and so v(t) = 0 for all t  0. Hence

P [|Xt - Xt| = 0 for all t  Q  [0, T ]] = 1 ,

where Q denotes the rational numbers. By continuity of t  |Xt - Xt| it follows that

P [|X1(t, ) - X2(t, )| = 0 for all t  [0, T ]] = 1 ,

(5.2.11)

and the uniqueness is proved.
The proof of the existence is similar to the familiar existence proof for ordinary differential equations: Define Yt(0) = X0 and Yt(k) = Yt(k)() inductively as follows

t

t

Yt(k+1) = X0 + b(s, Ys(k))ds + (s, Ys(k))dBs .

0

0

Then, similar computation as for the uniqueness above gives

(5.2.12)

t
E[|Yt(k+1) - Yt(k)|2]  (1 + T )3D2 E[|Ys(k) - Ys(k-1)|2]ds ,
0
for k  1, t  T and

E[|Yt(1) - Yt(0)|2]  2C2t2(1 + E[|X0|2]) +2C2t(1 + E[|X0|2])  A1t

where the constant A1 only depends on C, T and E[|X0|2]. So by induction on k we obtain

E[|Yt(k+1) - Yt(k)|2] 

Ak2+1tk+1 (k + 1)!

;

k  0, t  [0, T ]

(5.2.13)

for some suitable constant A2 depending only on C, D, T and E[|X0|2]. Now

T

sup |Yt(k+1) - Yt(k)|  |b(s, Ys(k)) - b(s, Ys(k-1))|ds
0tT 0

t

+ sup

((s, Ys(k)) - (s, Ys(k-1)))dBs .

0tT

0

5.2 An Existence and Uniqueness Result

69

By the martingale inequality (Theorem 3.2.4) we obtain

P sup |Yt(k+1) - Yt(k)| > 2-k
0tT

T

2

P

|b(s, Ys(k)) - b(s, Ys(k-1))|ds > 2-2k-2

0 t

+P sup

((s, Ys(k)) - (s, Ys(k-1)))dBs > 2-k-1

0tT

0

T

 22k+2T E(|b(s, Ys(k)) - b(s, Ys(k-1))|2)ds

0

T

+22k+2 E[|(s, Ys(k)) - (s, Ys(k-1))|2]ds

0

T

 22k+2D2(T + 1)

A2k tk k!

dt



(4A2T )k+1 (k + 1)!

,

0

if A2  D2(T + 1) .

Therefore, by the Borel-Cantelli lemma,

P sup |Yt(k+1) - Yt(k)| > 2-k for infinitely many k = 0 .
0tT

Thus, for a.a.  there exists k0 = k0() such that

sup |Yt(k+1) - Yt(k)|  2-k
0tT

for k  k0 .

Therefore the sequence

n-1
Yt(n)() = Yt(0)() + (Yt(k+1)() - Yt(k)())
k=0
is uniformly convergent in [0, T ], for a.a. . Denote the limit by Xt = Xt(). Then Xt is t-continuous for a.a.  since
Yt(n) is t-continuous for all n. Moreover, Xt(·) is FtZ -measurable for all t, since Yt(n)(·) has this property for all n.
Next, note that for m > n  0 we have by (5.2.13)

E[|Yt(m) -Yt(n)|2]1/2 = Yt(m) -Yt(n) L2(P ) =

m-1

(Yt(k+1) -Yt(k))
k=n

L2(P )

m-1





Yt(k+1) -Yt(k) L2(P ) 

(A2t)k+1 (k + 1)!

1/2
0

k=n

k=n

as n   .

(5.2.14)

70

5. Stochastic Differential Equations

So {Yt(n)} converges in L2(P ) to a limit Yt, say. A subsequence of Yt(n)() will then converge -pointwise to Yt() and therefore we must have Yt = Xt a.s. In particular, Xt satisfies (5.2.4) and (5.2.5).
It remains to show that Xt satisfies (5.2.3). For all n we have

t

t

Yt(n+1) = X0 + b(s, Ys(n))ds + (s, Ys(n))dBs .

0

0

(5.2.15)

Now Yt(n+1)  Xt as n  , uniformly in t  [0, T ] for a.a. . By (5.2.14) and the Fatou lemma we have

T

T

E |Xt - Yt(n)|2dt  lim sup E |Yt(m) - Yt(n)|2dt  0

m

0

0

as n  . It follows by the It^o isometry that

t

t

(s, Ys(n))dBs  (s, Xs)dBs

0

0

and by the H¨older inequality that

t

t

b(s, Ys(n))ds  b(s, Xs)ds

0

0

in L2(P ). Therefore, taking the limit of (5.2.15) as n   we obtain (5.2.3) for Xt.

5.3 Weak and Strong Solutions
The solution Xt found above is called a strong solution, because the version Bt of Brownian motion is given in advance and the solution Xt constructed from it is FtZ -adapted. If we are only given the functions b(t, x) and (t, x) and ask for a pair of processes ((Xt, Bt), Ht) on a probability space (, H, P ) such that (5.2.3) holds, then the solution Xt (or more precisely (Xt, Bt)) is called a weak solution. Here Ht is an increasing family of -algebras such that Xt is Ht-adapted and Bt is an Ht-Brownian motion, i.e. Bt is a Brownian motion, and Bt is a martingale w.r.t. Ht (and so E[Bt+h - Bt|Ht] = 0 for all t, h  0). Recall from Chapter 3 that this allows us to define the It^o integral on the right hand side of (5.2.3) exactly as before, even though Xt need not be FtZ -adapted.

5.3 Weak and Strong Solutions

71

A strong solution is of course also a weak solution, but the converse is not true in general. See Example 5.3.2 below.
The uniqueness (5.2.8) that we obtain above is called strong or pathwise uniqueness, while weak uniqueness simply means that any two solutions (weak or strong) are identical in law, i.e. have the same finite-dimensional distributions. See Stroock and Varadhan (1979) for results about existence and uniqueness of weak solutions. A general discussion about strong and weak solutions can be found in Krylov and Zvonkin (1981).

Lemma 5.3.1. If b and  satisfy the conditions of Theorem 5.2.1 then we have
A solution (weak or strong) of (5.2.3) is weakly unique .

Sketch of proof . Let ((Xt, Bt), Ht) and ((Xt, Bt), Ht) be two weak solutions. Let Xt and Yt be the strong solutions constructed from Bt and Bt, respectively, as above. Then the same uniqueness argument as above applies to show that Xt = Xt and Yt = Xt for all t, a.s. Therefore it suffices to show that Xt and Yt must be identical in law. We show this by proving by induction that if Xt(k), Yt(k) are the processes in the Picard iteration defined by (5.2.12) with Brownian motions Bt and Bt, then
(Xt(k), Bt) and (Yt(k), Bt)
have the same law for all k.

This observation will be useful for us in Chapter 7 and later, where we will investigate further the properties of processes which are solutions of stochastic differential equations (It^o diffusions).
From a modelling point of view the weak solution concept is often natural, because it does not specify beforehand the explicit representation of the white noise. Moreover, the concept is convenient for mathematical reasons, because there are stochastic differential equations which have no strong solutions but still a (weakly) unique weak solution. Here is a simple example:

Example 5.3.2 (The Tanaka equation). Consider the 1-dimensional stochastic differential equation

dXt = sign(Xt)dBt ; X0 = 0 .

(5.3.1)

where

sign(x) =

+1 if x  0 -1 if x < 0 .

Note that here (t, x) = (x) = sign(x) does not satisfy the Lipschitz condition (5.2.2), so Theorem 5.2.1 does not apply. Indeed, the equation (5.3.1)
has no strong solution. To see this, let Bt be a Brownian motion generating the filtration Ft and define

72

5. Stochastic Differential Equations

t
Yt = sign(Bs)dBs .
0
By the Tanaka formula (4.3.12) (Exercise 4.10) we have

Yt = | Bt| - | B0| - Lt() ,

where Lt() is the local time for Bt() at 0. It follows that Yt is measurable
w.r.t. the -algebra Gt generated by | Bs(·)|; s  t, which is clearly strictly
contained in Ft. Hence the -algebra Nt generated by Ys(·); s  t is also
strictly contained in Ft. Now suppose Xt is a strong solution of (5.3.1). Then by Theorem 8.4.2
it follows that Xt is a Brownian motion w.r.t. the measure P . (In case the reader is worried about the possibility of a circular argument, we point out that the proof of Theorem 8.4.2 is independent of this example!) Let Mt be the -algebra generated by Xs(·); s  t. Since (sign(x))2 = 1 we can rewrite (5.3.1) as
dBt = sign(Xt)dXt .

By the above argument applied to Bt = Xt, Yt = Bt we conclude that Ft is strictly contained in Mt.
But this contradicts that Xt is a strong solution. Hence strong solutions of (5.3.1) do not exist.
To find a weak solution of (5.3.1) we simply choose Xt to be any Brownian
motion Bt. Then we define Bt by

t

t

Bt = sign(Bs)dBs = sign(Xs)dXs

0

0

i.e. dBt = sign(Xt)dXt .

Then

dXt = sign(Xt)dBt ,

so Xt is a weak solution. Finally, weak uniqueness follows from Theorem 8.4.2, which ­ as noted
above ­ implies that any weak solution Xt must be a Brownian motion w.r.t. P.

Exercises
5.1. Verify that the given processes solve the given corresponding stochastic differential equations: (Bt denotes 1-dimensional Brownian motion)

Exercises

73

(i)

Xt

=

eBt

solves

dXt

=

1 2

Xtdt

+

Xt

dBt

(ii)

Xt

=

Bt 1+t

;

B0

=

0

solves

dXt

=

-1

1 +

t Xtdt

+

1

1 +

t dBt

;

(iii)

Xt

= sin Bt

with

B0

=

a



(-

 2

,

 2

)

solves

X0 = 0

dXt

=

-

1 2

Xt

dt

+

1-Xt2dBt for t < inf

s > 0; Bs /

-

 2

,

 2

(iv) (X1(t), X2(t)) = (t, etBt) solves

dX1 dX2

=

1 X2

dt +

0 eX1

dBt

(v) (X1(t), X2(t)) = (cosh(Bt), sinh(Bt)) solves

dX1 dX2

=

1 2

X1 X2

dt +

X2 X1

dBt .

5.2. A natural candidate for what we could call Brownian motion on the

ellipse

(x, y);

x2 a2

+

y2 b2

=

1

where a > 0, b > 0

is the process Xt = (X1(t), X2(t)) defined by

X1(t) = a cos Bt , X2(t) = b sin Bt

where Bt is 1-dimensional Brownian motion. Show that Xt is a solution of the stochastic differential equation

dXt

=

-

1 2

Xtdt

+

M XtdBt

where M =

0
b a

-

a b

0

.

5.3. Let (B1, . . . , Bn) be Brownian motion in Rn, 1, . . . , n constants. Solve the stochastic differential equation

n

dXt = rXtdt + Xt

kdBk(t) ;

k=1

X0 > 0 .

(This is a model for exponential growth with several independent white noise sources in the relative growth rate).
5.4. Solve the following stochastic differential equations:

74

5. Stochastic Differential Equations

(i)

dX1 dX2

=

1 0

dt +

1 0

0 X1

dB1 dB2

(ii) dXt = Xtdt + dBt (Hint: Multiply both sides with "the integrating factor" e-t and

compare with d(e-tXt)) (iii) dXt = -Xtdt + e-tdBt.

5.5. a) Solve the Ornstein-Uhlenbeck equation (or Langevin equation)

dXt = µXtdt + dBt
where µ,  are real constants, Bt  R. The solution is called the Ornstein-Uhlenbeck process. (Hint: See Exercise 5.4 (ii).) b) Find E[Xt] and Var[Xt]: = E[(Xt - E[Xt])2].
5.6. Solve the stochastic differential equation

dYt = r dt + YtdBt
where r,  are real constants, Bt  R. (Hint: Multiply the equation by the 'integrating factor'

Ft = exp

-

Bt

+

1 2

2t

.)

5.7. The mean-reverting Ornstein-Uhlenbeck process is the solution Xt of the stochastic differential equation

dXt = (m - Xt)dt + dBt
where m,  are real constants, Bt  R. a) Solve this equation by proceeding as in Exercise 5.5 a). b) Find E[Xt] and Var[Xt]: = E[(Xt - E[Xt])2].
5.8. Solve the (2-dimensional) stochastic differential equation

dX1(t) = X2(t)dt + dB1(t) dX2(t) = -X1(t)dt + dB2(t)
where (B1(t), B2(t)) is 2-dimensional Brownian motion and ,  are constants. This is a model for a vibrating string subject to a stochastic force. See Example 5.1.3.

5.9. Show that there is a unique strong solution Xt of the 1-dimensional stochastic differential equation

dXt = ln(1 + Xt2)dt + X{Xt>0} XtdBt ,

X0 = a  R .

Exercises

75

5.10. Let b,  satisfy (5.2.1), (5.2.2) and let Xt be the unique strong solution of (5.2.3). Show that

E[|Xt|2]  K1 · exp(K2t) for t  T
where K1 = 3E[|Z|2] + 6C2T (T + 1) and K2 = 6(1 + T )C2. (Hint: Use the argument in the proof of (5.2.10)).

(5.3.2)

Remark. With global estimates of the growth of b and  in (5.2.1) it is possible to improve (5.3.2) to a global estimate of E[|Xt|2]. See Exercise 7.5.

5.11. (The Brownian bridge). For fixed a, b  R consider the following 1-dimensional equation

dYt

=

b - Yt 1-t

dt

+

dBt

;

0  t < 1 , Y0 = a .

(5.3.3)

Verify that

t

Yt = a(1 - t) + bt + (1 - t)

dBs 1-s

;

0

0t<1

(5.3.4)

solves

the

equation

and

prove

that

lim
t1

Yt

=

b

a.s.

The

process

Yt

is

called the Brownian bridge (from a to b). For other characterizations

of Yt see Rogers and Williams (1987, pp. 86­89).

5.12. To describe the motion of a pendulum with small, random perturbations in its environment we try an equation of the form

y (t) + (1 + Wt)y = 0 ; y(0), y (0) given ,

where

Wt

=

dBt dt

is

1-dimensional

white

noise,

> 0 is constant.

a) Discuss this equation, for example by proceeding as in Exam-

ple 5.1.3.

b) Show that y(t) solves a stochastic Volterra equation of the form

t

t

y(t) = y(0) + y (0) · t + a(t, r)y(r)dr + (t, r)y(r)dBr

0

0

where a(t, r) = r - t, (t, r) = (r - t).

5.13. As a model for the horizontal slow drift motions of a moored floating platform or ship responding to incoming irregular waves John Grue (1989) introduced the equation

xt + a0xt + w2xt = (T0 - 0xt)Wt ,

(5.3.5)

where Wt is 1-dimensional white noise, a0, w, T0, 0 and  are constants.

76

5. Stochastic Differential Equations

(i)

Put Xt =

xt xt

and rewrite the equation in the form

dXt = AXtdt + KXtdBt + M dBt ,

where

A=

0 -w2

1 -a0

,

K = 0

0 0

0 -1

and

M = T0

0 1

.

(ii) Show that Xt satisfies the integral equation

t

t

Xt = eA(t-s)KXsdBs + eA(t-s)M dBs

0

0

(iii) Verify that

if X0 = 0 .

eAt

=

e-t 

{(

cos t

+

 sin t)I

+

A sin t}

where

=

a0 2

,



= (w2 -

) a20
4

1 2

and

use

this

to

prove

that

t
xt =  (T0 - 0ys)gt-sdBs
0

(5.3.6)

and

t
yt =  (T0 - 0ys)ht-sdBs ,
0

with yt: = xt , (5.3.7)

where

gt

=

1 

Im(e

t

)

ht

=

1 

Im(

e¯t)

,

  = - + i (i = -1) .

So we can solve for yt first in (5.3.7) and then substitute in (5.3.6) to find xt.
5.14. If (B1, B2) denotes 2-dimensional Brownian motion we may introduce complex notation and put  B(t): = B1(t) + iB2(t) (i = -1) .

B(t) is called complex Brownian motion.

Exercises

77

(i) If F (z) = u(z) + iv(z) is an analytic function i.e. F satisfies the Cauchy-Riemann equations

u x

=

v y

,

u y

=

-

v x

;

z = x + iy

and we define

Zt = F (B(t))

prove that

dZt = F (B(t))dB(t) ,

(5.3.8)

where F is the (complex) derivative of F . (Note that the usual second order terms in the (real) It^o formula are not present in (5.3.8)!) (ii) Solve the complex stochastic differential equation

dZt = ZtdB(t)  constant) .
For more information about complex stochastic calculus involving analytic functions see e.g. Ubøe (1987).

5.15. (Population growth in a stochastic, crowded environment) The nonlinear stochastic differential equation

dXt = rXt(K - Xt)dt + XtdBt ; X0 = x > 0

(5.3.9)

is often used as a model for the growth of a population of size Xt in a stochastic, crowded environment. The constant K > 0 is called the carrying capacity of the environment, the constant r  R is a measure of the quality of the environment and the constant   R is a measure of the size of the noise in the system. Verify that

Xt =

exp{(rK

-

1 2

2)t

+

Bt}

t

;

x-1 + r

exp{(rK

-

1 2



2)s

+

Bs}ds

0

t  0 (5.3.10)

is the unique (strong) solution of (5.3.9). (This solution can be found by performing a substitution (change of variables) which reduces (5.3.9) to a linear equation. See Gard (1988), Chapter 4 for details.)

5.16. The technique used in Exercise 5.6 can be applied to more general nonlinear stochastic differential equations of the form

dXt = f (t, Xt)dt + c(t)XtdBt , X0 = x

(5.3.11)

where f : R × R  R and c: R  R are given continuous (deterministic) functions. Proceed as follows:

78

5. Stochastic Differential Equations

a) Define the 'integrating factor'

Ft = Ft() = exp

t

t

-

c(s)dBs

+

1 2

c2(s)ds .

0

0

Show that (5.3.11) can be written

(5.3.12)

d(FtXt) = Ft · f (t, Xt)dt .

b) Now define

Yt() = Ft()Xt()

so that

Xt = Ft-1Yt .

Deduce that equation (5.3.13) gets the form

(5.3.13) (5.3.14) (5.3.15)

dYt() dt

=

Ft()

·

f (t, Ft-1()Yt())

;

Y0 = x .

(5.3.16)

Note that this is just a deterministic differential equation in the
function t  Yt(), for each   . We can therefore solve (5.3.16) with  as a parameter to find Yt() and then obtain Xt() from (5.3.15).
c) Apply this method to solve the stochastic differential equation

dXt

=

1 Xt

dt

+

XtdBt

;

X0 = x > 0

(5.3.17)

where  is constant. d) Apply the method to study the solutions of the stochastic differen-
tial equation

dXt = Xt dt + XtdBt ;

X0 = x > 0

(5.3.18)

where  and  are constants. For what values of  do we get explosion?

5.17. (The Gronwall inequality) Let v(t) be a nonnegative function such that

t
v(t)  C + A v(s)ds
0
for some constants C, A. Prove that

for 0  t  T

v(t)  C exp(At) for 0  t  T .

(5.3.19)

Exercises

79

t
(Hint: We may assume A = 0. Define w(t) = v(s)ds . Then w (t) 
0
C + Aw(t). Deduce that

w(t)



C A

(exp(At)

-

1)

(5.3.20)

by considering f (t): = w(t) exp(-At). Use (5.3.20) to deduce (5.3.19.)

80

5. Stochastic Differential Equations

6. The Filtering Problem

6.1 Introduction

Problem 3 in the introduction is a special case of the following general filtering
problem : Suppose the state Xt  Rn at time t of a system is given by a stochastic
differential equation

dXt dt

=

b(t, Xt) +

(t, Xt)Wt

,

t0,

(6.1.1)

where b: Rn+1  Rn, : Rn+1  Rn×p satisfy conditions (5.2.1), (5.2.2) and
Wt is p-dimensional white noise. As discussed earlier the It^o interpretation of this equation is

(system)

dXt = b(t, Xt)dt + (t, Xt)dUt ,

(6.1.2)

where Ut is p-dimensional Brownian motion. We also assume that the distribution of X0 is known and independent of Ut. Similarly to the 1-dimensional situation (3.3.6) there is an explicit several-dimensional formula which ex-
presses the Stratonovich interpretation of (6.1.1):

dXt = b(t, Xt)dt + (t, Xt)  dUt in terms of It^o integrals as follows:

dXt = b(t, Xt)dt + (t, Xt)dUt , where

bi(t, x)

=

bi(t, x)

+

1 2

pn j=1 k=1

ij xk

kj

;

1in.

(6.1.3)

(See Stratonovich (1966)). From now on we will use the It^o interpretation
(6.1.2).
In the continuous version of the filtering problem we assume that the observations Ht  Rm are performed continuously and are of the form

Ht = c(t, Xt) + (t, Xt) · Wt ,

(6.1.4)

82

6. The Filtering Problem

where c: Rn+1  Rm, : Rn+1  Rm×r are functions satisfying (5.2.1) and
Wt denotes r-dimensional white noise, independent of Ut and X0. To obtain a tractable mathematical interpretation of (6.1.4) we introduce

t
Zt = Hsds
0
and thereby we obtain the stochastic integral representation

(6.1.5)

(observations)

dZt = c(t, Xt)dt + (t, Xt)dVt , Z0 = 0

(6.1.6)

where Vt is r-dimensional Brownian motion, independent of Ut and X0. Note that if Hs is known for 0  s  t, then Zs is also known for 0  s  t
and conversely. So no information is lost or gained by considering Zt as our "observations" instead of Ht. But this allows us to obtain a well-defined mathematical model of the situation.
The filtering problem is the following:
Given the observations Zs satisfying (6.1.6) for 0  s  t, what is the best
estimate Xt of the state Xt of the system (6.1.2) based on these observations? As we have pointed out earlier, it is necessary to find a precise mathe-
matical formulation of this problem: By saying that the estimate Xt is based on the observations {Zs; s  t} we mean that

Xt(·) is Gt-measurable, where Gt is the -algebra generated by {Zs(·), s  t} . (6.1.7)

By saying that Xt is the best such estimate we mean that

|Xt - Xt|2dP = E[|Xt - Xt|2] = inf{E[|Xt - Y |2]; Y  K} . (6.1.8)

Here ­ and in the rest of this chapter ­ (, F, P ) is the probability space corresponding to the (p + r)-dimensional Brownian motion (Ut, Vt) starting at 0, E denotes expectation w.r.t. P and
K: = Kt: = K(Z, t): = {Y :   Rn; Y  L2(P ) and Y is Gt-measurable} , (6.1.9)
where L2(P ) = L2(, P ). Having found the mathematical formulation of our problem, we now start
to study the properties of the solution Xt. We first establish the following useful connection between conditional ex-
pectation and projection:
Lemma 6.1.1. Let H  F be a -algebra and let X  L2(P ) be F measurable. Put N = {Y  L2(P ); Y is H-measurable} and let PN denote

6.2 The 1-Dimensional Linear Filtering Problem

83

the (orthogonal) projection from the Hilbert space L2(P ) into the subspace N . Then
PN (X) = E[X|H] .
Proof. Recall (see Appendix B) that E[X|H] is by definition the P -unique function from  to R such that

(i) E[X|H] is H-measurable

(ii) E[X|H]dP = XdP for all A  H.

A

A

Now PN (X) is H-measurable and

Y (X - PN (X))dP = 0

In particular,

for all Y  N .

(X - PN (X))dP = 0
A

i.e.

PN (X)dP = XdP

A

A

Hence, by uniqueness, PN (X) = E[X|H].

for all A  H for all A  H .

From the general theory of Hilbert spaces we know that the solution Xt of the problem (6.1.8) is given by the projection PKt (Xt). Therefore Lemma 6.1.1 leads to the following useful result:

Theorem 6.1.2.

Xt = PKt (Xt) = E[Xt|Gt] .

This is the basis for the general Fujisaki-Kallianpur-Kunita equation of filtering theory. See for example Bensoussan (1992), Davis (1984) or Kallianpur (1980).

6.2 The 1-Dimensional Linear Filtering Problem
From now on we will concentrate on the linear case, which allows an explicit solution in terms of a stochastic differential equation for Xt (the KalmanBucy filter ):
In the linear filtering problem the system and observation equations have the form:

84

6. The Filtering Problem

(linear system) (linear observations)

dXt = F (t)Xtdt+C(t)dUt; F (t)  Rn×n, C(t)  Rn×p
dZt = G(t)Xtdt+D(t)dVt; G(t)  Rm×n, D(t)  Rm×r

(6.2.1) (6.2.2)

To be able to focus on the main ideas in the solution of the filtering problem, we will first consider only the 1-dimensional case:

(linear system)

dXt = F (t)Xtdt + C(t)dUt; F (t), C(t)  R

(linear observations) dZt = G(t)Xtdt + D(t)dVt; G(t), D(t)  R

(6.2.3) (6.2.4)

We assume (see (5.2.1)) that F, G, C, D are bounded on bounded intervals. Based on our interpretation (6.1.5) of Zt we assume Z0 = 0. We also assume that X0 is normally distributed (and independent of {Ut}, {Vt}). Finally we assume that D(t) is bounded away from 0 on bounded intervals.
The (important) extension to the several-dimensional case (6.2.1), (6.2.2) is technical, but does not require any essentially new ideas. Therefore we shall only state the result for this case (in the next section) after we have discussed the 1-dimensional situation. The reader is encouraged to work out the necessary modifications for the general case for himself or consult Bensoussan (1992), Davis (1977) or Kallianpur (1980) for a full treatment.
From now on we let Xt, Zt be processes satisfying (6.2.3), (6.2.4). Here is an outline of the solution of the filtering problem in this case.

Step 1. Let L = L(Z, t) be the closure in L2(P ) of functions which are linear combinations of the form

c0 + c1Zs1 () + · · · + ckZsk () , with sj  t, cj  R .
Let PL denote the projection from L2(P ) onto L .
Then, with K as in (6.1.9),

Xt = PK(Xt) = E[Xt|Gt] = PL(Xt) .
Thus, the best Z-measurable estimate of Xt coincides with the best Z-linear estimate of Xt.
Step 2. Replace Zt by the innovation process Nt:
t
Nt = Zt - (GX)s ds , where (GX)s = PL(Z,s)(G(s)Xs) = G(s)Xs .
0
Then
(i) Nt has orthogonal increments, i.e. E[(Nt1 -Ns1 )(Nt2 -Ns2 )] = 0 for non-overlapping intervals [s1, t1], [s2, t2].

6.2 The 1-Dimensional Linear Filtering Problem

85

(ii) L(N, t) = L(Z, t), so Xt = PL(N,t)(Xt).

Step 3. If we put

dRt

=

1 D(t)

dNt

,

then Rt is a 1-dimensional Brownian motion. Moreover,

L(N, t) = L(R, t) and

t

Xt = PL(N,t)(Xt) = PL(R,t)(Xt) = E[Xt] +

 s

E[XtRs]dRs

.

0

Step 4. Find an expression for Xt by solving the (linear) stochastic differential equation
dXt = F (t)Xtdt + C(t)dUt .
Step 5. Substitute the formula for Xt from Step 4 into E[XtRs] and use Step 3 to obtain a stochastic differential equation for Xt:

dXt

=

 s

E[XtRs]s=tdRt

+

t

2 ts

E

[Xt

Rs]dRs

dt

etc.

0

Before we proceed to establish Steps 1­5, let us consider a simple, but motivating example:

Example 6.2.1. Suppose X, W1, W2, . . . are independent real random variables, E[X] = E[Wj] = 0 for all j, E[X2] = a2, E[Wj2] = m2 for all j. Put Zj = X + Wj.

What is the best linear estimate X of X based on {Zj; j  k} ? More precisely, let

L = L(Z, k) = {c1Z1 + · · · + ckZk; c1, . . . , ck  R} .

Then we want to find

Xk = Pk(X) ,

where Pk denotes the projection into L(Z, k). We use the Gram-Schmidt procedure to obtain random variables A1, A2, . . .
such that

(i) E[AiAj] = 0 for i = j (ii) L(A, k) = L(Z, k) for all k.

86

6. The Filtering Problem

Then

Xk

=

k j=1

E [X Aj E[A2j ]

]

Aj

for k = 1, 2, . . . .

(6.2.5)

We obtain a recursive relation between Xk and Xk-1 from this by observing that

Aj = Zj - Xj-1 ,

(6.2.6)

which follows from

Aj = Zj - Pj-1(Zj ) = Zj - Pj-1(X) ,

since Pj-1(Wj) = 0 .

By (6.2.6)

E[XAj] = E[X(Zj - Xj-1)] = E[X(X - Xj-1)] = E[(X - Xj-1)2]

and Hence

E[A2j ] = E[(X + Wj - Xj-1)2] = E[(X - Xj-1)2] + m2 .

Xk

=

Xk-1

+

E[(X - Xk-1)2] E[(X - Xk-1)2] + m2

(Zk

-

Xk-1)

.

If we introduce

Zk

=

1 k

k

Zj ,

j=1

then this can be simplified to

Xk

=

a2

a2

+

1 k

·

m2

Z

k

.

(This can be seen as follows:

Put

k

=

a2

a2

+

1 k

m2

,

Then

Uk = kZk .

(6.2.7) (6.2.8)

(i) Uk  L(Z, k) (ii) X - UkL(Z, k), since

E[(X - Uk)Zi] = E[XZi] - kE[ZkZi]

=

E [X (X

+

Wi)]

-

k

1 k

j

E [Zj Zi ]

=

a2

-

1 k

k

E[(X +Wj)(X +Wi)]

=

a2

-

1 k

k

[ka2

+

m2

]

=

0

.)

j

6.2 The 1-Dimensional Linear Filtering Problem

87

The result can be interpreted as follows: For large k we put Xk  Zk, while for small k the relation between a2 and m2 becomes more important. If m2 a2, the observations are to a large extent neglected (for small k) and Xk is put equal to its mean value, 0. See also Exercise 6.11.
This example gives the motivation for our approach: We replace the process Zt by an orthogonal increment process Nt (Step 2) in order to obtain a representation for Xt analogous to (6.2.5). Such a representation is obtained in Step 3, after we have identified the best linear estimate with the best measurable estimate (Step 1) and established the connection between Nt and Brownian motion.

Step 1. Z-Linear and Z-Measurable Estimates
Lemma 6.2.2. Let X, Zs; s  t be random variables in L2(P ) and assume that
(X, Zs1 , Zs2 , . . . , Zsn )  Rn+1 has a normal distribution for all s1, s2, . . . , sn  t, n  1. Then
PL(X) = E[X|G] = PK(X) .
In other words, the best Z-linear estimate for X coincides with the best Zmeasurable estimate in this case. Proof. Put X = PL(X), X = X - X . Then we claim that X is independent of G: Recall that a random variable (Y1, . . . , Yk)  Rk is normal iff c1Y1 + · · · + ckYk is normal, for all choices of c1, . . . , ck  R. And an L2-limit of normal variables is again normal (Appendix A). Therefore

(X, Zs1 , . . . , Zsn ) is normal for all s1, . . . , sn  t .
Since E[XZsj ] = 0, X and Zsj are uncorrelated, for 1  j  n. It follows (Appendix A) that

X and (Zs1 , . . . , Zsn ) are independent .

So X is independent from G as claimed. But then

E[XG(X - X )] = E[XGX] = E[XG] · E[X] = 0 for all G  G

i.e. XdP = X dP . Since X is G-measurable, we conclude that

G

G

X = E[X|G].

88

6. The Filtering Problem

There is a curious interpretation of this result: Suppose X, {Zt}tT are L2(P )-functions with given covariances. Among all possible distributions of

(X, Zt1 , . . . , Ztn )
with these covariances, the normal distribution will be the "worst" w.r.t. estimation, in the following sense: For any distribution we have

E[(X - E[X|G])2]  E[(X - PL(X))2] ,

with equality for the normal distribution, by Lemma 6.2.2. (Note that the quantity on the right hand side only depends on the covariances, not on the distribution we might choose to obtain these covariances). For a broad discussion of similar conclusions, based on an information theoretical game between nature and the observer, see Tops¨oe (1978).
Finally, to be able to apply Lemma 6.2.2 to our filtering problem, we need the following result:

Lemma 6.2.3.

Mt =

Xt Zt

 R2

is a Gaussian process .

Proof. We may regard Mt as the solution of a 2-dimensional linear stochastic differential equation of the form

dMt = H(t)Mtdt + K(t)dBt, M0 =

X0 0

;

(6.2.9)

where H(t)  R2×2, K(t)  R2×2 and Bt is 2-dimensional Brownian motion. Use Picard iteration to solve (6.2.9), i.e. put

t

t

Mt(n+1) = M0 + H(s)Ms(n)ds + K(s)dBs ,

0

0

n = 0, 1, 2, . . . (6.2.10)

Then Mt(n) is Gaussian for all n and Mt(n)  Mt in L2(P ) (see the proof of Theorem 5.2.1) and therefore Mt is Gaussian (Theorem A.7).

Step 2. The Innovation Process
Before we introduce the innovation process we will establish a useful representation of the functions in the space
L(Z, T ) = the closure in L2(P ) of all linear combinations c0 + c1Zt1 + · · · + ckZtk ; 0  ti  T, cj  R .
If f  L2[0, T ], note that

6.2 The 1-Dimensional Linear Filtering Problem

89

T

2

T

2

T

2

E

f (t)dZt = E

f (t)G(t)Xtdt + E

f (t)D(t)dVt

0

0

0

T

T

+2E

f (t)G(t)Xtdt

f (t)D(t)dVt .

0

0

Since

T

2

T

E

f (t)G(t)Xtdt  A1 · f (t)2dt by the Cauchy-Schwartz inequality,

0

0

T

2

T

E

f (t)D(t)dVt = f (t)2D2(t)dt by the It^o isometry

0

0

and {Xt}, {Vt} are independent, we conclude that

T
A0 f 2(t)dt  E

T

2

T

f (t)dZt  A2 f 2(t)dt ,

(6.2.11)

0

0

0

for some constants A0, A1, A2 not depending on f . We can now show

T
Lemma 6.2.4. L(Z, T ) = {c0 + f (t)dZt; f  L2[0, T ], c0  R}.
0

Proof. Denote the right hand side by N (Z, T ). It is enough to show that

a) N (Z, T )  L(Z, T ) b) N (Z, T ) contains all linear combinations of the form

c0 + c1Zt1 + · · · + ckZtk ; c) N (Z, T ) is closed in L2(P )

0  ti  T

a): This follows from the fact that if f is continuous then

T

f (t)dZt

=

lim
n

f (j · 2-n) · (Z(j+1)2-n - Zj·2-n ) .

0

j

b): Suppose 0  t1 < t2 < · · · < tk  T . We can write

k

k-1

k-1 tj+1

T

ciZti = cj Zj =

cj dZt =

i=1

j=0

j=0 tj

0

k-1
cj X[tj ,tj+1)(t) dZt ,
j=0

where Zj = Ztj+1 - Ztj . c): This follows from (6.2.11) and the fact that L2[0, T ] is complete.

90

6. The Filtering Problem

Now we define the innovation process Nt as follows:

t

Nt = Zt - (GX)sds, where (GX)s = PL(Z,s)(G(s)Xs) = G(s)Xs .

0
i.e. dNt = G(t)(Xt - Xt)dt + D(t)dVt .

(6.2.12) (6.2.13)

Lemma 6.2.5. (i) Nt has orthogonal increments
t
(ii) E[Nt2] = D2(s)ds
0
(iii) L(N, t) = L(Z, t) for all t  0 (iv) Nt is a Gaussian process

Proof. (i): If s < t and Y  L(Z, s) we have

t

t

E[(Nt - Ns)Y ] = E

G(r)(Xr - Xr dr + D(r)dVr)Y

s t

s t

= G(r)E[(Xr - Xr)Y ]dr + E

DdV Y = 0 ,

s

s

since Xr-XrL(Z, r)  L(Z, s) for r  s and V has independent increments. (ii): By It^o's formula, with g(t, x) = x2, we have

d(Nt2)

=

2NtdNt

+

1 2

2(dNt)2

=

2NtdNt

+

D2dt

.

So Now

t

t

E[Nt2] = E 2NsdNs + D2(s)ds .

0

0

t

NsdNs

=

lim
tj 0

0

Ntj [Ntj+1 - Ntj ] ,

so since N has orthogonal increments we have

t
E NsdNs = 0 ,
0

and (ii) follows .

(iii): It is clear that L(N, t)  L(Z, t) for all t  0. To establish the opposite inclusion we use Lemma 6.2.4. So choose f  L2[0, t] and let us see what
functions can be obtained in the form

6.2 The 1-Dimensional Linear Filtering Problem

91

t

t

t

f (s)dNs = f (s)dZs - f (r)G(r)Xrdr

0

0

0

t

t

r

t

= f (s)dZs - f (r) g(r, s)dZs dr - f (r)c(r)dr

0

0

0

t

t

0 t

= f (s) - f (r)g(r, s)dr dZs - f (r)c(r)dr ,

0

s

0

where we have used Lemma 6.2.2 and Lemma 6.2.4 to write, for each r,

r
(GX)r = c(r) + g(r, s)dZs
0

for some g(r, ·)  L2[0, r], c(r)  R .

From the theory of Volterra integral equations (see e.g. Davis (1977), p. 125) there exists for all h  L2[0, t] an f  L2[0, t] such that

t
f (s) - f (r)g(r, s)dr = h(s).

s

So by choosing h = X[0,t1] where 0  t1  t, we obtain

t

t

t

f (r)c(r)dr + f (s)dNs = X[0,t1](s)dZs = Zt1 ,

0

0

0

which shows that L(N, t)  L(Z, t).

(iv): Xt is a limit (in L2(P )) of linear combinations of the form

M = c0 + c1Zs1 + · · · + ckZsk ,

where sk  t .

Therefore (Xt1 , . . . , Xtm )
is a limit of m-dimensional random variables (M (1), . . . , M (m)) whose components M (j) are linear combinations of this form. (M (1), . . . , M (m)) has a normal distribution since {Zt} is Gaussian, and therefore the limit has. Hence {Xt} is Gaussian. It follows that

t
Nt = Zt - G(s)Xsds
0

is Gaussian, by a similar argument.

92

6. The Filtering Problem

Step 3. The Innovation Process and Brownian Motion

t
Let Nt = Zt - G(s)Xsds be the innovation process defined in Step 2.
0
Recall that we have assumed that D(t) is bounded away from 0 on bounded
intervals. Define the process Rt() by

dRt

=

1 D(t)

dNt()

;

t  0, R0 = 0 .

(6.2.14)

Lemma 6.2.6. Rt is a 1-dimensional Brownian motion. Proof. Observe that

(i) Rt has continuous paths (ii) Rt has orthogonal increments (since Nt has) (iii) Rt is Gaussian (since Nt is) (iv) E[Rt] = 0 and E[RtRs] = min(s, t).
To prove the last assertion in (iv), note that by It^o's formula

d(Rt2) = 2RtdRt + (dRt)2 = 2RtdRt + dt ,

so, since Rt has orthogonal increments,
t
E[Rt2] = E[ ds] = t .
0
Therefore, if s < t,

E[RtRs] = E[(Rt - Rs)Rs] + E[Rs2] = E[Rs2] = s .
Properties (i), (iii) and (iv) constitute one of the many characterizations of a 1-dimensional Brownian motion (see Simon (1979), Theorem 4.3). (Alternatively, we could easily deduce that Rt has stationary, independent increments and therefore ­ by continuity ­ must be Brownian motion, by the result previously referred to in the beginning of Chapter 3. For a general characterization of Brownian motion see Corollary 8.4.5.)

Since

L(N, t) = L(R, t)

we conclude that

Xt = PL(R,t)(Xt) .

It turns out that the projection down to the space L(R, t) can be described very nicely: (compare with formula (6.2.5) in Example 6.2.1)

6.2 The 1-Dimensional Linear Filtering Problem

93

Lemma 6.2.7.

t

Xt = E[Xt] +

 s

E[XtRs]dRs

.

0

Proof. From Lemma 6.2.4 we know that

(6.2.15)

t
Xt = c0(t) + g(s)dRs
0

for some g  L2[0, t], c0(t)  R .

Taking expectations we see that c0(t) = E[Xt] = E[Xt]. We have

t
(Xt - Xt) f (s)dRs

for all f  L2[0, t] .

0

Therefore

t

t

t

t

E Xt f (s)dRs = E Xt f (s)dRs = E g(s)dRs f (s)dRs

0

0

t

t

0

0

= E g(s)f (s)ds = g(s)f (s)ds , for all f  L2[0, t] ,

0

0

where we have used the It^o isometry. In particular, if we choose f = X[0,r] for some r  t, we obtain

r

E[XtRr] = g(s)ds

0

or

g(r)

=

 r

E[XtRr

]

,

This completes Step 3.

as asserted .

Step 4. An Explicit Formula for Xt

This is easily obtained using It^o's formula, as in the examples in Chapter 5. The result is

t

t

s

Xt = exp F (s)ds X0 + exp - F (u)du C(s)dUs

= exp

0

0

t

t

F (s)ds X0 + exp

0 t
F (u)du C(s)dUs .

0

0

s

94

6. The Filtering Problem

t
In particular, we note that E[Xt] = E[X0] exp( F (s)ds).
0
More generally, if 0  r  t, (see Exercise 6.12)

Xt = exp

t

t

F (s)ds Xr + exp

r

r

t
F (u)du C(s)dUs .
s

(6.2.16)

Step 5. The Stochastic Differential Equation for Xt

We now combine the previous steps to obtain the solution of the filtering
problem, i.e. a stochastic differential equation for Xt. Starting with the formula from Lemma 6.2.7

t
Xt = E[Xt] + f (s, t)dRs ,

0

where we use that

f (s, t)

=

 s

E

[XtRs]

,

(6.2.17)

s

Rs =

G(r) D(r)

(Xr

-

Xr )dr

+

Vs

0

from (6.2.13) and (6.2.14))

and obtain where

s

E[XtRs] =

G(r) D(r)

E [Xt Xr ]dr

,

0

Xr = Xr - Xr .

(6.2.18)

Using formula (6.2.16) for Xt, we obtain

E[XtXr] = exp

t
F (v)dv E[XrXr] = exp
r

t
F (v)dv S(r) ,
r

where

S(r) = E[(Xr)2] ,

(6.2.19)

i.e. the mean square error of the estimate at time r  0. Thus

s

E[XtRs] =

G(r) D(r)

exp

0

t
F (v)dv S(r)dr
r

6.2 The 1-Dimensional Linear Filtering Problem

95

so that

f (s, t)

=

G(s) D(s)

exp

t
F (v)dv S(s) .
s

(6.2.20)

We claim that S(t) satisfies the (deterministic) differential equation

dS dt

= 2F (t)S(t) -

G2(t) D2(t)

S2(t)

+

C

2

(t)

(The Riccati equation) . (6.2.21)

To prove (6.2.21) note that by the Pythagorean theorem, (6.2.15) and the Ito^ isometry

S(t) = E[(Xt - Xt)2] = E[Xt2] - 2E[XtXt] + E[Xt2] = E[Xt2] - E[Xt2]
t

= T (t) - f (s, t)2ds - E[Xt]2 ,

(6.2.22)

0

where

T (t) = E[Xt2] .

Now by (6.2.16) and the It^o isometry we have

(6.2.23)

t

t

T (t) = exp 2 F (s)ds E[X02] + exp

0

0

using that X0 is independent of {Us}s0. So

t
2 F (u)du
s

C2(s)ds ,

t

dT dt

= 2F (t) · exp

2

F (s)ds E[X02] + C2(t)

0

t

t

+ 2F (t) exp 2 F (u)du C2(s)ds

0

s

i.e.

dT dt

= 2F (t)T (t) + C2(t) .

Substituting in (6.2.22) we obtain, using Step 4,

(6.2.24)

t

dS dt

=

dT dt

- f (t, t)2 -

2f (s, t)

·

 t

f

(s,

t)ds

-

2F (t)E[Xt]2

0

=

2F (t)T (t)

+

C 2 (t)

-

G2(t)S2(t) D2(t)

-

2

t
f 2(s, t)F (t)ds - 2F (t)E[Xt]2

0

=

2F (t)S(t) +

C2(t) -

G2(t)S2(t) D2(t)

,

which is (6.2.21) .

96

6. The Filtering Problem

We are now ready for the stochastic differential equation for Xt: From the formula

t

Xt = c0(t) + f (s, t)dRs where c0(t) = E[Xt]

0

it follows that

dXt = c0(t)dt + f (t, t)dRt +

t

 t

f

(s,

t)dRs

dt ,

0

(6.2.25)

since

ut

uu

 t

f

(s,

t)dRs

dt =

 t

f

(s,

t)dt

dRs

00

0s

u

u

= (f (s, u) - f (s, s))dRs = Xu - c0(u) - f (s, s)dRs .

0

0

So

dXt

=

c0(t)dt

+

G(t)S(t) D(t)

dRt

+

t
f (s, t)dRs F (t)dt

0

or

dXt

=

c0(t)dt

+

F (t)

·

(Xt

-

c0(t))dt

+

G(t)S(t) D(t)

dRt

=

F (t)Xtdt

+

G(t)S(t) D(t)

dRt

,

(6.2.26)

since c0(t) = F (t)c0(t) (Step 4).

If we substitute

dRt

=

1 D(t)

[dZt

- G(t)Xtdt]

we obtain

dXt

=

(F (t)

-

G2(t)S(t) D2(t)

)Xtdt

+

G(t)S(t) D2(t)

dZt

.

(6.2.27)

So the conclusion is:

Theorem 6.2.8 (The 1-dimensional Kalman-Bucy filter). The solution Xt = E[Xt|Gt] of the 1-dimensional linear filtering problem

(linear system)

dXt = F (t)Xtdt + C(t)dUt; F (t), C(t)  R

(linear observations) dZt = G(t)Xtdt + D(t)dVt; G(t), D(t)  R

(6.2.3) (6.2.4)

6.2 The 1-Dimensional Linear Filtering Problem

97

(with conditions as stated earlier) satisfies the stochastic differential equation

dXt =

F (t)

-

G2(t)S(t) D2(t)

Xtdt

+

G(t)S(t) D2(t)

dZt

;

X0 = E[X0]

(6.2.28)

where

S(t) = E[(Xt - Xt)2] satisfies the (deterministic) Riccati equation

dS dt

=

2F (t)S(t) -

G2(t) D2(t)

S

2(t)

+

C

2

(t),

S(0) = E[(X0 - E[X0])2] .

(6.2.29)

Example 6.2.9 (Noisy observations of a constant process). Consider the simple case

(system) (observations)

dXt = 0, i.e. Xt = X0; E[X0] = 0, E[X02] = a2 dZt = Xtdt + mdVt; Z0 = 0

(corresponding to

Ht =

dZ dt

= Xt + mWt, Wt =

white noise) .

First we solve the corresponding Riccati equation for

S(t) = E[(Xt - Xt)2]:

dS dt

=

-

1 m2

S2

,

S(0) = a2

i.e.

S(t)

=

a2m2 m2 + a2t

;

t0.

This gives the following equation for Xt:

dXt

=

- m2

a2 +

a2t Xtdt

+

m2

a2 +

a2t dZt

;

X0 = E[X0] = 0

or

d Xt exp

m2

a2 +

a2

t

dt

= exp

m2

a2 +

a2

t

dt

m2

a2 +

a2t

dZt

which gives

Xt

=

m2

a2 +

a2

t

Zt

;

t0.

This is the continuous analogue of Example 6.2.1.

(6.2.30)

98

6. The Filtering Problem

Example 6.2.10 (Noisy observations of a Brownian motion). If we modify the preceding example slightly, so that

(system) (observations)

dXt = cdUt; E[X0] = 0, E[X02] = a2, c constant dZt = Xtdt + mdVt,

the Riccati equation becomes

or This gives

dS dt

=

-

1 m2

S

2

+ c2, S(0)

=

a2

m2dS m2c2 - S2

=

dt, (S

=

mc)

.

mc + s mc - s

= K exp

2ct m

;

K=

mc + a2 mc - a2

.

Or





mc

K K

·exp( ·exp(

2ct m 2ct m

)-1 )+1

;

if S(0) < mc

S(t)

=



mc (constant)

mc K

·exp(

2ct m

)+1

K

·exp(

2ct m

)-1

if S(0) = mc if S(0) > mc .

Thus in all cases the mean square error S(t) tends to mc as t   .

For simplicity let us put a = 0, m = c = 1. Then

S(t)

=

exp(2t) exp(2t)

- +

1 1

=

tanh(t)

.

The equation for Xt is

dXt = - tanh(t)Xtdt + tanh(t)dZt , X0 = 0

or d(cosh(t)Xt) = sinh(t)dZt .

So

t

Xt

=

1 cosh(t)

sinh(s)dZs .

0

If we return to the interpretation of Zt :

t
Zt = Hsds ,
0

where Hs are the "original" observations (see (6.1.4)), we can write

6.2 The 1-Dimensional Linear Filtering Problem

99

t

Xt

=

1 cosh(t)

sinh(s)Hsds ,

0

(6.2.31)

so Xt is approximately (for large t) a weighted average of the observations Hs, with increasing emphasis on observations as time increases.
Remark. It is interesting to compare formula (6.2.31) with established formulas in forecasting. For example, the exponentially weighted moving average Xn suggested by C.C. Holt in 1958 is given by
n
Xn = (1 - )nZ0 +  (1 - )n-kZk ,
k=1
where  is some constant; 0    1. See The Open University (1981), p. 16. This may be written

n
Xn = -nZ0 + ( - 1)-n-1 kZk ,
k=1

where



=

1 1-

(assuming



<

1),

which

is

a

discrete

version

of

(6.2.31),

or

­

more precisely ­ of the formula corresponding to (6.2.31) in the general case

when a = 0 and m, c are not necessarily equal to 1.

Example 6.2.11 (Estimation of a parameter). Suppose we want to estimate the value of a (constant) parameter , based on observations Zt satisfying the model

dZt =  M (t)dt + N (t)dBt ,

where M (t), N (t) are known functions. In this case the stochastic differential equation for  is of course
d = 0 ,

so the Riccati equation for S(t) = E[( - t)2] is

dS dt

=

-

M (t)S(t) N (t)

2

which gives

t

-1

S(t) = S0-1 + M (s)2N (s)-2ds

0

and the Kalman-Bucy filter is

dt

=

M (t)S(t) N (t)2

(dZt

-

M (t)tdt)

.

100 6. The Filtering Problem

This can be written
t
S0-1 + M (s)2N (s)-2ds dt + M (t)2N (t)-2tdt = M (t)N (t)-2dZt .
0
We recoqnize the left hand side as

t
d( S0-1 + M (s)2N (s)-2ds t)
0

so we obtain

t

0S0-1 + M (s)N (s)-2dZs

t =

0 t

.

S0-1 + M (s)2N (s)-2ds

0

This estimate coincides with the maximum likelihood estimate in classical estimation theory if S0-1 = 0. See Liptser and Shiryaev (1978).
For more information about estimates of drift parameters in diffusions and generalizations, see for example Aase (1982), Brown and Hewitt (1975) and Taraskin (1974).

Example 6.2.12 (Noisy observations of a population growth). Consider a simple growth model (r constant)

dXt = rXtdt, E[X0] = b > 0 , with observations

E[(X0 - b)2] = a2 ,

dZt = Xtdt + mdVt ; The corresponding Riccati equation

m constant .

dS dt

=

2rS

-

1 m2

S

2

,

gives the logistic curve

S(0) = a2 ,

S(t) =

2rm2 1 + Ke-2rt

;

where

K

=

2rm2 a2

-1.

So the equation for Xt becomes

dXt =

r

-

S m2

Xtdt

+

S m2

dZt

;

X0 = E[X0] = b .

For simplicity let us assume that a2 = 2rm2, so that

6.2 The 1-Dimensional Linear Filtering Problem 101

S(t) = 2rm2 for all t .
(In the general case S(t)  2rm2 as t  , so this is not an unreasonable approximation for large t). Then we get

d(exp(rt)Xt) = exp(rt)2rdZt , X0 = b

or
t
Xt = exp(-rt) 2r exp(rs)dZs + b .
0
As in Example 6.2.10 this may be written

t
Xt = exp(-rt) 2r exp(rs)Hsds + b ,
0

t
if Zt = Hsds . (6.2.32)
0

For example, assume that Hs =  (constant) for 0  s  t, i.e. that our observations (for some reason) give the same value  for all times s  t. Then
Xt = 2 - (2 - b) exp(-rt)  2 as t   .
If Hs =  · exp(s), s  0 ( constant), we get

Xt = exp(-rt)

2r r+

(exp(r

+

)t

-

1)

+

b



2r r+

exp t

for large t .

Thus, only if  = r, i.e. Hs =  exp(rs); s  0, does the filter "believe" the observations in the long run. And only if  = r and  = b, i.e. Hs = b exp(rs); s  0, does the filter "believe" the observations at all times.

Example 6.2.13 (Constant coefficients ­ general discussion). Now consider the system

dXt = F Xtdt + CdUt ; with observations

F, C constants = 0

dZt = GXtdt + DdVt ; G, D constants = 0 .

The corresponding Riccati equation

S

=

2F S

-

G2 D2

S2

+

C2

,

S(0) = a2

has the solution

102 6. The Filtering Problem

where

S(t)

=

1

-

K 2

exp(

(2

-1 D2

)G2

t

)

1

-

K

exp(

(2 -1 )G2 t D2

)

,

1 = G-2(F D2 - D F 2D2 + G2C2) 2 = G-2(F D2 + D F 2D2 + G2C2)

and

K

=

a2 a2

- 1 - 2

.

This gives the solution for Xt of the form

Xt = exp

t

t

H (s)ds

X0

+

G D2

exp

0

0

t
H(u)du S(s)dZs ,
s

where

H (s)

=

F

-

G2 D2

S(s)

.

For large s we have S(s)  2. This gives

t

Xt  X0 exp(

F

-

G22 D2

t)

+

G2 D2

exp(

F

-

G22 D2

(t - s))dZs

0

t

=

X0

exp(-t)

+

G2 D2

exp(-t)

exp(s)dZs

0

(6.2.33)

where  = D-1F 2D2 + G2C2 . So we get approximately the same be-

haviour as in the previous example.

6.3 The Multidimensional Linear Filtering Problem

Finally we formulate the solution of the n-dimensional linear filtering problem (6.2.1), (6.2.2):

Theorem 6.3.1 (The Multi-Dimensional Kalman-Bucy Filter). The solution Xt = E[Xt|Gt] of the multi-dimensional linear filtering problem

(linear system) (linear observations)

dXt = F (t)Xtdt+C(t)dUt; F (t)  Rn×n, C(t)  Rn×p
dZt = G(t)Xtdt+D(t)dVt; G(t)  Rm×n, D(t)  Rm×r

(6.3.1) (6.3.2)

Exercises 103

satisfies the stochastic differential equation

dXt = (F - SGT (DDT )-1G)Xtdt + SGT (DDT )-1dZt ; X0 = E[X0] (6.3.3)
where S(t): = E[(Xt - Xt)(Xt - Xt)T ]  Rn×n satisfies the matrix Riccati equation

dS dt

=

FS

+ SFT

- SGT (DDT )-1GS

+ CCT

;

S(0) = E[(X0 - E[X0])(X0 - E[X0])T ] .

(6.3.4)

The condition on D(t)  Rm×r is now that D(t)D(t)T is invertible for all t and that (D(t)D(t)T )-1 is bounded on every bounded t-interval.

A similar solution can be found for the more general situation

(system) (observations)

dXt = [F0(t) + F1(t)Xt + F2(t)Zt]dt + C(t)dUt dZt = [G0(t) + G1(t)Xt + G2(t)Zt]dt + D(t)dVt ,

(6.3.5) (6.3.6)

where Xt  Rn, Zt  Rm and Bt = (Ut, Vt) is n + m-dimensional Brownian motion, with appropriate dimensions on the matrix coefficients. See Bensoussan (1992) and Kallianpur (1980), who also treat the non-linear case. An account of non-linear filtering theory is also given in Pardoux (1979) and Davis (1984).
For the solution of linear filtering problems governed by more general processes than Brownian motion (processes with orthogonal increments) see Davis (1977).
For various applications of filtering theory see Bucy and Joseph (1968), Jazwinski (1970), Gelb (1974), Maybeck (1979) and the references in these books.

Exercises

6.1. (Time-varying observations of a constant) Prove that if the (1-dimensional) system is

dXt = 0, E[X0] = 0 , and the observation process is

E[X02] = a2

dZt = G(t)Xtdt + dVt , Z0 = 0

then S(t) = E[(Xt - Xt)2] is given by

S(t) =

1 S(0)

+

1

t 0

G2(s)ds

.

(6.3.7)

104 6. The Filtering Problem

We say that we have exact asymptotic estimation if S(t)  0 as t  , i.e. if

G2(s)ds =  .

Thus for

0

G(s)

=

1 (1 + s)p

(p > 0 constant)

we

have

exact

asymptotic

estimation

iff

p



1 2

.

6.2. Consider the linear 1-dimensional filtering problem with no noise in

the system:

(system) (observations)

dXt = F (t)Xtdt dZt = G(t)Xtdt + D(t)dVt

Put S(t) = E[(Xt - Xt)2] as usual and assume S(0) > 0 .

a) Show that

R(t): =

1 S(t)

satisfies the linear differential equation

(6.3.8) (6.3.9)

R

(t)

=

-2F (t)R(t)

+

G2(t) D2(t)

;

R(0)

=

1 S(0)

(6.3.10)

b) Use (6.3.10) to prove that for the filtering problem (6.3.8), (6.3.9) we have

1 S(t)

=

1 S(0)

exp

t

t

- 2 F (s)ds + exp

0

0

t
- 2 F (u)du
s

G2(s) D2(s)

ds

.

(6.3.11)

6.3. In Example 6.2.12 we found that

S(t)  2rm2 as t   ,

so exact asymptotic estimation (Exercise 6.1) of Xt is not possible. However, prove that we can obtain exact asymptotic estimation of X0, in the sense that

E[(X0 - E[X0|Gt])2]  0 as t   .

(Hint: Note that X0 = e-rtXt and therefore E[X0|Gt] = e-rtXt, so that
E[(X0 - E[X0|Gt])2] = e-2rtS(t)) .

Exercises 105

6.4. Consider the multi-dimensional linear filtering problem with no noise in the system:

(system) (observations)

dXt = F (t)Xtdt ; Xt  Rn , F (t)  Rn×n
dZt = G(t)Xtdt + D(t)dVt ; G(t)  Rm×n , D(t)  Rm×r

(6.3.12) (6.3.13)

Assume that S(t) is nonsingular and define R(t) = S(t)-1. Prove that R(t) satisfies the Lyapunov equation (compare with Exercise 6.2)

R (t) = -R(t)F (t) - F (t)T R(t) + G(t)T (D(t)D(t)T )-1G(t) . (6.3.14)

(Hint: Note that since S(t)S-1(t) = I we have S (t)S-1(t) + S(t)(S-1) (t) = 0, which gives
(S-1) (t) = -S-1(t)S (t)S-1(t) .)

6.5. (Prediction) In the prediction problem one seeks to estimate the value of the system X at a future time T based on the observations Gt up to the present time t < T . Prove that in the linear setup (6.2.3), (6.2.4) the predicted value

E[XT |Gt] , T > t

is given by

E[XT |Gt] = exp

(Hint: Use formula (6.2.16).)

T
F (s)ds
t

· Xt .

(6.3.15)

6.6. (Interpolation/smoothing)
The interpolation or smoothing problem consists of estimating the
value of the system X at a time s < t, given the observations up
to time t, Gt. With notation as in (6.2.1), (6.2.2) one can show that Ms: = E[Xs|Gt] satisfies the differential equation

d ds

Ms

=

F (s)Ms

+

C(s)CT (s)S-1(s)(Ms

-

Xs)

;

s<t

Mt = Xt .

(6.3.16)

(See Davis (1977, Theorem 4.4.4).) Use this result to find E[Xs|Gt] in Example 6.2.9.

106 6. The Filtering Problem

6.7. Consider the system

dXt =

dX1(t) dX2(t)

=

0 0

,

E[X0] =

0 0

with observations

dZ1(t) dZ2(t)

=

X1 X1 + X2

dt +

dV1(t) dV2(t)

.

Apply (6.3.14) from Exercise 6.4 to prove that S(t): = E[(Xt - Xt)(Xt - Xt)T ] is given by

S(t)-1 = S-1(0) +

2 1

1 1

t

if S(0) is invertible. Then show that

dXt = -S(t)

2 1

1 1

Xtdt + S(t)

1 0

1 1

dZt .

6.8. Transform the following Stratonovich equation

dXt = b(t, Xt)dt + (t, Xt)  dBt into the corresponding It^o equation

dXt = b(t, Xt)dt + (t, Xt)dBt

using (6.1.3):

a)

dX1 dX2

=

b)
dX1 dX2

1 X2 + e2X1

dt +

0 eX1

 dBt

(Bt  R)

=

X1 X2

dt +

X2 X1

 dBt

(Bt  R)

6.9. Transform the following It^o equation

dXt = b(t, Xt)dt + (t, Xt)dBt into the corresponding Stratonovich equation

dXt = b(t, Xt)dt + (t, Xt)  dBt , using (the converse of) (6.1.3):

Exercises 107

a)

dXt

=

-

1 2

Xtdt

+

K Xt dBt ,

where

K=

0 1

-1 0

,

Xt =

X1(t) X2(t)

 R2

and Bt  R

(i.e. Xt is Brownian motion on the unit circle (Example 5.1.4)).

b)

dX1 dX2

=

X1 X2

-X2 X1

dB1 dB2

.

6.10. (On the support of an It^o diffusion) The support of an It^o diffusion X in Rn starting at x  Rn is the
smallest closed set F with the property that

Xt()  F for all t  0, for a.a.  .

In Example 5.1.4 we found that Brownian motion on the unit circle, Xt, satisfies the (It^o) stochastic differential equation

dX1(t) dX2(t)

=

-

1 2

X1(t) X2(t)

dt +

0 1

-1 0

X1(t) X2(t)

dBt .

(6.3.17)

From this equation it is not at all apparent that its solution is situated on the same circle as the starting point. However, this can be detected by proceeding as follows: First transform the equation into its Stratonovich form, which in Exercise 6.9 is found to be

dX1(t) dX2(t)

=

0 1

-1 0

X1(t) X2(t)

 dBt .

(6.3.18)

Then (formally) replace dBt by  (t)dt, where  is some smooth (deterministic) function, (0) = 0. This gives the deterministic equation

dX1()(t) dX2()(t)

=

0 1

-1 0

 (t)dt .

(6.3.19)

If (X1()(0), X2()(0)) = (1, 0) the solution of (6.3.19) is

X1()(t) X2()(t)

=

cos (t) sin (t)

.

So for any smooth  the corresponding solution X()(t) of (6.3.19) has its support on this unit circle. We can conclude that the original solution X(t, ) is supported on the unit circle also, in virtue of the Stroock-Varadhan support theorem. This theorem says that, quite generally, the support of an It^o diffusion Xt() coincides with the closure (in C([0, ); Rn)) of {X()(·);  smooth}, where X()(t) is obtained by replacing dBt by  (t)dt in the same way as above. See e.g. Ikeda

108 6. The Filtering Problem

and Watanabe (1989, Th. VI. 8.1). (In this special case above the

support could also have been found directly from (6.3.18)).

Use the procedure above to find the support of the process Xt  R2 given by

dXt

=

1 2

Xtdt

+

0 1

1 0

XtdBt .

6.11. Consider Example 6.2.1, but now without the assumption that E[X] = 0. Show that

Xk

=

m2 ka2 +

m2

E[X

]

+

a2

a2

+

1 k

m2

Z

k

;

k = 1, 2, . . .

(Compare with (6.2.8).) (Hint: Put  = X - E[X], k = Zk - E[X]. Then apply (6.2.8) with X replaced by  and Zk replaced by k.)
6.12. Prove formula (6.2.16).
s
(Hint: exp - F (u)du) is an integrating factor for the stochastic
r
differential equation (6.2.3).) 6.13. Consider the 1-dimensional linear filtering problem (6.2.3), (6.2.4).
Find E[Xt] and E[(Xt)2] .
(Hint: Use Theorem 6.1.2 and use the definition of the mean square error S(t).)

6.14. Let Bt be 1-dimensional Brownian motion. a) Give an example of a process Zt of the form

dZt = u(t, )dt + dBt

such that Zt is a Brownian motion w.r.t. P and u(t, )  V is not identically 0.
(Hint: Choose Zt to be the innovation process (6.2.13) in a linear filtering problem with D(t)  1.)
b) Show that the filtration {Zt}t0 generated by a process Zt as in a) must be strictly smaller than {Ft}t0, i.e. show that

Zt  Ft for all t and Zt = Ft for some t .

(Hint: Use Exercise 4.12.)

7. Diffusions: Basic Properties

7.1 The Markov Property

Suppose we want to describe the motion of a small particle suspended in a moving liquid, subject to random molecular bombardments. If b(t, x)  R3
is the velocity of the fluid at the point x at time t, then a reasonable math-
ematical model for the position Xt of the particle at time t would be a stochastic differential equation of the form

dXt dt

=

b(t, Xt) + (t, Xt)Wt

,

(7.1.1)

where Wt  R3 denotes "white noise" and (t, x)  R3×3. The It^o interpretation of this equation is

dXt = b(t, Xt)dt + (t, Xt)dBt ,

(7.1.2)

where Bt is 3-dimensional Brownian motion, and similarly (with a correction term added to b) for the Stratonovich interpretation (see (6.1.3)).
In a stochastic differential equation of the form

dXt = b(t, Xt)dt + (t, Xt)dBt ,

(7.1.3)

where Xt  Rn, b(t, x)  Rn, (t, x)  Rn×m and Bt is m-dimensional Brownian motion, we will call b the drift coefficient and  ­ or sometimes

1 2

T

­

the

diffusion

coefficient

(see

Theorem

7.3.3).

Thus the solution of a stochastic differential equation may be thought of

as the mathematical description of the motion of a small particle in a moving

fluid: Therefore such stochastic processes are called (Ito^) diffusions.

In this chapter we establish some of the most basic properties and results

about It^o diffusions:

7.1 The Markov property. 7.2 The strong Markov property. 7.3 The generator A of Xt expressed in terms of b and . 7.4 The Dynkin formula. 7.5 The characteristic operator.

110 7. Diffusions: Basic Properties

This will give us the necessary background for the applications in the remaining chapters.

Definition 7.1.1. A (time-homogeneous) It^o diffusion is a stochastic process Xt() = X(t, ): [0, )×  Rn satisfying a stochastic differential equation of the form

dXt = b(Xt)dt + (Xt)dBt , t  s ; Xs = x

(7.1.4)

where Bt is m-dimensional Brownian motion and b: Rn  Rn, : Rn  Rn×m satisfy the conditions in Theorem 5.2.1, which in this case simplify to:

|b(x) - b(y)| + |(x) - (y)|  D|x - y| ; x, y  Rn ,

(7.1.5)

where ||2 = |ij|2.

s

We will denote = 0 we write Xtx

the (unique) solution for Xt0,x. Note that we

of (7.1.4) by Xt have assumed in

= Xts,x; t  (7.1.4) that b

s. If and

 do not depend on t but on x only. We shall see later (Chapters 10, 11) that

the general case can be reduced to this situation. The resulting process Xt() will have the property of being time-homogeneous, in the following sense:

Note that

s+h

s+h

Xss+,xh = x +

b(Xus,x)du +

(Xus,x)dBu

s

s

h

h

= x + b(Xss+,xv)dv + (Xss+,xv)dBv ,

0

0

(u = s + v)

(7.1.6)

where Bv = Bs+v - Bs; v  0. (See Exercise 2.12). On the other hand of

course

h

h

Xh0,x = x + b(Xv0,x)dv + (Xv0,x)dBv .

0

0

Since {Bv}v0 and {Bv}v0 have the same P 0-distributions, it follows by weak uniqueness (Lemma 5.3.1) of the solution of the stochastic differential equation
dXt = b(Xt)dt + (Xt)dBt ; X0 = x

that

{Xss+,xh}h0

and

{Xh0,x}h0

have the same P 0-distributions, i.e. {Xt}t0 is time-homogeneous.

We now introduce the probability laws Qx of {Xt}t0, for x  Rn. Intuitively, Qx gives the distribution of {Xt}t0 assuming that X0 = x. To express

7.1 The Markov Property 111

this mathematically, we let M be the -algebra (of subsets of ) generated by the random variables   Xt() = Xty(), where t  0, y  Rn.
Define Qx on the members of M by

Qx[Xt1  E1, · · · , Xtk  Ek] = P 0[Xtx1  E1, · · · , Xtxk  Ek]

(7.1.7)

where Ei  Rn are Borel sets; 1  i  k. As before we let Ft(m) be the -algebra generated by {Br; r  t}. Similarly
we let Mt be the -algebra generated by {Xr; r  t}. We have established earlier (see Theorem 5.2.1) that Xt is measurable with respect to Ft(m), so Mt  Ft(m).
We now prove that Xt satisfies the important Markov property: The future behaviour of the process given what has happened up to time t is the
same as the behaviour obtained when starting the process at Xt. The precise mathematical formulation of this is the following:

Theorem 7.1.2 (The Markov property for It^o diffusions). Let f be a bounded Borel function from Rn to R. Then, for t, h  0

Ex[f (Xt+h)|Ft(m)]() = EXt()[f (Xh)] .

(7.1.8)

(See Appendix B for definition and basic properties of conditional expectation). Here and in the following Ex denotes the expectation w.r.t. the probability measure Qx. Thus Ey[f (Xh)] means E[f (Xhy)], where E denotes the expectation w.r.t. the measure P 0. The right hand side means the function Ey[f (Xh)] evaluated at y = Xt().

Proof. Since, for r  t,

r

r

Xr() = Xt() + b(Xu)du + (Xu)dBu ,

t

t

we have by uniqueness

Xr() = Xrt,Xt () .

In other words, if we define

F (x, t, r, ) = Xrt,x() for r  t ,

we have

Xr() = F (Xt, t, r, ); r  t .

(7.1.9)

Note that   F (x, t, r, ) is independent of Ft(m). Using (7.1.9) we may rewrite (7.1.8) as

E[f (F (Xt, t, t + h, ))|Ft(m)] = E[f (F (x, 0, h, ))]x=Xt .

(7.1.10)

112 7. Diffusions: Basic Properties
Put g(x, ) = f  F (x, t, t + h, ). Then (x, )  g(x, ) is measurable. (See Exercise 7.6). Hence we can approximate g pointwise boundedly by functions on the form
m
k(x)k() .
k=1
Using the properties of conditional expectation (see Appendix B) we get
E[g(Xt, )|Ft(m)] = E lim k(Xt)k()|Ft(m)
= lim k(Xt) · E[k()|Ft(m)] = lim E[k(y)k()|Ft(m)]y=Xt = E[g(y, )|Ft(m)]y=Xt = E[g(y, )]y=Xt .
Therefore, since {Xt} is time-homogeneous,
E[f (F (Xt, t, t + h, ))|Ft(m)] = E[f (F (y, t, t + h, ))]y=Xt = E[f (F (y, 0, h, ))]y=Xt
which is (7.1.10).
Remark. Theorem 7.1.2 states that Xt is a Markov process w.r.t. the family of -algebras {Ft(m)}t0. Note that since Mt  Ft(m) this implies that Xt is also a Markov process w.r.t. the -algebras {Mt}t0. This follows from Theorem B.3 and Theorem B.2 c)( Appendix B):
Ex[f (Xt+h)|Mt] = Ex[Ex[f (Xt+h)|Ft(m)]|Mt] = Ex[EXt [f (Xh)]|Mt] = EXt [f (Xh)]
since EXt [f (Xh)] is Mt-measurable.
7.2 The Strong Markov Property
Roughly, the strong Markov property states that a relation of the form (7.1.8) continues to hold if the time t is replaced by a random time  () of a more general type called stopping time (or Markov time):
Definition 7.2.1. Let {Nt} be an increasing family of -algebras (of subsets of ). A function  :   [0, ] is called a (strict) stopping time w.r.t. {Nt} if
{;  ()  t}  Nt , for all t  0 . In other words, it should be possible to decide whether or not   t has occurred on the basis of the knowledge of Nt.

7.2 The Strong Markov Property 113

Example 7.2.2. Let U  Rn be open. Then the first exit time

U : = inf{t > 0; Xt / U } is a stopping time w.r.t. {Mt}, since

{; U  t} =

{; Xr / Km}  Mt

m rQ
r<t

where {Km} is an increasing sequence of closed sets such that U = Km .
m
More generally, if H  Rn is any set we define the first exit time from H,

H , as follows

H = inf{t > 0; Xt / H} .

If we include the sets of measure 0 in Mt (which we do) then the family
{Mt} is right-continuous i.e. Mt = Mt+, where Mt+ = Ms (see Chung
s>t
(1982, Theorem 2.3.4., p. 61)) and therefore H is a stopping time for any
Borel set H (see Dynkin (1965 II, 4.5.C.e.), p. 111)).

Definition 7.2.3. Let  be a stopping time w.r.t. {Nt} and let N be the smallest -algebra containing Nt for all t  0. Then the -algebra N consists of all sets N  N such that

N {  t}  Nt for all t  0 .

In the case when Nt = Mt, an alternative and more intuitive description is:

M = the -algebra generated by {Xmin(s,); s  0} .

(7.2.1)

(See Rao (1977, p. 2.15) or Stroock and Varadhan (1979, Lemma 1.3.3, p. 33).) Similarly, if Nt = Ft(m), we get

F(m) = the -algebra generated by {Bs ; s  0} .

Theorem 7.2.4 (The strong Markov property for It^o diffusions). Let f be a bounded Borel function on Rn,  a stopping time w.r.t. Ft(m),  <  a.s. Then

Ex[f (X+h)|F(m)] = EX [f (Xh)] for all h  0 .

(7.2.2)

Proof. We try to imitate the proof of the Markov property (Theorem 7.1.2). For a.a.  we have that Xr,x() satisfies

 +h

 +h

X+,xh = x +

b(Xu,x)du +

(Xu,x)dBu .





114 7. Diffusions: Basic Properties

By the strong Markov property for Brownian motion (Gihman and Skorohod (1974a, p. 30)) the process

Bv = B+v - B ;

v0

is again a Brownian motion and independent of F(m). Therefore

h

h

X+,xh = x + b(X+,xv)dv + (X+,xv)dBv .

0

0

Hence {X+,xh}h0 must coincide a.e. with the strongly unique (see (5.2.8)) solution Yh of the equation

h

h

Yh = x + b(Yv)dv + (Yv)dBv .

0

0

Since {Yh}h0 is independent of F(m), {X+,xh} must be independent also. Moreover, by weak uniqueness (Lemma 5.3.1) we conclude that

{Yh}h0 , and hence {X+,xh}h0, has the same law as {Xh0,x}h0 . (7.2.3)

Put F (x, t, r, ) = Xrt,x()
Then (7.2.2) can be written

for r  t .

E[f (F (x, 0,  + h, ))|F(m)] = E[f (F (x, 0, h, ))]x=X0,x . Now, with Xt = Xt0,x,

 +h

 +h

F (x, 0,  + h, ) = X+h() = x + b(Xs)ds + (Xs)dBs

0

0





 +h

 +h

= x + b(Xs)ds + (Xs)dBs + b(Xs)ds + (Xs)dBs

0

0





 +h

 +h

= X + b(Xs)ds + (Xs)dBs





= F (X , ,  + h, ) .

Hence (7.2.2) gets the form

E[f (F (X , ,  + h, ))|F(m)] = E[f (F (x, 0, h, ))]x=X .

7.2 The Strong Markov Property 115

Put g(x, t, r, ) = f (F (x, t, r, )). As in the proof of Theorem 7.1.2 we may assume that g has the form

g(x, t, r, ) = k(x)k(t, r, ) .
k

Then, since X+,xh is independent of F(m) we get, using (7.2.3)

E[g(X , ,  + h, )|F(m)] = E[k(X )k(,  + h, )|F(m)]
k

= k(X )E[k(,  +h, )|F(m)] = E[k(x)k(,  +h, )|F(m)]x=X

k

k

= E[g(x, ,  + h, )|F(m)]x=X = E[g(x, ,  + h, )]x=X = E[f (X+,xh)]x=X = E[f (Xh0,x)]x=X = E[f (F (x, 0, h, ))]x=X .

We now extend (7.2.2) to the following: If f1, · · · , fk are bounded Borel functions on Rn,  an Ft(m)-stopping time,  <  a.s. then

Ex[f1(X+h1 )f2(X+h2 ) · · · fk(X+hk )|F(m)] = EX [f1(Xh1 ) · · · fk(Xhk )] (7.2.4)
for all 0  h1  h2  · · ·  hk. This follows by induction: To illustrate the argument we prove it in the case k = 2:

Ex[f1(X+h1 )f2(X+h2 )|F(m)] = Ex[Ex[f1(X+h1 )f2(X+h2 )|F+h1 ]|F(m)] = Ex[f1(X+h1 )Ex[f2(X+h2 )|F+h1 ]|F(m)] = Ex[f1(X +h1 )EX+h1 [f2(Xh2-h1 )]|F(m)] = EX [f1(Xh1 )EXh1 [f2(Xh2-h1 )]] = EX [f1(Xh1 )Ex[f2(Xh2 )|Fh(m1 )]] = EX [f1(Xh1 )f2(Xh2 )] , as claimed .
Next we proceed to formulate the general version we need: Let H be the set of all real M-measurable functions. For t  0 we define the shift operator

t: H  H

as follows: If  = g1(Xt1 ) · · · gk(Xtk ) (gi Borel measurable, ti  0) we put

t = g1(Xt1+t) · · · gk(Xtk+t) .

Now extend in the natural way to all functions in H by taking limits of sums of such functions. Then it follows from (7.2.4) that

Ex[ |F(m)] = EX []

(7.2.5)

for all stopping times  and all bounded   H, where

( )() = (t)() if  () = t .

116 7. Diffusions: Basic Properties

Hitting distribution, harmonic measure and the mean value property

We will apply this to the following situation: Let H  Rn be measurable and let H be the first exit time from H for an It^o diffusion Xt. Let  be another stopping time, g a bounded continuous function on Rn and put

 = g(XH )X{H<} , H = inf{t > ; Xt / H} .

Then we have

 · X{<} = g(XH )X{H <} .

(7.2.6)

To prove (7.2.6) we approximate  by functions (k); k = 1, 2, . . . , of the form

Now

(k) = g(Xtj )X[tj,tj+1)(H ) , tj = j · 2-k, j = 0, 1, 2, . . .
j

tX[tj ,tj+1)(H ) = tX{r(0,tj )XrH&s[tj ,tj+1)Xs/H} = X{r(0,tj )Xr+tH&s[tj ,tj+1)Xs+t/H} = X{u(t,tj +t)XuH&v[tj +t,tj+1+t)Xv/H} = X[tj +t,tj+1+t)(Ht ) .
So we see that

t

=

lim
k

t(k)

=

lim
k

g(Xtj +t)X[tj +t,tj+1+t)(Ht )

j

= g(XHt ) · X{Ht <} , which is (7.2.6) .

In particular, if  = G with G  H measurable, H <  a.s. Qx, then we have H = H and so

G g(XH ) = g(XH ) .

(7.2.7)

7.3 The Generator of an It^o Diffusion 117

So if f is any bounded measurable function we obtain from (7.2.5) and (7.2.7):

Ex[f (XH )] = Ex[EXG [f (XH )]] = Ey[f (XH )] · Qx[XG  dy] (7.2.8)
G

for x  G. (Define µHx (F ) = Qx(XH  F ) and approximate f in L1(µxH ) by con-
tinuous functions g satisfying (7.2.7)). In other words, the expected value of
f at XH when starting at x  G can be obtained by integrating the expected value when starting at y  G with respect to the hitting distribution
("harmonic measure") of X on G. This can be restated as follows:

Define the harmonic measure of X on G, µxG, by µxG(F ) = Qx[XG  F ] for F  G, x  G .

Then the function

(x) = Ex[f (XH )]

satisfies the mean value property:

(x) = (y)dµxG(y) ,
G
for all Borel sets G  H.

for all x  G

(7.2.9)

This is an important ingredient in our solution of the generalized Dirichlet problem in Chapter 9.

7.3 The Generator of an It^o Diffusion

It is fundamental for many applications that we can associate a second order
partial differential operator A to an It^o diffusion Xt. The basic connection between A and Xt is that A is the generator of the process Xt:

Definition 7.3.1. Let {Xt} be a (time-homogeneous) It^o diffusion in Rn. The (infinitesimal) generator A of Xt is defined by

Af (x)

=

lim
t0

Ex[f (Xt)] t

-

f (x)

;

x  Rn .

The set of functions f : Rn  R such that the limit exists at x is denoted by DA(x), while DA denotes the set of functions for which the limit exists for all x  Rn.

118 7. Diffusions: Basic Properties

To find the relation between A and the coefficients b,  in the stochastic
differential equation (7.1.4) defining Xt we need the following result, which is useful in many connections:

Lemma 7.3.2. Let Yt = Ytx be an It^o process in Rn of the form

t

t

Ytx() = x + u(s, )ds + v(s, )dBs()

0

0

where B is m-dimensional. Let f  C02(Rn), i.e. f  C2(Rn) and f has compact support, and let  be a stopping time with respect to {Ft(m)}, and assume that Ex[ ] < . Assume that u(t, ) and v(t, ) are bounded on the

set of (t, ) such that Y (t, ) belongs to the support of f . Then

Ex[f (Y )] =


f (x) + Ex
0

i

ui(s,

)

f xi

(Ys)

+

1 2

i,j

(vvT

)i,j (s,

)

2f xixj

(Ys)

ds

,

where Ex is the expectation w.r.t. the natural probability law Rx for Yt starting at x:

Rx[Yt1  F1, . . . , Ytk  Fk] = P 0[Ytx1  F1, . . . , Ytxk  Fk] , Fi Borel sets .
Proof. Put Z = f (Y ) and apply It^o's formula (To simplify the notation we suppress the index t and let Y1, . . . , Yn and B1, . . . , Bm denote the coordinates of Y and B, respectively)

dZ = =

i

f xi

(Y

)dYi

+

1 2

i,j



2f xixj

(Y

)d

Yi

dYj

i

ui

f xi

dt

+

1 2

i,j

2f xixj

(vdB)i(vdB)j

+

i

f xi

(vdB)i

.

Since

(vdB)i · (vdB)j =

vik dBk
k

vjndBn
n

this gives

=

vikvjk dt = (vvT )ij dt ,

k

t
f (Yt) = f (Y0) +
0

i

ui

f xi

+

1 2

i,j

(vvT

)ij

2f xixj

ds

t

+

i,k 0

vik

f xi

dBk

.

(7.3.1)

7.3 The Generator of an It^o Diffusion 119

Hence


Ex[f (Y )] = f (x) + Ex
0
+ Ex
i,k

i

ui

f xi

(Y

)

+

1 2

i,j

(vvT

)i,j

2f xixj

(Y

)

ds



vik

f xi

(Y

)dBk

.

0

(7.3.2)

If g is a bounded Borel function, |g|  M say, then for all integers k we have

 k

k

Ex

g(Ys)dBs = Ex X{s<}g(Ys)dBs = 0 ,

0

0

since g(Ys) and X{s<} are both Fs(m)-measurable. Moreover



 k

2



Ex

g(Ys)dBs - g(Ys)dBs = Ex

g2(Ys)ds

0

0

 k

 M 2Ex[ -   k]  0 .

Therefore

0 = lim Ex
k

 k
g(Ys)dBs
0


= Ex[ g(Ys)dBs] .
0

Combining this with (7.3.2) we get Lemma 7.3.2.

This gives immediately the formula for the generator A of an It^o diffusion:

Theorem 7.3.3. Let Xt be the It^o diffusion

dXt = b(Xt)dt + (Xt)dBt .

If f  C02(Rn) then f  DA and

Af (x) =

i

bi(x)

f xi

+

1 2

i,j

(T

)i,j

(x)



2f xixj

.

(7.3.3)

Proof. This follows from Lemma 7.3.2 (with  = t) and the definition of A.

120 7. Diffusions: Basic Properties

Example 7.3.4. The n-dimensional Brownian motion is of course the solution of the stochastic differential equation

dXt = dBt ,

i.e. we have b = 0 and  = In, the n-dimensional identity matrix. So the generator of Bt is

Af

=

1 2

2f x2i

;

f = f (x1, . . . , xn)  C02(Rn)

i.e.

A

=

1 2

,

where



is

the

Laplace

operator.

Example 7.3.5 (The graph of Brownian motion). Let B denote 1-di-

mensional Brownian motion and let X =

X1 X2

be the solution of the

stochastic differential equation

dX1 = dt ; X1(0) = t0 dX2 = dB ; X2(0) = x0

i.e.

dX = bdt + dB ;

X(0) =

t0 X0

,

with b =

1 0

and  =

0 1

. In other words, X may be regarded as the

graph of Brownian motion. The generator A of X is given by

Af

=

f t

+

1 2f 2 x2

;

f = f (t, x)  C02(Rn) .

From now on we will, unless otherwise stated, let A = AX denote the generator of the It^o diffusion Xt. We let L = LX denote the differential operator given by the right hand side of (7.3.3). From Theorem 7.3.3 we know that AX and LX coincide on C02(Rn).

7.4 The Dynkin Formula
If we combine (7.3.2) and (7.3.3) we get:
Theorem 7.4.1 (Dynkin's formula). Let f  C02(Rn). Suppose  is a stopping time, Ex[ ] < . Then

Ex[f (X )] = f (x) + Ex Af (Xs)ds .
0

(7.4.1)

7.4 The Dynkin Formula 121

Remarks.

(i) Note that if  is the first exit time of a bounded set, Ex[ ] < , then (7.4.1) holds for any function f  C2.
(ii) For a more general version of Theorem 7.4.1 see Dynkin (1965 I), p. 133.

Example 7.4.2. Consider n-dimensional Brownian motion B = (B1, . . . , Bn) starting at a = (a1, . . . , an)  Rn(n  1) and assume |a| < R. What is the expected value of the first exit time K of B from the ball

K = KR = {x  Rn; |x| < R} ?

Choose an integer k and apply Dynkin's formula with X = B,  = k = min(k, K ), and f  C02 such that f (x) = |x|2 for |x|  R :

k

Ea[f (Bk )] = f (a) + Ea

1 2

f

(Bs

)ds

0 k

= |a|2 + Ea n · ds = |a|2 + n · Ea[k] .

0

Hence

E a [k ]



1 n

(R2

-

|a|2)

for

all

k.

So

letting

k





we

conclude

that

K = lim k <  a.s. and

Ea[K ]

=

1 n

(R2

- |a|2)

.

(7.4.2)

Next we assume that n  2 and |b| > R. What is the probability that B starting at b ever hits K?
Let k be the first exit time from the annulus

Ak = {x; R < |x| < 2kR} ; k = 1, 2, . . .

and put

TK = inf{t > 0; Bt  K} .

Let f = fn,k be a C2 function with compact support such that, if R  |x|  2kR,

f (x) =

- log |x| |x|2-n

when n = 2 when n > 2 .

Then, since f = 0 in Ak, we have by Dynkin's formula

Eb[f (Bk )] = f (b) for all k .

(7.4.3)

Put pk = P b[|Bk | = R] , qk = P b[|Bk | = 2kR] .

122 7. Diffusions: Basic Properties

Let us now consider the two cases n = 2 and n > 2 separately:

n = 2. Then we get from (7.4.3)

- log R · pk - (log R + k · log 2)qk = - log |b| for all k .

(7.4.4)

This implies that qk  0 as k  , so that

P b[TK < ] = 1 ,

(7.4.5)

i.e. Brownian motion is recurrent in R2. (See Port and Stone (1979)).

n > 2. In this case (7.4.3) gives

pk · R2-n + qk · (2kR)2-n = |b|2-n .

Since 0  qk  1 we get by letting k  

lim
k

pk

=

P b[TK

<

]

=

|b| R

2-n
,

i.e. Brownian motion is transient in Rn for n > 2.

7.5 The Characteristic Operator

We now introduce an operator which is closely related to the generator A, but is more suitable in many situations, for example in the solution of the Dirichlet problem.

Definition 7.5.1. Let {Xt} be an It^o diffusion. The characteristic operator A = AX of {Xt} is defined by

Af (x)

=

lim
U x

Ex[f (XU )] - Ex[U ]

f (x)

,

(7.5.1)

where the U s are open sets Uk decreasing to the point x, in the sense that Uk+1  Uk and Uk = {x}, and U = inf{t > 0; Xt / U } is the first exit
k
time from U for Xt. The set of functions f such that the limit (7.5.1) exists for all x  Rn (and all {Uk}) is denoted by DA. If Ex[U ] =  for all open U x, we define Af (x) = 0.

It turns out that DA  DA always and that

Af = Af for all f  DA .

(See Dynkin (1965 I, p. 143).) We will only need that AX and LX coincide on C2. To obtain this we
first clarify a property of exit times.

7.5 The Characteristic Operator 123

Definition 7.5.2. A point x  Rn is called a trap for {Xt} if

Qx({Xt = x for all t}) = 1 .

In other words, x is trap if and only if {x} =  a.s. Qx. For example, if b(x0) = (x0) = 0, then x0 is a trap for Xt (by strong uniqueness of Xt).

Lemma 7.5.3. If x is not a trap for Xt, then there exists an open set U x such that
Ex[U ] <  .
Proof. See Lemma 5.5 p. 139 in Dynkin (1965 I).

Theorem 7.5.4. Let f  C2. Then f  DA and

Af =

i

bi

f xi

+

1 2

i,j

(T

)ij

2f xixj

.

(7.5.2)

Proof. As before we let L denote the operator defined by the right hand side
of (7.5.2). If x is a trap for {Xt} then Af (x) = 0. Choose a bounded open set V such that x  V . Modify f to f0 outside V such that f0  C02(Rn). Then f0  DA(x) and 0 = Af0(x) = Lf0(x) = Lf (x). Hence Af (x) = Lf (x) = 0 in this case. If x is not a trap, choose a bounded open set U x such that Ex[U ] < . Then by Dynkin's formula (Theorem 7.4.1) (and the following Remark (i)), writing U = 



Ex[f (X )] - f (x) Ex[ ]

-

Lf (x)

|Ex[ {(Lf )(Xs) - Lf (x)}ds]|

=

0

Ex[ ]

 sup |Lf (x) - Lf (y)|  0
yU

as U  x ,

since Lf is a continuous function.

Remark. We have now obtained that an It^o diffusion is a continuous, strong
Markov process such that the domain of definition of its characteristic operator includes C2. Thus an It^o diffusion is a diffusion in the sense of Dynkin
(1965 I).

Example 7.5.5 (Brownian motion on the unit circle). The character-

istic operator of the process Y =

Y1 Y2

from Example 5.1.4 satisfying the

stochastic differential equations (5.1.13), i.e.

 

dY1

=

-

1 2

Y1dt

-

Y2dB



dY2

=

-

1 2

Y2dt

+

Y1dB

124 7. Diffusions: Basic Properties

is

Af (y1, y2)

=

1 2

y22

2f y12

-

2y1y2



2f y1y2

+

y12

2f y22

-

y1

f y1

-

y2

f y2

.

This

is

because

dY

=

-

1 2

Y

dt

+

KY

dB,

where

K=

0 -1 10

so that

dY = b(Y )dt + (Y )dB

with

b(y1, y2) =

-

1 2

y1

-

1 2

y2

,

(y1, y2) =

-y2 y1

and

a=

1 2

T

=

1 2

y22 -y1y2

-y1y2 y12

.

Example 7.5.6. Let D be an open subset of Rn such that D <  a.s. Qx for all x. Let  be a bounded, measurable function on D and define

(x) = Ex[(XD )]

( is called the X-harmonic extension of ). Then if U is open, x  U  D, we have by (7.2.8) that

Ex[(XU )] = Ex[EXU [(XD )]] = Ex[(XD )] = (x) .

So   DA and

A = 0 in D ,

in spite of the fact that in general  need not even be continuous in D (See Example 9.2.1).

Exercises
7.1. Find the generator of the following It^o diffusions: a) dXt = µXtdt + dBt (The Ornstein-Uhlenbeck process) (Bt  R; µ,  constants). b) dXt = rXtdt + XtdBt (The geometric Brownian motion) (Bt  R; r,  constants). c) dYt = r dt + YtdBt (Bt  R; r,  constants)

Exercises 125

d) dYt =

dt dXt

where Xt is as in a)

e)

dX1 dX2

=

1 X2

dt +

0 eX1

dBt

(Bt  R)

f)

dX1 dX2

=

1 0

dt +

1 0

0 X1

dB1 dB2

g) X(t) = (X1, X2, · · · , Xn), where

n
dXk(t) = rkXkdt + Xk · kjdBj ;
j=1

1kn

((B1, · · · , Bn) is Brownian motion in Rn, rk and kj are constants).

7.2. Find an It^o diffusion (i.e. write down the stochastic differential equa-

tion for it) whose generator is the following:

a) Af (x) = f (x) + f (x) ; f  C02(R)

b)

Af (t, x) =

f t

+

cx

f x

+

1 2

2

x2

 

2f x2

;

f

 C02(R2),

where c,  are constants.

c)

Af (x1,

x2)

=

2x2

f x1

+

ln(1

+

x12

+

x22)

f x2

+

1 2

(1

+

x21

)

2f  x21

+

x1

2f  x1  x2

+

1 2

·

2f  x22

;

f  C02(R2).

7.3. Let Bt be Brownian motion on R, B0 = 0 and define

Xt = Xtx = x · ect+Bt ,

where c,  are constants. Prove directly from the definition that Xt is a Markov process.
7.4. Let Btx be 1-dimensional Brownian motion starting at x  R+. Put

 = inf{t > 0; Btx = 0} .

a) Prove that  <  a.s. P x for all x > 0. (Hint: See Example 7.4.2,
second part). b) Prove that Ex[ ] =  for all x > 0. (Hint: See Example 7.4.2, first
part).

7.5. Let the functions b,  satisfy condition (5.2.1) of Theorem 5.2.1, with a constant C independent of t, i.e.

|b(t, x)| + |(t, x)|  C(1 + |x|) for all x  Rn and all t  0 .

Let Xt be a solution of dXt = b(t, Xt)dt + (t, Xt)dBt .

126 7. Diffusions: Basic Properties

Show that

E[|Xt|2]  (1 + E[|X0|2])eKt - 1

for some constant K independent of t. (Hint: Use Dynkin's formula with f (x) = |x|2 and  = t  R, where R = inf {t > 0; |Xt|  R}, and let R   to achieve the inequality

t
E[|Xt|2]  E[|X0|2] + K · (1 + E[|Xs|2])ds ,
0

which is of the form (5.2.9).)

7.6. Let g(x, ) = f  F (x, t, t + h, ) be as in the proof of Theorem 7.1.2. Assume that f is continuous. a) Prove that the map x  g(x, ·) is continuous from Rn into L2(P ) by using (5.2.9).
For simplicity assume that n = 1 in the following.
b) Use a) to prove that (x, )  g(x, ) is measurable. (Hint: For each m = 1, 2, . . . put k = k(m) = k · 2-m, k = 1, 2, . . . Then

g(m)(x, ·): =

g(k, ·) · X{kx<k+1}

k

converges to g(x, ·) in L2(P ) for each x. Deduce that g(m)  g in L2(dmR × dP ) for all R, where dmR is Lebesgue measure on {|x|  R}. So a subsequence of g(m)(x, ) converges to g(x, ) for a.a. (x, ).)
7.7. Let Bt be Brownian motion on Rn starting at x  Rn and let D  Rn be an open ball centered at x. a) Use Exercise 2.15 to prove that the harmonic measure µDx of Bt is rotation invariant (about x) on the sphere D. Conclude that µDx coincides with normalized surface measure  on D. b) Let  be a bounded measurable function on a bounded open set W  Rn and define

u(x) = Ex[(BW )] for x  W . Prove that u satisfies the classical mean value property:

u(x) = u(y)d(y)
D
for all balls D centered at x with D  W .

Exercises 127

7.8. Let {Nt} be a right-continuous family of -algebras of subsets of , containing all sets of measure zero.

a) Let 1, 2 be stopping times (w.r.t. Nt). Prove that 1 2 and 1 2 are stopping times.

b) If {n} is a decreasing family of stopping times prove that  : =

lim
n

n

is

a

stopping

time.

c) If Xt is an It^o diffusion in Rn and F  Rn is closed, prove that F

is a stopping time w.r.t. Mt. (Hint: Consider open sets decreasing

to F ).

7.9. Let Xt be a geometric Brownian motion, i.e.

dXt = rXtdt + XtdBt , X0 = x > 0

where Bt  R; r,  are constants.

a) Find the generator A of Xt and compute Af (x) when f (x) = x;

x > 0,  constant.

b)

If

r

<

1 2

2

then

Xt



0

as

t



,

a.s.

Qx

(Example

5.1.1).

But what is the probability p that Xt, when starting from x < R,

ever hits the value R ? Use Dynkin's formula with f (x) = x1 ,

1

=

1

-

2r 2

,

to

prove

that

p=

x R

1
.

c)

If r >

1 2

2

then

Xt

  as t  , a.s. Qx.

Put

 = inf{t > 0; Xt  R} .

Use Dynkin's formula with f (x) = ln x, x > 0 to prove that

Ex[ ]

=

r

ln

R x

-

1 2

2

.

(Hint: First consider exit times from (, R),  > 0 and then let   0. You need estimates for

(1 - p()) ln  ,

where

p() = Qx[Xt reaches the value R before  ] , which you can get from the calculations in a), b).)

128 7. Diffusions: Basic Properties

7.10. Let Xt be the geometric Brownian motion

dXt = rXtdt + XtdBt .

Find Ex[XT |Ft] for t  T by a) using the Markov property
and b) writing Xt = x ertMt, where

Mt

=

exp(Bt

-

1 2

2t)

is a martingale .

7.11. Let Xt be an It^o diffusion in Rn and let f : Rn  R be a function such that

Ex |f (Xt)|dt <  for all x  Rn .

0
Let  be a stopping time. Use the strong Markov property to prove that

Ex f (Xt)dt = Ex[g(X )] ,

where



g(y) = Ey f (Xt)dt .

0
7.12. (Local martingales) An Nt-adapted stochastic process Z(t)  Rn is called a local martingale with respect to the given filtration {Nt} if there exists an increasing sequence of Nt-stopping times k such that

k   a.s. as k  

and Z(t  k) is an Nt-martingale for all k .
a) Show that if Z(t) is a local martingale and there exists a constant T   such that the family {Z( )}T is uniformly integrable (Appendix C) then {Z(t)}tT is a martingale.
b) In particular, if Z(t) is a local martingale and there exists a constant K <  such that E[Z2( )]  K
for all stopping times   T , then {Z(t)}tT is a martingale. c) Show that if Z(t) is a lower bounded local martingale, then Z(t) is
a supermartingale (Appendix C).

Exercises 129

7.13. a) Let Bt  R2, B0 = x = 0. Fix 0 < < R <  and define

Xt = ln |Bt | ; t  0

where

 = inf {t > 0; |Bt|  or |Bt|  R} .

Prove that Xt is an Ft -martingale. (Hint: Use Exercise 4.8.) Deduce that ln |Bt| is a local martingale (Exercise 7.12). b) Let Bt  Rn for n  3, B0 = x = 0. Fix > 0, R <  and define

Yt = |Bt |2-n ;

t0

where

 = inf{t > 0; |Bt|  or |Bt|  R} .

Prove that Yt is an Ft -martingale. Deduce that |Bt|2-n is a local martingale.

7.14. (Doob's h-transform) Let Bt be n-dimensional Brownian motion, D  Rn a bounded open set and h > 0 a harmonic function on D (i.e. h = 0 in D). Let Xt be the solution of the stochastic differential equation

dXt = (ln h)(Xt)dt + dBt

More precisely, choose an increasing sequence {Dk} of open subsets of

D such that Dk  D and Dk = D. Then for each k the equation

k=1

above can be solved (strongly) for t < Dk . This gives in a natural way

a

solution

for

t

<

:=

lim
k

Dk .

a) Show that the generator A of Xt satisfies

Af

=

(hf ) 2h

for f  C02(D) .

In

particular,

if

f

=

1 h

then

Af

=

0.

b) Use a) to show that if there exists x0  D such that

lim h(x) =
xyD

0 if y = x0  if y = x0

(i.e. h is a kernel function), then

lim
t

Xt

= x0

a.s.

(Hint: Consider Ex[f (XT )] for suitable stopping times T and with

f

=

1 h

)

130 7. Diffusions: Basic Properties

In other words, we have imposed a drift on Bt which causes the process to exit from D at the point x0 only. This can also be formulated as follows: Xt is obtained by conditioning Bt to exit from D at x0. See Doob (1984).
7.15. Let Bt be 1-dimensional and define
F () = (BT () - K)+
where K > 0, T > 0 are constants. By the It^o representation theorem (Theorem 4.3.3) we know that there exists   V(0, T ) such that

T
F () = E[F ] + (t, )dBt .
0
How do we find  explicitly? This problem is of interest in mathematical finance, where  may be regarded as the replicating portfolio for the contingent claim F (see Chapter 12). Using the Clark-Ocone formula (see Karatzas and Ocone (1991) or Øksendal (1996)) one can deduce that

(t, ) = E[X[K,)(BT )|Ft] ; t < T .

(7.5.3)

Use (7.5.3) and the Markov property of Brownian motion to prove that for t < T we have

(t, ) =



1

exp

2(T - t)

K

-

(x - Bt())2 2(T - t)

dx .

(7.5.4)

7.16. Let Bt be 1-dimensional and let f : R  R be a bounded function. Prove that if t < T then

Ex[f (BT )|Ft] =

1

f (x) exp

2(T - t)

R

(Compare with (7.5.4).)

-

(x - Bt())2 2(T - t)

dx .

(7.5.5)

7.17. Let Bt be 1-dimensional and put

Xt

=

(x1/3

+

1 3

Bt)3

;

t0.

Then we have seen in Exercise 4.15 that Xt is a solution of the stochastic differential equation

dXt

=

1 3

Xt1/3dt

+

Xt2/3dBt

;

X0 = x .

(7.5.6)

Exercises 131

Define

 = inf{t > 0; Xt = 0}

and put

Yt =

Xt 0

for t   for t >  .

Prove that Yt is also a (strong) solution of (7.5.6). Why does not this contradict the uniqueness assertion of Theorem 5.2.1?
(Hint: Verify that

t

t

Yt = x +

1 3

Ys1/3

ds

+

Ys2/3dBs

0

0

for all t by splitting the integrals as follows:

t t t
= + .)

0

0 t

7.18. a) Let

dXt = b(Xt)dt + (Xt)dBt ; X0 = x

be a 1-dimensional It^o diffusion with characteristic operator A. Let f  C2(R) be a solution of the differential equation

Af (x)

=

b(x)f

(x)

+

1 2

2

(x)f

(x) = 0 ;

x  R . (7.5.7)

Let (a, b)  R be an open interval such that x  (a, b) and put

 = inf{t > 0; Xt  (a, b)} . Assume that  <  a.s. Qx and define

p = P x[X = b] .

Use Dynkin's formula to prove that if f (b) = f (a) then

p

=

f (x) - f (a) f (b) - f (a)

.

(7.5.8)

In other words, the harmonic measure µx(a,b) of X on (a, b) = {a, b} is given by

µ(xa,b)(b)

=

f (x) - f (a) f (b) - f (a)

,

µ(xa,b)(a)

=

f (b) - f (x) f (b) - f (a)

.

(7.5.9)

132 7. Diffusions: Basic Properties

b) Now specialize to the process

Xt = x + Bt ; t  0 .

Prove that

p

=

x-a b-a

.

(7.5.10)

c) Find p if

Xt = x + µt + Bt ; t  0

where µ,   R are nonzero constants.

7.19. Let Btx be 1-dimensional Brownian motion starting at x > 0. Define

 =  (x, ) = inf{t > 0; Btx() = 0} .

From Exercise 7.4 we know that

 <  a.s. P x and Ex[ ] =  .

What is the distribution of the random variable  () ? a) To answer this, first find the Laplace transform

g(): = Ex[e- ] for  > 0 . 
(Hint: Let Mt = exp(- 2 Bt - t). Then

{Mt }t0 is a bounded martingale .

 [Solution: g() = exp(- 2 x) .]

b) To find the density f (t) of  it suffices to find f (t) = f (t, x) such

that





e-tf (t)dt = exp(- 2 x) for all  > 0

0
i.e. to find the inverse Laplace transform of g(). Verify that

f (t, x) =  x exp 2t3

-

x2 2t

;

t>0.

8. Other Topics in Diffusion Theory

In this chapter we study some other important topics in diffusion theory and related areas. Some of these topics are not strictly necessary for the remaining chapters, but they are all central in the theory of stochastic analysis and essential for further applications. The following topics will be treated:
8.1 Kolmogorov's backward equation. The resolvent. 8.2 The Feynman-Kac formula. Killing. 8.3 The martingale problem. 8.4 When is an It^o process a diffusion? 8.5 Random time change. 8.6 The Girsanov formula.

8.1 Kolmogorov's Backward Equation. The Resolvent

In the following we let Xt be an It^o diffusion in Rn with generator A. If we choose f  C02(Rn) and  = t in Dynkin's formula (7.4.1) we see that
u(t, x) = Ex[f (Xt)]

is differentiable with respect to t and

u t

=

Ex[Af (Xt)]

.

(8.1.1)

It turns out that the right hand side of (8.1.1) can be expressed in terms of u also:

Theorem 8.1.1 (Kolmogorov's backward equation). Let f  C02(Rn).

a) Define

u(t, x) = Ex[f (Xt)] .

Then u(t, ·)  DA for each t and

u t

=

Au

,

t > 0, x  Rn

u(0, x) = f (x) ; x  Rn

(8.1.2)
(8.1.3) (8.1.4)

134 8. Other Topics in Diffusion Theory

where the right hand side is to be interpreted as A applied to the function
x  u(t, x). b) Moreover, if w(t, x)  C1,2(R × Rn) is a bounded function satisfying
(8.1.3), (8.1.4) then w(t, x) = u(t, x), given by (8.1.2).

Proof. a) Let g(x) = u(t, x). Then since t  u(t, x) is differentiable we have

Ex[g(Xr)] - g(x) r

=

1 r

·

Ex[EXr [f (Xt)]

-

Ex[f (Xt)]]

=

1 r

·

Ex[Ex[f (Xt+r)|Fr]

-

Ex[f (Xt)|Fr]]

=

1 r

·

Ex[f (Xt+r)

-

f (Xt)]

=

u(t + r, x) - u(t, x) r



u t

as r  0 .

Hence

Au

=

lim
r0

E x [g (Xr )] r

-

g(x)

exists and

u t

=

Au,

as

asserted

.

Conversely, to prove the uniqueness statement in b) assume that a function w(t, x)  C1,2(R × Rn) satisfies (8.1.3)­(8.1.4). Then

Aw:

=

-

w t

+

Aw

=

0

for t > 0, x  Rn

(8.1.5)

and

w(0, x) = f (x) , x  Rn .

(8.1.6)

Fix (s, x)  R × Rn. Define the process Yt in Rn+1 by Yt = (s - t, Xt0,x), t  0. Then Yt has generator A and so by (8.1.5) and Dynkin's formula we have, for all t  0,

Es,x[w(YtR )] = w(s, x) + Es,x

tR
Aw(Yr )dr
0

= w(s, x) ,

where R = inf{t > 0; |Xt|  R}. Letting R   we get

w(s, x) = Es,x[w(Yt)] ; t  0 .

In particular, choosing t = s we get

w(s, x) = Es,x[w(Ys)] = E[w(0, Xs0,x)] = E[f (Xs0,x)] = Ex[f (Xs)] .

8.1 Kolmogorov's Backward Equation. The Resolvent 135

Remark. If we introduce the operator Qt: f  E·[f (Xt)] then we have u(t, x) = (Qtf )(x) and we may rewrite (8.1.1) and (8.1.3) as follows:

d dt

(Qtf

)

=

Qt(Af

)

;

f  C02(Rn)

(8.1.1)

d dt

(Qtf

)

=

A(Qtf

)

;

f  C02(Rn) .

(8.1.3)

Thus the equivalence of (8.1.1) and (8.1.3) amounts to saying that the oper-

ators Qt and A commute, in some sense. Arguing formally, it is tempting to say that the solution of (8.1.1) and (8.1.3) is

Qt = etA

and therefore QtA = AQt. However, this argument would require a further explanation, because in general A is an unbounded operator.
It is an important fact that the operator A always has an inverse, at least if a positive multiple of the identity is subtracted from A. This inverse can be expressed explicitly in terms of the diffusion Xt:

Definition 8.1.2. For  > 0 and g  Cb(Rn) we define the resolvent operator R by


Rg(x) = Ex e-tg(Xt)dt .

(8.1.7)

0

Lemma 8.1.3. Rg is a bounded continuous function.


Proof. Since Rg(x) = e-tEx[g(Xt)]dt, we see that Lemma 8.1.3 is a
0
direct consequence of the next result:

Lemma 8.1.4. Let g be a lower bounded, measurable function on Rn and define, for fixed t  0
u(x) = Ex[g(Xt)] .
a) If g is lower semicontinuous, then u is lower semicontinuous. b) If g is bounded and continuous, then u is continuous. In other words, any
It^o diffusion Xt is Feller-continuous.

Proof. By (5.2.10) we have

E[|Xtx - Xty|2]  |y - x|2C(t) ,

where C(t) does not depend on x and y. Let {yn} be a sequence of points converging to x. Then

Xtyn  Xtx

in L2(, P ) as n   .

So, by taking a subsequence {zn} of {yn} we obtain that Xtzn ()  Xtx() for a.a.    .

136 8. Other Topics in Diffusion Theory

a) If g is lower bounded and lower semicontinuous, then by the Fatou lemma

u(x)

=

E[g(Xtx)]



E[

lim
n

g(Xtzn

)]



lim
n

E[g(Xtzn

)]

=

lim
n

u(zn)

.

Therefore every sequence {yn} converging to x has a subsequence {zn} such that u(x)  nlimu(zn). That proves that u is lower semicontinuous. b) If g is bounded and continuous, the result in a) can be applied both to g and -g. Hence both u and -u are lower semicontinuous and we conclude that u is continuous.

We now prove that R and  - A are inverse operators:

Theorem 8.1.5. a) If f  C02(Rn) then R( - A)f = f for all  > 0. b) If g  Cb(Rn) then Rg  DA and ( - A)Rg = g for all  > 0.

Proof. a) If f  C02(Rn) then by Dynkin's formula

R( - A)f (x) = (Rf - RAf )(x)





=  e-tEx[f (Xt)]dt - e-tEx[Af (Xt)]dt

0

0


= -e-tEx[f (Xt)] +



e-t

d dt

E

x

[f

(Xt

)]dt

-


e-tEx[Af (Xt)]dt

0

0

0

= Ex[f (X0)] = f (x) .

b) If g  Cb(Rn) then by the strong Markov property


Ex[Rg(Xt)] = Ex[EXt e-sg(Xs)ds ]

= Ex[Ex t

0 
e-sg(Xs)ds |Ft ] = Ex[Ex


e-sg(Xt+s)ds|Ft ]

= Ex

0

0





e-sg(Xt+s)ds = e-sEx[g(Xt+s)]ds .

0

0

Integration by parts gives



t+s

Ex[Rg(Xt)] =  e-s Ex[g(Xv)]dv ds .

0

t

This identity implies that Rg  DA and

A(Rg) = Rg - g .

8.2 The Feynman-Kac Formula. Killing 137

8.2 The Feynman-Kac Formula. Killing

With a little harder work we can obtain the following useful generalization of Kolmogorov's backward equation:

Theorem 8.2.1 (The Feynman-Kac formula). Let f  C02(Rn) and q  C(Rn). Assume that q is lower bounded.
a) Put
t
v(t, x) = Ex exp - q(Xs)ds f (Xt) .

(8.2.1)

Then

0

v t

= Av - qv

;

v(0, x) = f (x) ;

t > 0, x  Rn x  Rn

(8.2.2) (8.2.3)

b) Moreover, if w(t, x)  C1,2(R × Rn) is bounded on K × Rn for each compact K  R and w solves (8.2.2), (8.2.3), then w(t, x) = v(t, x), given by (8.2.1).

t
Proof. a) Let Yt = f (Xt), Zt = exp(- q(Xs)ds). Then dYt is given by
0
(7.3.1) and dZt = -Ztq(Xt)dt .
So d(YtZt) = YtdZt + ZtdYt , since dZt · dYt = 0 .
Note that since YtZt is an It^o process it follows from Lemma 7.3.2 that v(t, x) = Ex[YtZt] is differentiable w.r.t. t.
Therefore, with v(t, x) as in (8.2.1) we get

1 r

(Ex

[v(t,

Xr

)]

-

v(t, x))

=

1 r

E

x

[E

Xr

[Zt

f

(Xt

)]

-

Ex[Ztf (Xt)]]

t

=

1 r

E

x[E

x[f

(Xt+r

)

exp

-

q(Xs+r)ds |Fr] - Ex[Ztf (Xt)|Fr]]

0

=

1 r

E

x[Zt+r

·

exp

r
q(Xs)ds f (Xt+r) - Ztf (Xt)]

0

=

1 r

E

x[f

(Xt+r

)Zt+r

-

f (Xt)Zt]

+

1 r

Ex

f (Xt+r)Zt+r ·

exp

r
q(Xs)ds - 1

0



 t

v(t,

x)

+

q(x)v(t, x)

as r  0 ,

138 8. Other Topics in Diffusion Theory

because

1 r

f

(Xt+r

)Zt+r

exp

r
q(Xs)ds
0

- 1  f (Xt)Ztq(X0)

pointwise boundedly. That completes the proof of a).

b) Assume that w(t, x)  C1,2(R × Rn) satisfies (8.2.2) and (8.2.3) and that w(t, x) is bounded on K × Rn for each compact K  R. Then

Aw(t, x): =

-

w t

+

Aw

- qw

=

0

for t > 0, x  Rn

(8.2.4)

and

w(0, x) = f (x) ; x  Rn .

(8.2.5)

t
Fix (s, x, z)  R × Rn × Rn and define Zt = z + q(Xs)ds and Ht = (s - t,
0
Xt0,x, Zt). Then Ht is an It^o diffusion with generator

AH (s, x, z)

=

-

 s

+ A +

q(x)

 z

;

  C02(R × Rn × Rn) .

Hence by (8.2.4) and Dynkin's formula we have, for all t  0, R > 0 and with (s, x, z) = exp(-z)w(s, x):

Es,x,z[(HtR )] = (s, x, z) + Es,x,z

tR
AH (Hr)dr ,
0

where R = inf{t > 0; |Ht|  R}. Note that with this choice of  we have by (8.2.4)

AH (s, x, z) = exp(-z)

-

w s

+

Aw

-

q(x)w

=0.

Hence

w(s, x) = (s, x, 0) = Es,x,0[(HtR )]
tR

= Ex exp -

q(Xr)dr w(s - t  R, XtR )

0 t

 Ex exp - q(Xr)dr w(s - t, Xt)

as R   ,

0

since w(r, x) is bounded for (r, x)  K × Rn. In particular, choosing t = s we get

8.2 The Feynman-Kac Formula. Killing 139

s
w(s, x) = Ex exp - q(Xr)dr w(0, Xs0,x) = v(s, x) , as claimed .

0

Remark. (About killing a diffusion)

In Theorem 7.3.3 we have seen that the generator of an It^o diffusion Xt given by

dXt = b(Xt)dt + (Xt)dBt

(8.2.6)

is a partial differential operator L of the form

Lf =

aij

2f xixj

+

bi

f xi

(8.2.7)

where

[aij ]

=

1 2

T

,

b

=

[bi].

It

is

natural

to

ask

if

one

can

also

find

processes

whose generator has the form

Lf =

aij

2f xixj

+

bi

f xi

-

cf

,

(8.2.8)

where c(x) is a bounded and continuous function.
If c(x)  0 the answer is yes and a process Xt with generator (8.2.8) is obtained by killing Xt at a certain (killing) time . By this we mean that there exists a random time  such that if we put

Xt = Xt if t < 

(8.2.9)

and leave Xt undefined if t   (alternatively, put Xt =  if t  , where  / Rn is some "coffin" state), then Xt is also a strong Markov process and

Ex[f (Xt)] = Ex[f (Xt), t < ] = Ex

f (Xt) · e-

t 0

c(Xs )ds

(8.2.10)

for all bounded continuous functions f on Rn. Let v(t, x) denote the right hand side of (8.2.10) with f  C02(Rn). Then

lim
t0

Ex[f (Xt)] t

- f (x)

=

 t

v(t,

x)t=0

=

(Av

- cv)t=0

=

Af (x) -

c(x)f (x)

,

by the Feynman-Kac formula.
So the generator of Xt is (8.2.8), as required. The function c(x) can be interpreted as the killing rate:

c(x)

=

lim
t0

1 t

Qx[X0

is killed in the time interval (0, t]] .

Thus by applying such a killing procedure we can come from the special case c = 0 in (8.2.7) to the general case (8.2.8) with c(x)  0. Therefore, for many purposes it is enough to consider the equation (8.2.7).
If the function c(x)  0 is given, an explicit construction of the killing time  such that (8.2.10) holds can be found in Karlin and Taylor (1975), p. 314. For a more general discussion see Blumenthal and Getoor (1968), Chap. III.

140 8. Other Topics in Diffusion Theory

8.3 The Martingale Problem

If dXt = b(Xt)dt + (Xt)dBt is an It^o diffusion in Rn with generator A and if f  C02(Rn) then by (7.3.1)

t

t

f (Xt) = f (x) + Af (Xs)ds + f T (Xs)(Xs)dBs .

0

0

(8.3.1)

Define

t

t

Mt = f (Xt) - Af (Xr)dr (= f (x) + f T (Xr)(Xr)dBr) .

0

0

(8.3.2)

Then, since It^o integrals are martingales (w.r.t. the -algebras {Ft(m)}) we have for s > t
Ex[Ms|Ft(m)] = Mt . It follows that

Ex[Ms|Mt] = Ex[Ex[Ms|Ft(m)]|Mt] = Ex[Mt|Mt] = Mt ,

since Mt is Mt-measurable. We have proved: Theorem 8.3.1. If Xt is an It^o diffusion in Rn with generator A, then for all f  C02(Rn) the process

t
Mt = f (Xt) - Af (Xr)dr
0

is a martingale w.r.t. {Mt}.

If we identify each    with the function

t = (t) = Xtx() we see that the probability space (, M, Qx) is identified with

((Rn)[0,), B, Qx)

where B is the Borel -algebra on (Rn)[0,) (see Chapter 2). Thus, regarding the law of Xtx as a probability measure Qx on B we can formulate Theorem 8.3.1 as follows:
Theorem 8.3.1'. If Qx is the probability measure on B induced by the law Qx of an It^o diffusion Xt, then for all f  C02(Rn) the process

8.3 The Martingale Problem 141

t

t

Mt = f (Xt) - Af (Xr)dr (= f (t) - Af (r)dr) ;   (Rn)[0,)

0

0

(8.3.3)

is a Qx-martingale w.r.t. the Borel -algebras Bt of (Rn)[0,t], t  0. In other words, the measure Qx solves the martingale problem for the differential

operator A, in the following sense:

Definition 8.3.2. Let L be a semi-elliptic differential operator of the form

L=

bi

 xi

+

i,j

aij



2 xi

xj

where the coefficients bi, aij are locally bounded Borel measurable functions on Rn. Then we say that a probability measure P x on ((Rn)[0,), B) solves the martingale problem for L (starting at x) if the process

t
Mt = f (t) - Lf (r)dr , M0 = f (x)
0

a.s. P x

is a P x martingale w.r.t. Bt, for all f  C02(Rn). The martingale problem is called well posed if there is a unique measure P x solving the martingale problem.

The argument of Theorem 8.3.1 actually proves that Qx solves the mar-

tingale problem for A whenever Xt is a weak solution of the stochastic differential equation

dXt = b(Xt)dt + (Xt)dBt .

(8.3.4)

Conversely, it can be proved that if P x solves the martingale problem for

L=

bi

 xi

+

1 2

(T

)ij

2 xi

xj

(8.3.5)

starting at x, for all x  Rn, then there exists a weak solution Xt of the stochastic differential equation (8.3.4). Moreover, this weak solution Xt is a Markov process if and only if the martingale problem for L is well posed.
(See Stroock and Varadhan (1979) or Rogers and Williams (1987)). There-
fore, if the coefficients b,  of (8.3.4) satisfy the conditions (5.2.1), (5.2.2) of
Theorem 5.2.1, we conclude that

Qx is the unique solution of the martingale problem for the operator L given by (8.3.5) .

(8.3.6)

Lipschitz-continuity of the coefficients of L is not necessary for the uniqueness of the martingale problem. For example, one of the spectacular results of Stroock and Varadhan (1979) is that

142 8. Other Topics in Diffusion Theory

L=

bi

 xi

+

aij



2 xi

xj

has a unique solution of the martingale problem if [aij] is everywhere positive definite, aij(x) is continuous, b(x) is measurable and there exists a constant D such that

|b(x)|

+

|a(x)|

1 2



D(1 + |x|)

for all x  Rn .

8.4 When is an It^o Process a Diffusion?

The It^o formula gives that if we apply a C2 function : U  Rn  Rn to an
Ito^ process Xt the result (Xt) is another It^o process. A natural question is: If Xt is an It^o diffusion will (Xt) be an It^o diffusion too? The answer is no in general, but it may be yes in some cases:

Example 8.4.1 (The Bessel process). Let n  2. In Example 4.2.2 we found that the process

Rt()

=

|B(t,

)|

=

(B1(t,

)2

+

·

·

·

+

Bn(t,

)2)

1 2

satisfies the equation

dRt

=

n i=1

BidBi Rt

+

n-1 2Rt

dt

.

(8.4.1)

However, as it stands this is not a stochastic differential equation of the form (5.2.3), so it is not apparent from (8.4.1) that R is an It^o diffusion. But this will follow if we can show that

Yt: =

t

n

Bi |B|

dBi

0 i=1

coincides in law with (i.e. has the same finite-dimensional distributions as) 1-dimensional Brownian motion Bt. For then (8.4.1) can be written

dRt

=

n-1 2Rt

dt

+

dB

which is of the form (5.2.3), thus showing by weak uniqueness (Lemma 5.3.1) that Rt is an It^o diffusion with generator

Af (x)

=

1 2

f

(x) +

n- 2x

1

f

(x)

as claimed in Example 4.2.2. One way of seeing that the process Yt coincides in law with 1-dimensional Brownian motion Bt is to apply the following result:

8.4 When is an It^o Process a Diffusion? 143

Theorem 8.4.2. An It^o process

dYt = vdBt ;

Y0 = 0 with v(t, )  VHn×m

coincides (in law) with n-dimensional Brownian motion if and only if

vvT (t, ) = In for a.a. (t, ) w.r.t. dt × dP

(8.4.2)

where In is the n-dimensional identity matrix. Note that in the example above we have

t

Yt = vdB

0

with

v=

B1 |B|

,

.

.

.

,

Bn |B|

,

 B1  B =  ... 
Bn

and since vvT = 1, we get that Yt is a 1-dimensional Brownian motion, as required.
Theorem 8.4.2 is a special case of the following result, which gives a

necessary and sufficient condition for an It^o process to coincide in law with

a given diffusion: (We use the symbol for "coincides in law with").

Theorem 8.4.3. Let Xt be an It^o diffusion given by dXt = b(Xt)dt + (Xt)dBt , b  Rn ,   Rn×m, X0 = x ,

and let Yt be an It^o process given by dYt = u(t, )dt + v(t, )dBt , u  Rn , v  Rn×m, Y0 = x .

Then Xt Yt if and only if

Ex[u(t, ·)|Nt] = b(Ytx) and vvT (t, ) = T (Ytx)

(8.4.3)

for a.a. (t, ) w.r.t. dt×dP , where Nt is the -algebra generated by Ys; s  t.

Proof. Assume that (8.4.3) holds. Let

A=

bi

 xi

+

1 2

i,j

(T

)ij

2 xixj

be the generator of Xt and define, for f  C02(Rn),

Hf (t, ) =

i

ui(t,

)

f xi

(Yt)

+

1 2

i,j

(vvT

)ij (t,

)



2f xixj

(Yt)

.

144 8. Other Topics in Diffusion Theory

Then by It^o's formula (see (7.3.1)) we have, for s > t,

s

s

Ex[f (Ys)|Nt] = f (Yt) + Ex Hf (r, )dr|Nt + Ex f T vdBr|Nt

t

t

s

= f (Yt) + Ex Ex[Hf (r, )|Nr]dr|Nt

t s

= f (Yt) + Ex Af (Yr)dr|Nt

by (8.4.3) ,

(8.4.4)

t

where Ex denotes expectation w.r.t. the law Rx of Yt (see Lemma 7.3.2). Therefore, if we define

t
Mt = f (Yt) - Af (Yr)dr

(8.4.5)

0
then, for s > t,

s

s

Ex[Ms|Nt] = f (Yt) + Ex Af (Yr)dr|Nt - Ex Af (Yr)dr|Nt

t

0

t

= f (Yt) - Ex Af (Yr)dr|Nt = Mt .

0

Hence Mt is a martingale w.r.t. the -algebras Nt and the law Rx. By uniqueness of the solution of the martingale problem (see (8.3.6)) we conclude that
Xt Yt. Conversely, assume that Xt Yt. Choose f  C02. By It^o's formula (7.3.1)
we have, for a.a. (t, ) w.r.t. dt × dP ,

lim
h0

1 h

(Ex[f

(Yt+h)|Nt]

-

f

(Yt))

=

lim
h0

1 h

t+h
Ex
t

i

ui

(s,

)

f xi

(Ys)

+

1 2

i,j

(vvT

)ij (s,

)



2f xixj

(Ys)|Nt

ds

(8.4.6)

=

i

Ex[ui(t,

)|Nt]

f xi

(Yt)

+

1 2

i,j

Ex[(vvT

)ij

(t,

)|Nt]

2f xixj

(Yt)

.

(8.4.7)

On the other hand, since Xt Yt we know that Yt is a Markov process. Therefore (8.4.6) coincides with

8.4 When is an It^o Process a Diffusion? 145

lim
h0

1 h

(E Yt

[f

(Yh)]

-

E Yt

[f

(Y0)])

=

i

E Yt

ui(0,

)

f xi

(Y0)

+

1 2

i,j

E Yt

(vvT

)ij

(0,

)



2f xixj

(Y0

)

=

i

E

Yt

[ui

(0,



)]

f xi

(Yt

)

+

1 2

i,j

E Yt

[(vvT

)ij

(0,

)]

2f xixj

(Yt)

.

(8.4.8)

Comparing (8.4.7) and (8.4.8) we conclude that

Ex[u(t, )|Nt] = EYt [u(0, )] and Ex[vvT (t, )|Nt] = EYt [vvT (0, )] (8.4.9)
for a.a. (t, ). On the other hand, since the generator of Yt coincides with the generator
A of Xt we get from (8.4.8) that
EYt [u(0, )] = b(Yt) and EYt [vvT (0, )] = T (Yt) for a.a. (t, ) . (8.4.10)
Combining (8.4.9) and (8.4.10) we conclude that

Ex[u|Nt] = b(Yt) and Ex[vvT |Nt] = T (Yt) for a.a. (t, ) . (8.4.11)
From this we obtain (8.4.3) by using that in fact vvT (t, ·) is always Ntmeasurable, in the following sense:

Lemma 8.4.4. Let dYt = u(t, )dt + v(t, )dBt, Y0 = x be as in Theorem 8.4.3. Then there exists an Nt-adapted process W (t, ) such that
vvT (t, ) = W (t, ) for a.a. (t, ) .

Proof. By It^o's formula we have (if Yi(t, ) denotes component number i of Y (t, ))

t

t

t

YiYj(t, ) = xixj + YidYj(s) + YjdYi(s) + (vvT )ij(s, )ds .

0

0

0

Therefore, if we put

t

t

Hij(t, ) = YiYj(t, ) - xixj - YidYj - YjdYi ,

0

0

then Hij is Nt-adapted and

t
Hij(t, ) = (vvT )ij(s, )ds .
0

1  i, j  n

146 8. Other Topics in Diffusion Theory

Therefore

(vvT

)ij

(t,

)

=

lim
r0

H (t,

)

-

H (t r

-

r,

)

for a.a. t. This shows Lemma 8.4.4 and the proof of Theorem 8.4.3 is complete.

Remarks. 1) One may ask if also u(t, ·) must be Nt-measurable. However, the following example shows that this fails even in the case when v = n = 1:
Let B1, B2 be two independent 1-dimensional Brownian motions and define
dYt = B1(t)dt + dB2(t) .
Then we may regard Yt as noisy observations of the process B1(t). So by Example 6.2.10 we have that

E[(B1(t, ) - B1(t, ))2] = tanh(t) ,

where B1(t, ) = E[B1(t)|Nt] is the Kalman-Bucy filter. In particular, B1(t, ) cannot be Nt-measurable.
2) The process v(t, ) need not be Nt-adapted either: Let Bt be 1dimensional Brownian motion and define

dYt = sign(Bt)dBt

where

sign(z) =

Tanaka's formula says that

1 if z > 0 -1 if z  0 .

(8.4.12)

t
|Bt| = |B0| + sign(Bs)dBs + Lt
0

(8.4.13)

where Lt = Lt() is local time of Bt at 0, a non-decreasing process which only increases when Bt = 0 (see Exercise 4.10). Therefore the -algebra Nt generated by {Ys; s  t} is contained in the -algebra Ht generated by {|Bs|; s  t}. It follows that v(t, ) = sign(Bt) cannot be Nt-adapted.

Corollary 8.4.5 (How to recognize a Brownian motion). Let
dYt = u(t, )dt + v(t, )dBt
be an It^o process in Rn. Then Yt is a Brownian motion if and only if

Ex[u(t, ·)|Nt] = 0 and vvT (t, ) = In

(8.4.14)

for a.a. (t, ).

8.5 Random Time Change 147

Remark. Using Theorem 8.4.3 one may now proceed to investigate when the image Yt = (Xt) of an It^o diffusion Xt by a C2-function  coincides in law with an It^o diffusion Zt. Applying the criterion (8.4.3) one obtains the following result:

(Xt)  Zt if and only if A[f o] = A[f ]o

(8.4.15)

for all second order polynomials f (x1, . . . , xn) = aixi + cijxixj (and hence for all f  C02) where A and A are the generators of Xt and Zt respectively. (Here o denotes function composition: (f  )(x) = f ((x)).) For generalizations of this result, see Csink and Øksendal (1983), and Csink, Fitzsimmons and Øksendal (1990).

8.5 Random Time Change

Let c(t, )  0 be an Ft-adapted process. Define

t
t = (t, ) = c(s, )ds .
0

(8.5.1)

We will say that t is a (random) time change with time change rate c(t, ). Note that (t, ) is also Ft-adapted and for each  the map t  t() is
non-decreasing. Define t = (t, ) by

t = inf{s; s > t} .

(8.5.2)

Then t is a right-inverse of t, for each  :

((t, ), ) = t for all t  0 .

(8.5.3)

Moreover, t  t() is right-continuous. If c(s, ) > 0 for a.a. (s, ) then t  t() is strictly increasing, t  t()
is continuous and t is also a left-inverse of t:

((t, ), ) = t for all t  0 .

(8.5.4)

In general   (t, ) is an {Fs}-stopping time for each t, since

{; (t, ) < s} = {; t < (s, )}  Fs .

(8.5.5)

We now ask the question: Suppose Xt is an It^o diffusion and Yt an It^o process as in Theorem 8.4.3. When does there exist a time change t such that Yt Xt ? (Note that t is only defined up to time . If  <  we interpret Yt Xt to mean that Yt has the same law as Xt up to time ).
Here is a partial answer (see Øksendal (1990)):

148 8. Other Topics in Diffusion Theory

Theorem 8.5.1. Let Xt, Yt be as in Theorem 8.4.3 and let t be a time change with right inverse t as in (8.5.1), (8.5.2) above. Assume that

u(t, ) = c(t, )b(Yt) and vvT (t, ) = c(t, ) · T (Yt)

(8.5.6)

for a.a. t, . Then

Yt Xt .

This result allows us to recognize time changes of Brownian motion:

Theorem 8.5.2. Let dYt = v(t, )dBt, v  Rn×m, Bt  Rm be an It^o integral in Rn, Y0 = 0 and assume that

vvT (t, ) = c(t, )In

(8.5.7)

for some process c(t, )  0. Let t, t be as in (8.5.1), (8.5.2). Then

Yt is an n-dimensional Brownian motion .
n
Corollary 8.5.3. Let dYt = vi(t, )dBi(t, ), Y0 = 0, where B =
i=1
(B1, . . . , Bn) is a Brownian motion in Rn. Then

Bt: = Yt is a 1-dimensional Brownian motion ,

where t is defined by (8.5.2) and

s
s =
0

n
vi2(r, ) dr .
i=1

Corollary 8.5.4. Let Yt, s be as in Corollary 8.5.3. Assume that

n
vi2(r, ) > 0 for a.a. (r, ) .
i=1

(8.5.8) (8.5.9)

Then there exists a Brownian motion Bt such that

Yt = Bt .

(8.5.10)

Proof. Let

Bt = Yt

(8.5.11)

be the Brownian motion from Corollary 8.5.3. By (8.5.9) t is strictly increasing and hence (8.5.4) holds, So choosing t = s in (8.5.11) we get (8.5.10).

8.5 Random Time Change 149

Corollary 8.5.5. Let c(t, )  0 be given and define

t
dYt =
0

c(s, ) dBs ,

where Bs is an n-dimensional Brownian motion. Then

Yt is also an n-dimensional Brownian motion .

We now use this to prove that a time change of an It^o integral is again an
It^o integral, but driven by a different Brownian motion Bt. First we construct Bt:

Lemma 8.5.6. Suppose s  (s, ) is continuous, (0, ) = 0 for a.a. .

Fix t > 0 such that t <  a.s. and assume that E[t] < . For k = 1, 2, . . . put

tj =

j · 2-k t

if if

j · 2-k  t j · 2-k > t

and choose rj such that rj = tj. Suppose f (s, )  0 is Fs-adapted, bounded and s-continuous for a.a. . Then

t

lim
k

f (j, )Bj = f (s, )dBs

j

0

a.s. ,

(8.5.12)

where j = rj , Bj = Bj+1 - Bj and the limit is in L2(, P ).

Proof. For all k we have

t

2

E

f (j, )Bj - f (s, )dBs

j

0

=E

j+1 2
(f (j, ) - f (s, )dBs

j j

j+1

2

=E

(f (j, ) - f (s, ))dBs

j

j

j+1

t

=E

(f (j, ) - f (s, ))2ds = E (f - fk)2ds ,

j

j

0

where fk(s, ) = j f (tj, )X[tj,tj+1) (s) is the elementary approximation to f . (See Corollary 3.1.8). This implies (8.5.12).

150 8. Other Topics in Diffusion Theory

We now use this to establish a general time change formula for It^o integrals. An alternative proof in the case n = m = 1 can be found in McKean (1969, §2.8).

Theorem 8.5.7 (Time change formula for It^o integrals). Suppose c(s, ) and (s, ) are s-continuous, (0, ) = 0 for a.a.  and that E[t] < . Let Bs be an m-dimensional Brownian motion and let v(s, )  VHn×m be bounded and s-continuous. Define

Bt

=

lim
k

j

t
c(j , ) Bj =
0

c(s, ) dBs .

(8.5.13)

Then Bt is an (m-dimensional) F(mt )-Brownian motion (i.e. Bt is a Brownian motion and Bt is a martingale w.r.t. F(mt )) and

t

t

v(s, )dBs = v(r, )

0

0

r() dBr

a.s. P ,

(8.5.14)

where r() is the derivative of (r, ) w.r.t. r, so that

r ( )

=

1 c(r, )

for a.a. r  0, a.a.    .

(8.5.15)

Proof. The existence of the limit in (8.5.13) and the second identity in (8.5.13) follow by applying Lemma 8.5.6 to the function

f (s, ) = c(s, ) .

Then by Corollary 8.5.5 we have that Bt is an F(mt )-Brownian motion. It remains to prove (8.5.14):

t

v(s, )dBs

=

lim
k

v(j , )Bj

0

j

= lim
k

v(j, )

j

1 c(j, )

c(j, ) Bj

= lim
k

j

v(j, )

1 c(j, )

Bj

t
= v(r, )
0

1 c(r, )

dBr

and the proof is complete.

8.5 Random Time Change 151

Example 8.5.8 (Brownian motion on the unit sphere in Rn; n > 2).

In Examples 5.1.4 and 7.5.5 we constructed Brownian motion on the unit circle. It is not obvious how to extend the method used there to obtain Brownian motion on the unit sphere S of Rn; n  3. However, we may proceed as follows: Apply the function : Rn \ {0}  S defined by
(x) = x · |x|-1 ; x  Rn \ {0}

to n-dimensional Brownian motion B = (B1, . . . , Bn). The result is a stochastic integral Y = (Y1, . . . , Yn) = (B) which by It^o's formula is given by

dYi

=

|B|2 - Bi2 |B|3

dBi

-

Bj Bi |B|3

dBj

-

n

- 2

1

·

Bi |B|3

dt

;

j=i

Hence where

dY

=

1 |B|

· (Y )dB +

1 |B|2

b(Y

)dt

,

i = 1, 2, . . . , n . (8.5.16)

 = [ij]  Rn×n , with ij(Y ) = ij - YiYj; 1  i, j  n

and



b(y)

=

-n

- 2

1

· 

y1 ...





Rn

,

yn

(y1, . . . , yn are the coordinates of y  Rn) .

Now perform the following time change: Define

Zt() = Y(t,)()

where

t = t-1 ,

t

(t, ) =

1 |B|2

ds

.

0

Then Z is again an It^o process and by Theorem 8.5.7

dZ = (Z)dB + b(Z)dt .

Hence Z is a diffusion with characteristic operator

Af (y)

=

1 2

f (y) -

i,j

yi

yj



2f yiyj

-

n

- 2

1

·

i

yi

f yi

;

|y| = 1 . (8.5.17)

152 8. Other Topics in Diffusion Theory

Thus,

(B)

=

B |B|

is

­

after

a

suitable

change

of

time

scale

­

equal

to

a

diffusion Z living on the unit sphere S of Rn. Note that Z is invariant under

orthogonal transformations in Rn (since B is). It is reasonable to call Z

Brownian motion on the unit sphere S. For other constructions see It^o and

McKean (1965, p. 269 (§7.15)) and Stroock (1971).

More generally, given a Riemannian manifold M with metric tensor g =

[gij] one may define a Brownian motion on M as a diffusion on M whose

characteristic operator A in local coordinates xi Laplace-Beltrami operator (here [gij] = [gij]-1)

is

given

by

1 2

times

the

M =

1· det(g)

i

 xi

det(g)

j

gij

 xj

.

(8.5.18)

See for example Meyer (1966, p. 256­270), McKean (1969, §4.3). The subject of stochastic differential equations on manifolds is also treated in Ikeda and Watanabe (1989), Emery (1989) and Elworthy (1982).

Example 8.5.9 (Harmonic and analytic functions). Let B = (B1, B2) be 2-dimensional Brownian motion. Let us investigate what happens if we apply a C2 function

(x1, x2) = (u(x1, x2), v(x1, x2))

to B: Put Y = (Y1, Y2) = (B1, B2) and apply It^o's formula:

dY1

=

u1(B1,

B2)dB1

+

u2(B1,

B2)dB2

+

1 2

[u11(B1

,

B2)

+

u22(B1,

B2)]dt

and

dY2

=

v1(B1,

B2)dB1

+

v2(B1,

B2)dB2

+

1 2

[v11

(B1,

B2)

+

v22(B1,

B2)]dt

,

where u1 =

u x1

etc. So

dY = b(B1, B2)dt + (B1, B2)dB ,

with

b

=

1 2

u v

, =

u1 u2 v1 v2

= D (the derivative of ).

So Y = (B1, B2) is a martingale if (and, in fact, only if)  is harmonic,

i.e.  = 0. If  is harmonic, we get by Corollary 8.5.3 that

(B1, B2) = (B(11), B(22))
where B(1) and B(2) are two (not necessarily independent) versions of 1dimensional Brownian motion, and

t
1(t, ) = |u|2(B1, B2)ds ,
0

t
2(t, ) = |v|2(B1, B2)ds .
0

8.6 The Girsanov Theorem 153

Since

|u|2 u · v T = u · v |v|2

we see that if (in addition to u = v = 0)

|u|2 = |v|2 and u · v = 0

(8.5.19)

then
t

Yt = Y0 + dB

0

with

T = |u|2(B1, B2)I2 , Y0 = (B1(0), B2(0)) .

Therefore, if we let

t
t = (t, ) = |u|2(B1, B2)ds ,
0

t = t-1

we obtain by Theorem 8.5.2 that Yt is a 2-dimensional Brownian motion. Conditions (8.5.19) ­ in addition to u = v = 0 ­ are easily seen to be equivalent to requiring that the function (x + iy) = (x, y) regarded as a complex function is either analytic or conjugate analytic.
Thus we have proved a theorem of P. L´evy that (B1, B2) is ­ after a change of time scale ­ again Brownian motion in the plane if and only if  is either analytic or conjugate analytic. For extensions of this result see Bernard, Campbell and Davie (1979), Csink and Øksendal (1983) and Csink, Fitzsimmons and Øksendal (1990).

8.6 The Girsanov Theorem
We end this chapter by discussing a result, the Girsanov theorem, which is fundamental in the general theory of stochastic analysis. It is also very important in many applications, for example in economics (see Chapter 12).
Basically the Girsanov theorem says that if we change the drift coefficient of a given It^o process (with a nondegenerate diffusion coefficient), then the law of the process will not change dramatically. In fact, the law of the new process will be absolutely continuous w.r.t. the law of the original process and we can compute explicitly the Radon-Nikodym derivative.
We now make this precise. First we state (without proof) the useful L´evy characterization of Brownian motion. A proof can be found in e.g. Ikeda & Watanabe (1989), Theorem II.6.1, or in Karatzas & Shreve (1991), Theorem 3.3.16.

154 8. Other Topics in Diffusion Theory

Theorem 8.6.1 (The L´evy characterization of Brownian motion). Let X(t) = (X1(t), . . . , Xn(t)) be a continuous stochastic process on a probability space (, H, Q) with values in Rn. Then the following, a) and b), are equivalent

a) X(t) is a Brownian motion w.r.t. Q, i.e. the law of X(t) w.r.t. Q is the
same as the law of an n-dimensional Brownian motion.
b) (i) X(t) = (X1(t), . . . , Xn(t)) is a martingale w.r.t. Q (and w.r.t. its own filtration) and
(ii) Xi(t)Xj(t)-ijt is a martingale w.r.t. Q (and w.r.t. its own filtration) for all i, j  {1, 2, . . . , n}.

Remark. In this Theorem one may replace condition (ii) by the condition

(ii)' The cross-variation processes Xi, Xj t satisfy the identity

Xi, Xj t() = ijt a.s., 1  i, j  n

(8.6.1)

where

Xi, Xj

t=

1 4

[

Xi + Xj , Xi + Xj

t-

Xi - Xj , Xi - Xj

t] ,

(8.6.2)

Y, Y t being the quadratic variation process. (See Exercise 4.7.)

Next we need an auxiliary result about conditional expectation:
Lemma 8.6.2. Let µ and  be two probability measures on a measurable space (, G) such that d() = f ()dµ() for some f  L1(µ). Let X be a random variable on (, G) such that

E[|X|] = |X()|f ()dµ() <  .

Let H be a -algebra, H  G. Then

E [X|H] · Eµ[f |H] = Eµ[f X|H] a.s.

(8.6.3)

Proof. By the definition of conditional expectation (Appendix B) we have that if H  H then

E[X|H]f dµ = E[X|H]d = Xd

H

H

H

= Xf dµ = Eµ[f X|H]dµ

H

H

On the other hand, by Theorem B.3 (Appendix B) we have

(8.6.4)

8.6 The Girsanov Theorem 155

E [X|H]f dµ = Eµ[E [X|H]f · XH ] = Eµ[Eµ[E [X|H]f · XH |H]]
H

= Eµ[XH E [X|H] · Eµ[f |H]] = E [X|H] · Eµ[f |H]dµ .
H

(8.6.5)

Combining (8.6.4) and (8.6.5) we get

E [X|H] · Eµ[f |H]dµ = Eµ[f X|H]dµ .

N

H

Since this holds for all H  H, (8.6.3) follows.

We can now prove the first version of the Girsanov formula:

Theorem 8.6.3 (The Girsanov theorem I). Let Y (t)  Rn be an It^o process of the form

dY (t) = a(t, )dt + dB(t) ; t  T, Y0 = 0 .

where T   is a given constant and B(t) is n-dimensional Brownian motion. Put

t

t

Mt = exp -

a(s,

)dBs

-

1 2

a2(s, )ds ;

0

0

tT .

(8.6.6)

Assume that a(s, ) satisfies Novikov's condition

E exp

T

1 2

a2(s, )ds

0

<

(8.6.7)

where E = EP is the expectation w.r.t. P . Define the measure Q on (, FT(n)) by

dQ() = MT ()dP () .

(8.6.8)

Then Y (t) is an n-dimensional Brownian motion w.r.t. the probability law Q, for t  T .

Remarks.
(1) The transformation P  Q given by (8.6.9) is called the Girsanov transformation of measures.
(2) As pointed out in Exercise 4.4 the Novikov condition (8.6.7) is sufficient to guarantee that {Mt}tT is a martingale (w.r.t. Ft(n) and P ). Actually, the result holds if we only assume that {Mt}tT is a martingale. See Karatzas and Shreve (1991).

156 8. Other Topics in Diffusion Theory

(3) Note that since Mt is a martingale we actually have that

MT dP = MtdP

on Ft(n); t  T .

(8.6.9)

To see this, let f be a bounded Ft(n)-measurable function. Then by Theorem B.3 we have

f ()MT ()dP () = E[f MT ] = E[E[f MT |Ft]]

= E[f E[MT |Ft]] = E[f Mt] = f ()Mt()dP () .

Proof of Theorem 8.6.3. For simplicity we assume that a(s, ) is bounded. In view of Theorem 8.6.1 we have to verify that

(i)

Y (t) = (Y1(t), . . . , Yn(t)) is a martingale w.r.t. Q

(8.6.10)

and

(ii)

Yi(t)Yj(t) - ijt is a martingale w.r.t. Q,

for all i, j  {1, 2, . . . , n} .

(8.6.11)

To verify (i) we put K(t) = MtY (t) and use It^o's formula to get (see Exercises 4.3, 4.4)

dKi(t) = MtdYi(t) + Yi(t)dMt + dYi(t)dMt
n

= Mt(ai(t)dt + dBi(t)) + Yi(t)Mt

-ak (t)dBk (t)

k=1

n

+(dBi(t)) - Mt ak(t)dBk(t)

k=1

n
= Mt(dBi(t) - Yi(t) ak(t)dBk(t)) = Mt (i)(t)dB(t)

k=1

(8.6.12)

where (i)(t) = (1(i)(t), . . . , n(i)(t)), with

j(i)(t) =

-Yi (t)aj (t) 1 - Yi(t)ai(t)

for j = i for j = i .

Hence Ki(t) is a martingale w.r.t. P , so by Lemma 8.6.2 we get, for t > s,

EQ[Yi(t)|Fs]

=

E[MtYi(t)|Fs] E[Mt|Fs]

=

E[Ki(t)|Fs] Ms

=

Ki(s) Ms

= Yi(s) ,

which shows that Yi(t) is a martingale w.r.t. Q. This proves (i). The proof of (ii) is similar and is left to the reader.

8.6 The Girsanov Theorem 157

Remark. Theorem 8.6.3 states that for all Borel sets F1, . . . , Fk  Rn and all t1, t2, . . . , tk  T , k = 1, 2, . . . we have
Q[Y (t1)  F1, . . . , Y (tk)  Fk] = P [B(t1)  F1, . . . , B(tk)  Fk] (8.6.13)
An equivalent way of expressing (8.6.8) is to say that Q P (Q is absolutely continuous w.r.t. P ) with Radon-Nikodym derivative

dQ dP

=

MT

on FT(n) .

(8.6.14)

Note that MT () > 0 a.s., so we also have that P Q. Hence the two measures Q and P are equivalent. Therefore we get from (8.6.13)

P [Y (t1)  F1, . . . , Y (tk)  Fk] > 0  Q[Y (t1)  F1, . . . , Y (tk)  Fk] > 0  P [B(t1)  F1, . . . , B(tk)  Fk] > 0 ;

t1, . . . , tk  [0, T ]

Theorem 8.6.4 (The Girsanov theorem II). Let Y (t)  Rn be an It^o process of the form

(8.6.15)

dY (t) = (t, )dt + (t, )dB(t) ; t  T

(8.6.16)

where B(t)  Rm, (t, )  Rn and (t, )  Rn×m. Suppose there exist processes u(t, )  WHm and (t, )  WHn such that

(t, )u(t, ) = (t, ) - (t, )

(8.6.17)

and assume that u(t, ) satisfies Novikov's condition

T

E exp

1 2

u2(s, )ds

<.

(8.6.18)

0

Put

t

t

Mt = exp -

u(s,

)dBs

-

1 2

u2(s, )ds ;

0

0

tT

(8.6.19)

and Then

dQ() = MT ()dP () on FT(m) .

t
B(t): = u(s, )ds + B(t) ;

tT

(8.6.20) (8.6.21)

0

is a Brownian motion w.r.t. Q and in terms of B(t) the process Y (t) has the stochastic integral representation

dY (t) = (t, )dt + (t, )dB(t) .

(8.6.22)

158 8. Other Topics in Diffusion Theory

Proof. It follows from Theorem 8.6.3 that B(t) is a Brownian motion w.r.t. Q. So, substituting (8.6.21) in (8.6.16) we get, by (8.6.17),
dY (t) = (t, )dt + (t, )(dB(t) - u(t, )dt) = [(t, ) - (t, )u(t, )]dt + (t, )dB(t) = (t, )dt + (t, )dB(t) .

Note that if n = m and   Rn×n is invertible, then the process u(t, ) satisfying (8.6.17) is given uniquely by

u(t, ) = -1(t, )[(t, ) - (t, )] .

(8.6.23)

Finally we formulate a diffusion version:
Theorem 8.6.5 (The Girsanov theorem III). Let X(t) = Xx(t)  Rn and Y (t) = Y x(t)  Rn be an It^o diffusion and an It^o process, respectively, of the forms

dX(t) = b(X(t))dt + (X(t))dB(t) ; t  T, X(0) = x

(8.6.24)

dY (t) = [(t, ) + b(Y (t))]dt + (Y (t))dB(t) ; t  T, Y (0) = x (8.6.25)

where the functions b: Rn  Rn and : Rn  Rn×m satisfy the conditions of Theorem 5.2.1 and (t, )  WHn , x  Rn. Suppose there exists a process u(t, )  WHm such that

(Y (t))u(t, ) = (t, )

(8.6.26)

and assume that u(t, ) satisfies Novikov's condition

E exp

T

1 2

u2(s, )ds

0

<.

(8.6.27)

Define Mt, Q and B(t) as in (8.6.19), (8.6.20) and (8.6.21). Then

dY (t) = b(Y (t))dt + (Y (t))dB(t) .

(8.6.28)

Therefore,

the Q-law of Y x(t) is the same as the P -law of Xx(t); t  T .

(8.6.29)

Proof. The representation (8.6.28) follows by applying Theorem 8.6.4 to the case (t, ) = (Y (t)), (t, ) = (t, )+b(Y (t)), (t, ) = b(Y (t)). Then the conclusion (8.6.29) follows from the weak uniqueness of solutions of stochastic differential equations (Lemma 5.3.1).

8.6 The Girsanov Theorem 159

The Girsanov theorem III can be used to produce weak solutions of
stochastic differential equations. To illustrate this, suppose Yt is a known weak or strong solution to the equation

dYt = b(Yt)dt + (Yt)dB(t)
where b: Rn  Rn, : Rn  Rn×m and B(t)  Rm. We wish to find a weak solution X(t) of a related equation

dXt = a(Xt)dt + (Xt)dB(t)

(8.6.30)

where the drift function is changed to a: Rn  Rn. Suppose we can find a function u0: Rn  Rm such that

(y)u0(y) = b(y) - a(y) ; y  Rn .

(If n = m and  is invertible we choose

u0 = -1 · (b - a) .)

Then if u(t, ) = u0(Yt()) satisfies Novikov's conditions, we have, with Q and Bt = B(t) as in (8.6.20) and (8.6.21), that

dYt = a(Yt)dt + (Yt)dBt .

(8.6.31)

Thus we have found a Brownian motion (Bt, Q) such that Yt satisfies (8.6.31). Therefore (Yt, Bt) is a weak solution of (8.6.30).

Example 8.6.6. Let a: Rn  Rn be a bounded, measurable function. Then

we can construct a weak solution Xt = Xtx of the stochastic differential

equation

dXt = a(Xt)dt + dBt ; X0 = x  Rn .

(8.6.32)

We proceed according to the procedure above, with  = I, b = 0 and

Choose and define
i.e.

dYt = dBt ; Y0 = x .

u0 = -1 · (b - a) = -a

Mt = exp

t

t

-

u0(Ys)dBs

-

1 2

u02(Ys)ds

0

0

t

t

Mt = exp

a(Bs)dBs

-

1 2

a2(Bs)ds .

0

0

160 8. Other Topics in Diffusion Theory

Fix T <  and put

dQ = MT dP

on FT(m) .

Then
t

Bt: = - a(Bs)ds + Bt

0

is a Brownian motion w.r.t. Q for t  T and

dBt = dYt = a(Yt)dt + dBt .

Hence if we set Y0 = x the pair (Yt, Bt) is a weak solution of (8.6.32) for t  T . By weak uniqueness the Q-law of Yt = Bt coincides with the P -law of Xtx, so that

E[f1(Xtx1 ) . . . fk(Xtxk )] = EQ[f1(Yt1 ) . . . fk(Ytk )] = E[MT f1(Bt1 ) . . . fk(Btk )]

(8.6.33)

for all f1, . . . , fk  C0(Rn); t1, . . . , tk  T .

Exercises

8.1. Let  denote the Laplace operator on Rn. a) Write down (in terms of Brownian motion) a bounded solution g of the Cauchy problem

g(t, t

x)

-

1 2

xg(t,

x)

=

0

for t > 0, x  Rn

g(0, x) = (x)

where   C02 is given. (From general theory it is known that the solution is unique.)

b) Let   Cb(Rn) and  > 0. Find a bounded solution u of the

equation

(

-

1 2

)u

=



in Rn .

Prove that the solution is unique.

8.2. Show that the solution u(t, x) of the initial value problem

u t

=

1 2

2x2

 

2u x2

+



x

u x

;

t > 0, x  R

u(0, x) = f (x) (f  C02(R) given)

can be expressed as follows:

Exercises 161

u(t,

x)

=

E[f (x

·

exp{Bt

+

(

-

1 2

2)t}]

= 1 2t

f (x

·

exp{y

+

(

-

1 2



2

)t}

exp

-

y2 2t

dy ;

R

t>0.

8.3. (Kolmogorov's forward equation) Let Xt be an It^o diffusion in Rn with generator

Af (y) =

i,j

aij

(y)



2f yiyj

+

i

bi(y)

f yi

;

f  C02

and assume that the transition measure of Xt has a density pt(x, y), i.e. that

Ex[f (Xt)] = f (y)pt(x, y)dy ;
Rn

f  C02 .

(8.6.34)

Assume that y  pt(x, y) is smooth for each t, x. Prove that pt(x, y) satisfies the Kolmogorov forward equation

d dt

pt(x,

y)

=

Ay pt (x,

y)

for all x, y ,

where Ay operates on the variable y and is given by

(8.6.35)

Ay(y) =

i,j



2 yi

yj

(aij

)

-

i

 yi

(bi)

;

  C2 (8.6.36)

(i.e. Ay is the adjoint of Ay.) (Hint: By (8.6.34) and Dynkin's formula we have

t

f (y)pt(x, y)dy = f (x) +

Ayf (y)ps(x, y)dy ds ;

Rn

0 Rn

Now differentiate w.r.t. t and use that

f  C02 .

A,  = , A

for   C02,   C2 ,

where ·, · denotes inner product in L2(dy).) 8.4. Let Bt be n-dimensional Brownian motion (n  1) and let F be a
Borel set in Rn. Prove that the expected total length of time t that Bt stays in F is zero if and only if the Lebesgue measure of F is zero. Hint: Consider the resolvent R for  > 0 and then let   0.
8.5. Show that the solution u(t, x) of the initial value problem

162 8. Other Topics in Diffusion Theory

u t

=

u+

1 2

u

t

>

0

;

x  Rn

u(0, x) = f (x) (f  C02(Rn) given)

(where   R is a constant) can be expressed by

u(t, x) = (2t)-n/2 exp(t)

f (y) exp

-

(x

- y)2 2t

dy .

Rn

8.6. In connection with the deduction of the Black & Scholes formula for the price of an option (see Chapter 12) the following partial differential equation appears:

u t

=

-

u

+

x

u x

+

1 2



2

x2

 

2u x2

;

t>0,

xR

u(0, x) = (x - K)+ ;

xR,

where  > 0, ,  and K > 0 are constants and

(x - K)+ = max(x - K, 0) .

Use the Feynman-Kac formula to prove that the solution u of this equation is given by

u(t, x) = e-t 2t

(x

·

exp{(

-

1 2

2)t

+

y}

-

K

)+

e-

y2 2t

dy

;

R

t>0.

(This expression can be simplified further. See Exercise 12.13.)

8.7. Let Xt be a sum of It^o integrals of the form

nt

Xt =

vk(s, )dBk(s) ,

k=1 0

where (B1, . . . , Bn) is n-dimensional Brownian motion. Assume that

tn

t: =

vk2(s, )ds  

0 k=1

as t  , a.s.

Prove that

lim sup  Xt

= 1 a.s.

t 2t log log t

(Hint: Use the law of iterated logarithm.) 8.8. Let Zt be a 1-dimensional It^o process of the form

dZt = u(t, )dt + dBt .

Exercises 163

Let Gt be the -algebra generated by {Zs(·); s  t} and define

dNt = (u(t, ) - E[u|Gt])dt + dBt .

Use Corollary 8.4.5 to prove that Nt is a Brownian motion. (If we interpret Zt as the observation process, then Nt is the innovation process. See Lemma 6.2.6.)

8.9.

Define

(t)

=

1 2

ln(1

+

2 3

t3).

If

Bt

is

a

Brownian

motion,

prove

that

there exists another Brownian motion Br such that

t

t

esdBs = rdBr .

0

0

8.10. Let Bt be a Brownian motion in R. Show that

Xt: = Bt2

is a weak solution of the stochastic differential equation

dXt = dt + 2 |Xt|dBt .

(8.6.37)

(Hint: Use It^o's formula to express Xt as a stochastic integral and compare with (8.6.37) by using Corollary 8.4.5.)
8.11. a) Let Y (t) = t + B(t); t  0 . For each T > 0 find a probability measure QT on FT such that QT  P and {Y (t)}tT is Brownian motion w.r.t. QT . Use (8.6.9) to prove that there exists a probability measure Q on F such that

Q|FT = QT for all T > 0 .

b) Show that

P lim Y (t) =  = 1
t

while

Q lim Y (t) =  = 0 .
t

Why does not this contradict the Girsanov theorem?

8.12. Let

dY (t) =

0 1

dt +

1 -1

3 -2

dB1(t) dB2(t)

;

tT .

Find a probability measure Q on FT(2) such that Q  P and such that

dY (t) =

1 -1

3 -2

dB1(t) dB2(t)

164 8. Other Topics in Diffusion Theory

where

B(t): =

-3t t

+

B1(t) B2(t)

is a Brownian motion w.r.t. Q.

8.13. Let b: R  R be a Lipschitz-continuous function and define Xt = Xtx  R by

dXt = b(Xt)dt + dBt, X0 = x  R .

a) Use the Girsanov theorem to prove that for all M < , x  R and t > 0 we have P [Xtx  M ] > 0 .
b) Choose b(x) = -r where r > 0 is constant. Prove that for all x

Xtx  - as t   a.s.

Compare this with the result in a). 8.14. (Polar sets for the graph of Brownian motion)
Let Bt be 1-dimensional Brownian motion starting at x  R. a) Prove that for every fixed time t0 > 0 we have
P x[Bt0 = 0] = 0 .
b) Prove that for every (non-trivial) closed interval J  R+ we have

P x[t  J such that Bt = 0] > 0 .

(Hint: If J = [t1, t2] consider P x[Bt1 < 0 & Bt2 > 0] and then use the intermediate value theorem.) c) In view of a) and b) it is natural to ask what closed sets F  R+
have the property that

P x[t  F such that Bt = 0] = 0 .

(8.6.38)

To investigate this question more closely we introduce the graph Xt of Brownian motion, given by

dXt =

1 0

dt +

0 1

dBt ;

X0 =

t0 x0

i.e.

Xt = Xtt0,x0 =

t0 + t Btx0

where B0x0 = x0 a.s.

Then F satisfies (8.6.38) iff K: = F × {0} polar for Xt, in the sense that

Exercises 165

P t0,x0 [t > 0 ; Xt  K] = 0 for all t0, x0 .

(8.6.39)

The key to finding polar sets for a diffusion is to consider its Green

operator R, which is simply the resolvent R with  = 0 :



Rf (t0, x0) = Et0,x0 f (Xs)ds

for f  C0(R2) .

t0

Show that

Rf (t0, x0) = G(t0, x0; t, x)f (t, x)dt dx ,

R2
where

G(t0, x0; t, x) =

Xt>t0

·

(2(t

-

t0

))-

1 2

exp

-

|x - x0|2 2(t - t0)

(8.6.40)

(G is the Green function of Xt.) d) The capacity of K, C(K) = CG(K), is defined by

C(K) = sup{µ(K); µ  MG(K)} ,

where MG(K) = {µ; µ measure on K s.t. G(t0, x0; t, x)dµ(t, x)  1
K
for all t0, x0}. A general result from stochastic potential theory states that

P t0,x0 [Xt hits K] = 0  C(K) = 0 .

(8.6.41)

See e.g. Blumenthal and Getoor (1968, Prop. VI.4.3). Use this to prove that

 1 (F ) = 0  P x0 [t  F 2

such that Bt = 0] = 0 ,

where  1 denotes 1/2-dimensional Hausdorff measure (Folland 2
(1984, §10.2)).

8.15. Let f  C02(Rn) and (x) = (1(x), . . . , n(x)) with i  C02(Rn) be

given functions and consider the partial differential equation

  

n

u t

=

i(x)

i=1

u(0, x) = f (x)

u xi
;

+

n 1 2
i=1

2u  x2i

;

t > 0, x  Rn x  Rn .

a) Use the Girsanov theorem to show that the unique bounded solution u(t, x) of this equation can be expressed by

t

t

u(t, x) = Ex exp

(Bs)dBs

-

1 2

2(Bs)ds f (Bt) ,

0

0

where Ex is the expectation w.r.t. P x.

166 8. Other Topics in Diffusion Theory

b) Now assume that  is a gradient, i.e. that there exists   C1(Rn) such that  =  .
Assume for simplicity that   C02(Rn). Use It^o's formula to prove that (see Exercise 4.8)

t

u(t, x) = exp

- (x))Ex

exp

-

1 2

(2(Bs)

0

+(Bs) ds exp((Bt))f (Bt) .

c) Put v(t, x) = exp((x))u(t, x). Use the Feynman-Kac formula to show that v(t, x) satisfies the partial differential equation

v t

=

-

1 2

(

2

+

)

·

v

+

1 2

v

;

t > 0;

x  Rn

v(0, x) = exp((x))f (x) ;

x  Rn .

(See also Exercise 8.16.)

8.16. (A connection between B.m. with drift and killed B.m.) Let Bt denote Brownian motion in Rn and consider the diffusion Xt in Rn defined by

dXt = h(Xt)dt + dBt ; X0 = x  Rn .

(8.6.42)

where h  C01(Rn). a) There is an important connection between this process and the
process Yt obtained by killing Bt at a certain rate V . More precisely, first prove that for f  C0(Rn) we have

t
Ex[f (Xt)] = Ex exp - V (Bs)ds · exp(h(Bt) - h(x)) · f (Bt) ,

0
(8.6.43)

where

V

(x)

=

1 2

|h(x)|2

+

1 2

h(x)

.

(8.6.44)

(Hint: Use the Girsanov theorem to express the left hand side of

(8.6.43) in terms of Bt. Then use the It^o formula on Zt = h(Bt) to

achieve (8.6.44).)

b) Then use the Feynman-Kac formula to restate (8.6.43) as follows

(assuming V  0):

TtX (f, x) = exp(-h(x)) · TtY (f · exp h, x) , where TtX , TtY denote the transition operators of the processes X and Y , respectively, i.e.

TtX (f, x) = Ex[f (Xt)] and similarly for Y .

9. Applications to Boundary Value Problems

9.1 The Combined Dirichlet-Poisson Problem. Uniqueness

We now use results from the preceding chapters to solve the following gener-
alization of the Dirichlet problem stated in the introduction: Let D be a domain (open connected set) in Rn and let L denote a semi-
elliptic partial differential operator on C2(Rn) of the form

L

=

n i=1

bi(x)

 xi

+

n i,j=1

aij

(x)

2 xi

xj

(9.1.1)

where bi(x) and aij(x) = aji(x) are continuous functions (see below). (By saying that L is semi-elliptic (resp. elliptic) we mean that all the eigenvalues of the symmetric matrix a(x) = [aij(x)]in,j=1 are non-negative (resp. positive) for all x.)

The Combined Dirichlet-Poisson Problem

Let   C(D) and g  C(D) be given functions. Find w  C2(D) such that

(i) Lw = -g in D

(9.1.2)

and

(ii) lim w(x) = (y) for all y  D . xy xD

(9.1.3)

The idea of the solution is the following: First we find an It^o diffusion {Xt} whose generator A coincides with L on C02(Rn). To achieve this we simply choose (x)  Rn×n such that

1 2

(x)T

(x)

=

[aij (x)]

.

(9.1.4)

We assume that (x) and b(x) = [bi(x)] satisfy conditions (5.2.1) and (5.2.2) of Theorem 5.2.1. (For example, if each aij  C2(D) is bounded and has bounded first and second partial derivatives, then such a square root  can
be found. See Fleming and Rishel (1975).) Next we let Xt be the solution of

168 9. Applications to Boundary Value Problems

dXt = b(Xt)dt + (Xt)dBt

(9.1.5)

where Bt is n-dimensional Brownian motion. As usual we let Ex denote expectation with respect to the probability law Qx of Xt starting at x  Rn. Then our candidate for the solution w of (9.1.2), (9.1.3) is

w(x) = Ex[(XD ) · X{D <}] + Ex

D
g(Xt)dt
0

(9.1.6)

provided that  is bounded and

D
Ex |g(Xt)|dt < 
0

for all x .

(9.1.7)

The Dirichlet-Poisson problem consists of two parts:

(i) Existence of solution. (ii) Uniqueness of solution.

The uniqueness problem turns out to be simpler and therefore we handle this first. In this section we prove two easy and useful uniqueness results. Then in the next sections we discuss the existence of solution and other uniqueness questions.

Theorem 9.1.1 (Uniqueness theorem (1)). Suppose  is bounded and g satisfies (9.1.7). Suppose w  C2(D) is bounded
and satisfies

(i)

Lw = -g in D

(9.1.8)

and

(ii)' Then

limtD w(Xt) = (XD ) · X{D <}

a.s. Qx for all x . (9.1.9)

D
w(x) = Ex[(XD ) · X{D <}] + Ex g(Xt)dt .
0

(9.1.10)

Proof.

Let

{Dk

}k=1

be


an

increasing

sequence

of

open

sets

Dk

such

that

Dk  D and D = Dk. Define

k=1

k = k  Dk ; k = 1, 2, . . .

Then by the Dynkin formula and (9.1.8)

9.2 The Dirichlet Problem. Regular Points 169

k
w(x) = Ex[w(Xk )] - Ex Lw(Xt)dt

0 k
= Ex[w(Xk )] + Ex g(Xt)dt .

(9.1.11)

0

By (9.1.9) w(Xk )  (XD ) · X{D <} pointwise boundedly a.s. Qx. Hence

Ex[w(Xk )]  Ex[(XD ) · X{D <}]

as k   .

(9.1.12)

Moreover,

k

D

Ex g(Xt)dt  Ex g(Xt)dt

as k   ,

(9.1.13)

0

0

since

k

D

g(Xt)dt  g(Xt)dt a.s.

0

0

and

k

D

g(Xt)dt  |g(Xt)|dt , which is Qx-integrable by (9.1.7).

0

0

Combining (9.1.12) and (9.1.13) with (9.1.11) we get (9.1.10).

An immediate consequence is:

Corollary 9.1.2 (Uniqueness theorem (2)). Suppose  is bounded and g satisfies (9.1.7). Suppose

D <  a.s. Qx for all x .

(9.1.14)

Then if w  C2(D) is a bounded solution of the combined Dirichlet-Poisson problem (9.1.2), (9.1.3) we have

D
w(x) = Ex[(XD )] + Ex g(Xt)dt .
0

(9.1.15)

9.2 The Dirichlet Problem. Regular Points
We now consider the more complicated question of existence of solution. It is convenient to split the combined Dirichlet-Poisson problem in two parts: The Dirichlet problem and the Poisson problem:

170 9. Applications to Boundary Value Problems

The Dirichlet Problem
Let   C(D) be a given function. Find u  C2(D) such that (I) Lu = 0 in D and (II) lim u(x) = (y) for all y  D .
xy xD

(9.2.1) (9.2.2)

The Poisson Problem

Let g  C(D) be a given function. Find v  C2(D) such that

(a) Lv = -g in D

(9.2.3)

and

(b) lim v(x) = 0 for all y  D . xy xD

(9.2.4)

Note that if u and v solve the Dirichlet and the Poisson problem, respectively, then w: = u + v solves the combined Dirichlet-Poisson problem.
We first consider the Dirichlet problem and proceed to study the Poisson problem in the next section.
For simplicity we assume in this section that (9.1.14) holds.

In view of Corollary 9.1.2 the question of existence of a solution of the Dirichlet problem (9.2.1), (9.2.2) can be restated as follows: When is

u(x): = Ex[(XD )]

(9.2.5)

a solution? Unfortunately, in general this function u need not be in C2(U ). In fact,
it need not even be continuous. Moreover, it need not satisfy (9.2.2), either.
Consider the following example:

Example 9.2.1. Let X(t) = (X1(t), X2(t)) be the solution of the equations

dX1(t) = dt dX2(t) = 0

so that X(t) = X(0) + t(1, 0)  R2; t  0. Let

D

=

((0,

1)

×

(0,

1))



((0,

2)

×

(0,

1 2

))

and let  be a continuous function on D such that

=1 =0 =0

on

{1}

×

[

1 2

,

1]

and

on

{2}

×

[0,

1 2

]

on {0} × [0, 1] .

9.2 The Dirichlet Problem. Regular Points 171

Then

 1 u(t, x) = Et,x[(XD )] =  0

if

x



(

1 2

,

1)

if

x



(0,

1 2

)

,

so u is not even continuous. Moreover,

lim u(t, x) = 1 = (0, x)
t0+

if

1 2

<

x

<

1

so (9.2.2) does not hold. However, the function u(x) defined by (9.2.5) will solve the Dirichlet prob-
lem in a weaker, stochastic sense: The boundary condition (9.2.2) is replaced by the stochastic (pathwise) boundary condition (9.1.9) and the condition (9.2.1) (Lu = 0) is replaced by a condition related to the condition

Au = 0

where A is the characteristic operator of Xt (Section 7.5).
We now explain this in more detail:
Definition 9.2.2. Let f be a locally bounded, measurable function on D. Then f is called X-harmonic in D if

f (x) = Ex[f (XU )]
for all x  D and all bounded open sets U with U  D.
We make two important observations:
Lemma 9.2.3. a) Let f be X-harmonic in D. Then Af = 0 in D. b) Conversely, suppose f  C2(D) and Af = 0 in D. Then f is X-harmonic.
Proof. a) follows directly from the formula for A. b) follows from the Dynkin formula: Choose U as in Definition 9.2.2. Then

172 9. Applications to Boundary Value Problems

Ex[f (XU )]

=

lim
k

E

x

[f

(XU

k

)]

U k

= f (x) + lim Ex
k

(Lf )(Xs)ds

0

= f (x) ,

since Lf = Af = 0 in U .

The most important examples of X-harmonic functions are given in the next result:

Lemma 9.2.4. Let  be a bounded measurable function on D and put

u(x) = Ex[(XD )] ;

xD.

Then u is X-harmonic. Thus, in particular, Au = 0.

Proof. From the mean value property (7.2.9) we have, if V  D

u(x) = u(y)Qx[XV  dy] = Ex[u(XV )] .
V

We are now ready to formulate the weak, stochastic version:

The Stochastic Dirichlet Problem

Given a bounded measurable function  on D, find a function u on D such that

(i)s u is X-harmonic

(ii)s

lim
tD

u(Xt)

=

(XD

)

a.s. Qx, x  D .

(9.2.6) (9.2.7)

We first solve the stochastic Dirichlet problem (9.2.6), (9.2.7) and then relate it to the original problem (9.2.1), (9.2.2).

Theorem 9.2.5 (Solution of the stochastic Dirichlet problem). Let  be a bounded measurable function on D.

a) (Existence) Define

u(x) = Ex[(XD )] .

Then u solves the stochastic Dirichlet problem (9.2.6), (9.2.7). b) (Uniqueness) Suppose g is a bounded function on D such that

(1) g is X-harmonic

(2)

lim
tD

g(Xt)

=

(XD

)

a.s.

Qx,

x



D.

Then g(x) = Ex[(XD )], x  D.

(9.2.8)

9.2 The Dirichlet Problem. Regular Points 173

Proof. a) It follows from Lemma 9.2.4 that (i)s holds. Fix x  D. Let {Dk}
be an increasing sequence of open sets such that Dk  D and D = Dk.
k
Put k = Dk ,  = D . Then by the strong Markov property

u(Xk ) = EXk [(X )] = Ex[k ((X ))|Fk ] = Ex[(X )|Fk ] .

(9.2.9)

Now Mk = Ex[(X )|Fk ] is a bounded (discrete time) martingale so by the martingale convergence theorem Corollary C.9 (Appendix C) we get that

lim
k

u(Xk

)

=

lim
k

Ex[(X

)|Fk ]

=

(X

)

(9.2.10)

both pointwise for a.a.  and in Lp(Qx), for all p < . Moreover, by (9.2.9) it follows that for each k the process

Nt = u(Xk(tk+1)) - u(Xk ) ;

t0

is a martingale w.r.t. Gt = Fk(tk+1). So by the martingale inequality

Qx sup |u(Xr) - u(Xk )| >
k rk+1



1
2

E x [|u(Xk+1

)

-

u(Xk

)|2]

 0 as k  , for all > 0 .

(9.2.11)

From (9.2.10) and (9.2.11) we conclude that (ii)s holds. b) Let Dk, k be as in a). Then since g is X-harmonic we have
g(x) = Ex[g(Xk )] for all k. So by (2) and bounded convergence

g(x)

=

lim
k

Ex[g(Xk

)]

=

Ex[(XD

)]

,

as asserted .

Finally we return to the original Dirichlet problem (9.2.1), (9.2.2). We have already seen that a solution need not exist. However, it turns out that for a large class of processes Xt we do get a solution (for all D) if we reduce the requirement in (9.2.2) to hold only for a subset of the boundary points y  D called the regular boundary points. Before we define regular points and state the result precisely, we need the following auxiliary lemmas:
(As before we let Mt and M denote the -algebras generated by Xs; s  t and by Xs; s  0 respectively).
Lemma 9.2.6 (The 0­1 law). Let H  Mt. Then either Qx(H) = 0
t>0
or Qx(H) = 1.

174 9. Applications to Boundary Value Problems

Proof. From the strong Markov property (7.2.5) we have Ex[t|Mt] = EXt []
for all bounded, M-measurable :   R. This implies that

t · dQx = EXt []dQx ,

H

H

for all t .

First assume that  = k = g1(Xt1 ) · · · gk(Xtk ), where each gi is bounded and continuous. Then letting t  0 we obtain

dQx = lim
t0

tdQx

=

lim
t0

EXt []dQx = Qx(H)Ex[]

H

H

H

by Feller continuity (Lemma 8.1.4) and bounded convergence. Approximating the general  by functions k as above we conclude that

dQx = Qx(H)Ex[]
H
for all bounded M-measurable . If we put  = XH we obtain Qx(H) = (Qx(H))2, which completes the proof.

Corollary 9.2.7. Let y  Rn. Then

either Qy[D = 0] = 0 or Qy[D = 0] = 1 .

Proof. H = {; D = 0}  Mt .
t>0
In other words, either a.a. paths Xt starting from y stay within D for a positive period of time or a.a. paths Xt starting from y leave D immediately. In the last case we call the point y regular, i.e.

Definition 9.2.8. A point y  D is called regular for D (w.r.t. Xt) if Qy[D = 0] = 1 .

Otherwise the point y is called irregular.

Example 9.2.9. Corollary 9.2.7 may seem hard to believe at first glance. For

example, if Xt is a 2-dimensional Brownian motion Bt and D is the square

[0,

1]

×

[0,

1]

one

might

think

that,

starting

from

(

1 2

,

0),

say,

half

of

the

paths

will stay in the upper half plane and half in the lower, for a positive period of

time. However, Corollary 9.2.7 says that this is not the case: Either they all

stay in D initially or they all leave D immediately. Symmetry considerations

9.2 The Dirichlet Problem. Regular Points 175

imply

that

the

first

alternative

is

impossible.

Thus

(

1 2

,

0),

and

similarly

all

the other points of D, are regular for D w.r.t. Bt.

Example 9.2.10. Let D = [0, 1]×[0, 1] and let L be the parabolic differential

operator

Lf (t, x)

=

f t

+

1 2

·

2f x2

;

(t, x)  R2 .

(See Example 7.3.5)

Here

b=

1 0

and

a

=

[aij ]

=

1 2

00 01

.

So, for example, if we choose  =

0 1

0 0

, we have

1 2

T

=

a.

This

gives

the

following stochastic differential equation for the It^o diffusion Xt associated

with L:

dXt =

1 0

dt +

0 1

0 0

dBt(1) dBt(2)

.

In other words,

Xt =

t + t0 Bt

,

X0 =

t0 x

where Bt is 1-dimensional Brownian motion. So we end up with the graph of Brownian motion, which we started with in Example 7.3.5. In the case it

is not hard to see that the irregular points of D consist of the open line

{0} × (0, 1), the rest of the boundary points being regular.

176 9. Applications to Boundary Value Problems

Example 9.2.11. Let  = {(x, y); x2 + y2 < 1}  R2 and let {n} be a sequence of disjoint open discs in  centered at (2-n, 0), respectively,

n = 1, 2, . . . . Put



D = \

n .

n=1


Then it is easy to see that all the points of   n are regular for
n=1
D w.r.t. 2-dimensional Brownian motion Bt, using a similar argument as in Example 9.2.9. But what about the point 0? The answer depends on the sizes
of the discs n. More precisely, if rn is the radius of n then 0 is a regular point for D if and only if

n

n=1

log

1 rn

=.

(9.2.12)

This is a consequence of the famous Wiener criterion. See Port and Stone (1979), p. 225.

Having defined regular points we now formulate the announced generalized version of the Dirichlet problem:

The Generalized Dirichlet Problem

Given a domain D  Rn and L and  as before, find a function u  C2(D) such that

(i) Lu = 0 in D

(9.2.13)

and

(ii) lim u(x) = (y) for all regular y  D . xy xD

(9.2.14)

9.2 The Dirichlet Problem. Regular Points 177

First we establish that if a solution of this problem exists, it must be the solution of the stochastic Dirichlet problem found in Theorem 9.2.5, provided that Xt satisfies Hunt's condition (H):

(H): Every semipolar set for Xt is polar for Xt .

(9.2.15)

A semipolar set is a countable union of thin sets and a measurable set G  Rn is called thin (for Xt) if Qx[TG = 0] = 0 for all x, where TG = inf{t > 0; Xt  G} is the first hitting time of G. (Intuitively: For all starting points the process does not hit G immediately, a.s). A measurable set F  Rn is called polar (for Xt) if Qx[TF < ] = 0 for all x. (Intuitively: For all starting points the process never hits F , a.s.). Clearly every polar set is semipolar,
but the converse need not to be true (consider the process in Example 9.2.1).
However, condition (H) does hold for Brownian motion (See Blumenthal and
Getoor (1968)). It follows from the Girsanov theorem that condition (H) holds
for all It^o diffusions whose diffusion coefficient matrix has a bounded inverse
and whose drift coefficient satisfies the Novikov condition for all T < .
We also need the following result, the proof of which can be found in
Blumenthal and Getoor (1968, Prop. II.3.3):

Lemma 9.2.12. Let U  D be open and let I denote the set of irregular points of U . Then I is a semipolar set.

Theorem 9.2.13. Suppose Xt satisfies Hunt's condition (H). Let  be a bounded continuous function on D. Suppose there exists a bounded u  C2(D) such that

(i) Lu = 0 in D

(ii)s

lim u(x) = (y) for all regular y  D
xy

xD

Then u(x) = Ex[(XD )].

Proof. Let {Dk} be as in the proof Theorem 9.1.1. By Lemma 9.2.3 b) u is X-harmonic and therefore

u(x) = Ex[u(Xk )] for all x  Dk and all k .

If k   then Xk  From the Lemma 9.2.12

wXeDknaowndthsoatut(hXe ske)t

I of (irXreDgu)laifr

XpoDintiss

regular. of D is

semipolar. So Qx. Hence

by

condition

(H)

the

set

I

is

polar

and

therefore

XD

/

I

a.s.

u(x) = lim Ex[u(Xk )] = Ex[(XD )] , as claimed .

Under what conditions is the solution u of the stochastic Dirichlet problem (9.2.6), (9.2.7) also a solution of the generalized Dirichlet problem (9.2.13), (9.2.14)? This is a difficult question and we will content ourselves with the following partial answer:

178 9. Applications to Boundary Value Problems

Theorem 9.2.14. Suppose L is uniformly elliptic in D, i.e. the eigenvalues of [aij] are bounded away from 0 in D. Let  be a bounded continuous function on D. Put
u(x) = Ex[(XD )] .
Then u  C2+(D) for all  < 1 and u solves the Dirichlet problem (9.2.13), (9.2.14), i.e.

(i) Lu = 0 in D.

(ii)r

lim u(x) = (y) for all regular y  D .
xy

xD

Remark. If k is an integer,  > 0 and G is an open set Ck+(G) denotes the set of functions on G whose partial derivatives up to k'th order is Lipschitz (H¨older) continuous with exponent .

Proof. Choose an open ball  with   D and let f  C(). Then, from
the general theory of partial differential equations, for all  < 1 there exists a continuous function u on  such that u|  C2+() and

Lu = 0 in  u = f on 

(9.2.16) (9.2.17)

(see e.g. Dynkin (1965 II, p. 226)). Since u|  C2+() we have: If K is
any compact subset of  there exists a constant C only depending on K and the C-norms of the coefficients of L such that

u C2+(K)  C( Lu C() + u C()) .

(9.2.18)

(See Bers, John and Schechter (1964, Theorem 3, p. 232).) Combining (9.2.16), (9.2.17) and (9.2.18) we obtain

u C2+(K)  C f C() . By uniqueness (Theorem 9.2.13) we know that

(9.2.19)

u(x) = f (y)dµx(y) ,

(9.2.20)

where dµx = Qx[X  dy] is the first exit distribution of Xt from . From (9.2.19) it follows that

f dµx1 - f dµx2  C f C()|x1 - x2| ; x1, x2  K . (9.2.21)

By approximating a given continuous function on  uniformly by functions in C() we see that (9.2.21) holds for all functions f  C(). Therefore

µx1 - µx2  C|x1 - x2| ;

x1, x2  K

(9.2.22)

9.2 The Dirichlet Problem. Regular Points 179

where denotes the operator norm on measures on . So if g is any bounded measurable function on  we know that the function

g(x) = g(y)dµx(y) = Ex[g(X )]

belongs to the class C(K). Since u(x) = Ex[u(XU )] for all open sets U with U  D and x  U (Lemma 9.2.4) this applies to g = u and we conclude that u  C(M ) for any compact subset M of D.
We may therefore apply the solution to the problem (9.2.16), (9.2.17) once
more, this time with f = u and this way we obtain that

u(x) = Ex[u(XD )] belongs to C2+(M )
for any compact M  D. Therefore (i) holds by Lemma 9.2.3 a). To obtain (ii)r we apply a theorem from the theory of parabolic differential
equations: The Kolmogorov backward equation

Lv

=

v t

has a fundamental solution v = p(t, x, y) jointly continuous in t, x, y for t > 0 and bounded in x, y for each fixed t > 0 (See Dynkin (1965 II), Theorem 0.4 p. 227). It follows (by bounded convergence) that the process Xt is a strong Feller process, in the sense that the function

x  Ex[f (Xt)] = f (y)p(t, x, y)dy
Rn
is continuous, for all t > 0 and all bounded, measurable functions f . In general we have:

If Xt is a strong Feller It^o diffusion and D  Rn is open then

lim
xy

Ex[(XD

)]

=

(y)

xD

for all regular y  D and bounded   C(D) .

(9.2.23)

(See Theorem 13.3 p. 32­33 in Dynkin (1965 II)). Therefore u satisfies property (ii)r and the proof is complete.
Example 9.2.15. We have already seen (Example 9.2.1) that condition (9.1.3) does not hold in general. This example shows that it need not hold even when L is elliptic: Consider Example 9.2.11 again, in the case when the point 0 is not regular. Choose   C(D) such that

(0) = 1, 0  (y) < 1 for y  D \ {0} .

Since {0} is polar for Bt (see Exercise 9.7 a) we have B0D = 0 a.s and therefore

180 9. Applications to Boundary Value Problems

u(0) = E0[(BD )] < 1 .

By a slight extension of the mean value property (7.2.9) (see Exercise 9.4)

we get

E0[u(Xk )] = E0[(XD )] = u(0) < 1

(9.2.24)

where

k = inf

t > 0; Bt / D 

|x|

<

1 k

,

k = 1, 2, . . .

This implies that it is impossible that u(x)  1 as x  0. Therefore (9.1.3) does not hold in this case.

In general one can show that the regular points for Brownian motion are exactly the regular points in the classical potential theoretic sense, i.e. the points y on D where the limit of the generalized Perron-Wiener-Brelot solution coincide with (y), for all   C(D). See Doob (1984), Port and Stone (1979) or Rao (1977).

Example 9.2.16. Let D denote the infinite strip

D = {(t, x)  R2; x < R} , where R  R

and let L be the differential operator

Lf (t, x)

=

f t

+

1 2f 2 x2

;

f  C2(D) .

An It^o diffusion whose generator coincides with L on C02(R2) is (see Example 9.2.10)
Xt = (s + t, Bt) ; t  0 ,
and all the points of D are regular for this process. It is not hard to see that in this case (9.1.14) holds, i.e.

D <  a.s.

9.3 The Poisson Problem 181

(see Exercise 7.4). Assume that  is a bounded continuous function on D = {(t, R); t  R}.
Then by Theorem 9.2.5 the function

u(s, x) = Es,x[(XD )]
is the solution of the stochastic Dirichlet problem (9.2.6), (9.2.7), where Es,x denotes expectation w.r.t. the probability law Qs,x for X starting at (s, x). Does u also solve the problem (9.2.13), (9.2.14)? Using the Laplace transform it is possible to find the distribution of the first exit point on D for X, i.e. to find the distribution of the first time t =  that Bt reaches the value R. (See Karlin and Taylor (1975), p. 363. See also Exercise 7.19.) The result is

P x[  dt] = g(x, t)dt ,

where

g(x, t) =

(R

-

x)(2t3)-1

exp(-

(R-x)2 2t

)

;

t>0

0;

t0.

(9.2.25)

Thus the solution u may be written





u(s, x) = (s + t, R)g(x, t)dt = (r, R)g(x, r - s)dr .

0

s

From

the

explicit

formula

for

u

it

is

clear

that

u s

and

2u x2

are

continuous

and we conclude that Lu = 0 in D by Lemma 9.2.3. So u satisfies (9.2.13).

What about property (9.2.14)? It is not hard to see that for t > 0

Et0,x[f (Xt)]

=

(2t)-

1 2

f (t0 + t, y) exp

-

|x

- y|2 2t

dy

R

for all bounded, (t, x)-measurable functions f . (See (2.2.2)). Therefore Xt is not a strong Feller process, so we cannot appeal to (9.2.23) to obtain (9.2.14).

However, it is easy to verify directly that if |y| = R, t1 > 0 then for all > 0

there exists where N =

>0 [t1 -

such that , t1 + ] ×

|x - y| < , |t - t1| <  {y}. And this is easily

seeQn tt,xo[XimDply

N]  1- (9.2.14).

,

Remark. As the above example (and Example 9.2.1) shows, an It^o diffusion need not be a strong Feller process. However, we have seen that it is always a Feller process (Lemma 8.1.4).

9.3 The Poisson Problem

oLnetaLd=omaianijDxi2xRj +n

bi

 xi

be

a semi-elliptic

partial differential

operator

as before and let Xt be an associated It^o diffusion,

described by (9.1.4) and (9.1.5). In this section we study the Poisson problem

(9.2.3), (9.2.4). For the same reasons as in Section 9.2 we generalize the

problem to the following:

182 9. Applications to Boundary Value Problems

The Generalized Poisson Problem

Given a continuous function g on D find a C2 function v in D such that

a) Lv = -g in D

(9.3.1)

b)

lim v(x) = 0 for all regular y  D

xy

xD

(9.3.2)

Again we will first study a stochastic version of the problem and then investigate the relation between the corresponding stochastic solution and the solution (if it exists) of (9.3.1), (9.3.2):

Theorem 9.3.1 (Solution of the stochastic Poisson problem). Assume that

D
Ex |g(Xs)|ds < 
0

for all x  D .

(9.3.3)

(This occurs, for example, if g is bounded and Ex[D ] <  for all x  D). Define
D

v(x) = Ex g(Xs)ds .

(9.3.4)

0

Then

Av = -g in D ,

(9.3.5)

and

lim
tD

v(Xt)

=

0

a.s. Qx, for all x  D .

D
Proof. Choose U open, x  U  D. Put  = g(Xs)ds,  = U .
0
Then by the strong Markov property (7.2.5)

(9.3.6)

Ex[v(X )] - v(x) Ex[ ]

=

E

1 x[

]

(E

x

[E

X

[]]

-

Ex[])

=

E

1 x[

]

(E

x[E

x[

|F

]]

-

Ex[])

=

1 Ex[

]

(E

x[



- ])

.

Approximate  by sums of the form

(k) =

g(Xti )X{ti<D } ti .

Since

t(k) =

g

(Xti

+t

)X {ti

+t< t D

}

ti

(see the argument for (7.2.6)) we see that

for all k

9.3 The Poisson Problem 183

Therefore

D
  = g(Xs)ds .


(9.3.7)

Ex[v(X )] - Ex[ ]

v(x)

=

-1 Ex[

]

E

x


g(Xs)ds  -g(x) as U  x ,

0

since g is continuous. This proves (9.3.5).
D
Put H(x) = Ex[ |g(Xs)|ds]. Let Dk, k be as in the proof of Theo-
0
rem 9.2.5. Then by the same argument as above we get

D

Ex[H(Xkt)] = Ex[Ex[ |g(Xs)|ds|Fkt]]

k t D

= Ex

|g(Xs)|ds  0 as t  D , k  

k t

by dominated convergence. This implies (9.3.6).

Remark. For functions g satisfying (9.3.3) define the operator R by
D
(Rg)(x) = g(x) = Ex g(Xs)ds .
0
Then (9.3.5) can be written

A(Rg) = -g

(9.3.8)

i.e. the operator -R is a right inverse of the operator A. Similarly, if we

define
D

Rg(x) = Ex g(Xs)e-sds

for   0

(9.3.9)

0

then the same method of proof as in Theorem 8.1.5 gives that

(A - )Rg = -g ;   0 .

(9.3.10)

(If  > 0 then the assumption (9.3.3) can be replaced by the assumption that
g is bounded (and continuous as before)).
Thus we may regard the operator R as a generalization of the resolvent operator R discussed in Chapter 8, and formula (9.3.10) as the analogue of Theorem 8.1.5 b).

184 9. Applications to Boundary Value Problems

Next we establish that if a solution v of the generalized problem (9.3.1), (9.3.2) exists, then v is the solution (9.3.4) of the stochastic problem (9.3.5), (9.3.6):
Theorem 9.3.2 (Uniqueness theorem for the Poisson equation). Assume that Xt satisfies Hunt's condition (H) ((9.2.15)). Assume that (9.3.3) holds and that there exists a function v  C2(D) and a constant C such that

D
|v(x)|  C 1 + Ex |g(Xs)|ds
0
and with the properties

for all x  D

(9.3.11)

Lv = -g in D ,
lim v(x) = 0 for all regular points y  D .
xy xD

(9.3.12) (9.3.13)

D
Then v(x) = Ex[ g(Xs)ds].
0

Proof. Let Dk, k be as in the proof of Theorem 9.2.5. Then by Dynkin's formula

k

k

Ex[v(Xk )] - v(x) = Ex (Lv)(Xs)ds = -Ex g(Xs)ds .

0

0

By dominated convergence we obtain

k

v(x) = lim
k

Ex[v(Xk )] + Ex

g(Xs)ds

0

D
= Ex g(Xs)ds ,
0

since XD is a regular point a.s. by condition (H) and Lemma 9.2.12.
Finally we combine the Dirichlet and Poisson problem and obtain the following result:

Theorem 9.3.3. (Solution of the combined stochastic Dirichlet and

Poisson problem).

Assume that (9.1.14) holds. Let   C(D) be bounded and let g  C(D)

satisfy
D

Ex |g(Xs)|ds <  for all x  D .

(9.3.14)

0

Define

9.3 The Poisson Problem 185

D
w(x) = Ex[(XD )] + Ex g(Xs)ds ,
0

xD.

(9.3.15)

a) Then

Aw = -g in D

(9.3.16)

and

lim
tD

w(Xt)

=

(XD

)

a.s. Qx, for all x  D .

(9.3.17)

b) Moreover, if there exists a function w1  C2(D) and a constant C such that
D

|w1(x)| < C 1 + Ex |g(Xs)|ds , x  D ,

(9.3.18)

0

and w1 satisfies (9.3.16) and (9.3.17), then w1 = w.

Remark. With an approach similar to the one used in Theorem 9.2.14 one

can prove that if L is uniformly elliptic in D and g  C(D) (for some  > 0)

is bounded, then the function w given by (9.3.15) solves the Dirichlet-Poisson

problem, i.e.

Lw = -g in D

(9.3.19)

and

lim w(x) = (y)
xy xD

for all regular y  D .

(9.3.20)

The Green Measure
The solution v given by the formula (9.3.4) may be rewritten as follows:
Definition 9.3.4. The Green measure (of Xt w.r.t. D at x), G(x, ·) is defined by

D
G(x, H) = Ex XH (Xs)ds ,
0
or
D
f (y)G(x, dy) = Ex f (Xs)ds ,
0

H  Rn Borel set

(9.3.21)

f bounded, continuous . (9.3.22)

186 9. Applications to Boundary Value Problems

In other words, G(x, H) is the expected length of time the process stays in H before it exits from D. If Xt is Brownian motion, then

G(x, H) = G(x, y)dy ,

H

where G(x, y) is the classical Green function w.r.t. D and dy denotes Lebesque measure. See Doob (1984), Port and Stone (1979) or Rao (1977). See also Example 9.3.6 below.
Note that using the Fubini theorem we obtain the following relation between the Green measure G and the transition measure for Xt in D, QtD(x, H) = Qx[Xt  H, t < D ]:





G(x, H) = Ex XH (Xs) · X[0,D )(s)ds = QDt (x, H)dt .

0

0

(9.3.23)

From (9.3.22) we get

D
v(x) = Ex g(Xs)ds = g(y)G(x, dy) ,

0

D

(9.3.24)

which is the familiar formula for the solution of the Poisson equation in the classical case.
Also note that by using the Green function, we may regard the Dynkin formula as a generalization of the classical Green formula:

Corollary 9.3.5 (The Green formula). Let Ex[D ] <  for all x  D and assume that f  C02(Rn). Then

f (x) = Ex[f (XD )] - (LX f )(y)G(x, dy) .
D
In particular, if f  C02(D) we have

(9.3.25)

f (x) = - (LX f )(y)G(x, dy) .
D

(9.3.26)

(As before LX =

bi

 xi

+

1 2

(T

)ij

2  xi  xj

when

dXt = b(Xt)dt + (Xt)dBt . )

Proof. By Dynkin's formula and (9.3.24) we have

D

Ex[f (XD )] = f (x) + Ex (LX f )(Xs)ds = f (x) + (LX f )(y)G(x, dy) .

0

D

9.3 The Poisson Problem 187

Remark. Combining (9.3.8) with (9.3.26) we see that if Ex[K ] <  for all compacts K  D and all x  D, then -R is the inverse of the operator A on C02(D) :

A(Rf ) = R(Af ) = -f , for all f  C02(D) .

(9.3.27)

More generally, for all   0 we get the following analogue of Theorem 8.1.5:

(A - )(Rf ) = R(A - )f = -f for all f  C02(D) . (9.3.28)

The first part of this is already established in (9.3.10) and the second part follows from the following useful extension of the Dynkin formula


Ex[e- f (X )] = f (x) + Ex e-s(A - )f (Xs)ds .
0

(9.3.29)

If  > 0 this is valid for all stopping times    and all f  C02(Rn). (See Exercise 9.6.)

Example 9.3.6. If Xt = Bt is 1-dimensional Brownian motion in a bounded interval (a, b)  R then we can compute the Green function G(x, y) explicitly. To this end, choose a bounded continuous function g: (a, b)  R and let us compute
D
v(x): = Ex g(Bt)dt .
0
By Corollary 9.1.2 we know that v is the solution of the differential equation

1 2

v

(x) = -g(x) ;

v(a) = v(b) = 0 .

x  (a, b)

Integrating twice and using the boundary conditions we get

b

v(x)

=

2(x - a) b-a

a

y

x

g(z)dz dy - 2

a

a

y
g(z)dz dy .
a

Changing the order of integration we can rewrite this as

where

b
v(x) = g(y)G(x, y)dy
a

G(x, y)

=

2(x

- a)(b b-a

-

y)

-

2(x

-

y)

·

X(-,x)(y)

.

(9.3.30)

188 9. Applications to Boundary Value Problems

We conclude that the Green function of Brownian motion in the interval

(a, b) is given by (9.3.30).

In higher dimension n the Green function y  G(x, y) of Brownian mo-

tion starting at x will not be continuous at x. It will have a logarithmic

singularity

(i.e.

a

singularity

of

order

ln

1 |x-y|

)

for

n

=

2

and

a

singularity

of

the order |x - y|2-n for n > 2.

Exercises

9.1.

In each of the cases below find an It^o diffusion whose generator coin-

cides with L on C02:

a)

Lf

(t,

x)

=



f t

+

1 2



2

 

2f x2

;

,  constants

b)

Lf (x1, x2)

=

a

f x1

+

b

f x2

+

1 2

(

 

2f x12

+

) 2f
 x22

;

a, b constants

c)

Lf (x)

=

xf

(x)

+

1 2



2

f

(x) ;

,  constants

d)

Lf (x)

=

f

(x)

+

1 2

2x2f

(x) ;

,  constants

e)

Lf (x1,

x2)

=

ln(1

+x12

)

f x1

+x2

f x2

+x22

2f  x12

+2x1x2

2f  x1  x2

+2x21

2f  x22

.

9.2. Use Theorem 9.3.3 to find the bounded solutions of the following boundary value problems:

(i)

u t

+

1 2

·

2u x2

=

et(x)

;

0 < t < T, x  R

u(T, x) = (x) ;

xR

where ,  are given bounded, continuous functions.

(ii)

xu (x) +

1 2

2x2u

(x) = 0 ;

0 < x < x0

u(x0) = x20

where

, 

are

given

constants,





1 2

2.

Exercises 189

(iii)

If



<

1 2



2

there

are

infinitely

many

bounded

solutions

of

(ii),

and an additional boundary condition e.g. at x = 0 is needed to

provide uniqueness. Explain this in view of Theorem 9.3.3.

9.3. Write down (using Brownian motion) and compare the solutions u(t, x)

of the following two boundary value problems:

a)

u t

+

1 2

u

=

0

for 0 < t < T, x  Rn

u(T, x) = (x) for x  Rn .

b)

u t

-

1 2

u

=

0

for 0 < t < T, x  Rn

u(0, x) = (x) for x  Rn .

9.4. Let G and H be bounded open subsets of Rn, G  H, and let Bt be n-dimensional Brownian motion. Use the property (H) for Bt to prove that inf{t > 0; Bt / H} = inf{t > G; Bt / H}
i.e., with the terminology of (7.2.6),

H = H where  = G .

Use this to prove that if Xt = Bt then the mean value property (7.2.9) holds for all bounded open G  H, i.e. it is not necessary to require
G  H in this case. This verifies the statement (9.2.24).

9.5. (The eigenvalues of the Laplacian)

Let D  Rn be open, bounded and let   R.

a) Suppose there exists a solution u  C2(D)C(D), u not identically

zero, such that

-

1 2

u

=

u

in

D

u = 0 on D .

(9.3.31)

Show

that

we

must

have



>

0.

(Hint:

If

1 2

u

=

-u

in

D

then

1 2

u,

u

=

-u, u

where

u, v = u(x)v(x)dx .

D

Now use integration by parts.)

b) It can be shown that if D is smooth then there exist 0 < 0 < 1 <

· · · < n < · · · where n   such that (9.3.31) holds for  = n,

n = 0, 1, 2, . . ., and for no other values of . The numbers {n} are

called

the

eigenvalues

of

the

operator

-

1 2



in

the

domain

D

and

the corresponding (nontrivial) solutions un of (9.3.31) are called the

eigenfunctions. There is an interesting probabilistic interpretation

of the lowest eigenvalue 0. The following result indicates this:

190 9. Applications to Boundary Value Problems

Put  = D = inf{t > 0; Bt / D}, choose  > 0 and define w(x) = Ex[exp( )] ; x  D .

Prove that if w(x) <  for all x  D then  is not an eigenvalue

for

-

1 2

.

(Hint:

Let

u

be

a

solution

of

(9.3.31)

with



=

.

Apply

Dynkin's formula to the process dYt = (dt, dBt) and the function

f (t, x) = etu(x) to deduce that u(x) = 0 for x  D).

c) Conclude that

0  sup{; Ex[exp( )] <  for all x  D} .

(We have in fact equality here. See for example Durrett (1984), Chap. 8B).

9.6. Prove formula (9.3.29), for example by applying the Dynkin formula

to the process

dYt =

dt dXt

and the function g(y) = g(t, x) = e-tf (x).

9.7. a) Let Bt be Brownian motion in R2. Prove that

P x[t > 0; Bt = y] = 0 for all x, y  R2 .

(Hint: First assume x = y. We may choose y = 0. One possible
approach would be to apply Dynkin's formula with f (u) = ln |u|
and  = inf{t > 0; |Bt|   or |Bt|  R}, where 0 <  < R. Let   0 and then R  . If x = y consider P x[t > ; Bt = x] and use the Markov property.) b) Let Bt = (Bt(1), Bt(2)) be Brownian motion in R2. Prove that Bt = (-Bt(1), Bt(2)) is also a Brownian motion. c) Prove that 0  R2 is a regular boundary point (for Brownian mo-
tion) of the plane region

D = {(x1, x2)  R2; x21 + x22 < 1} \ {(x1, 0); x1  0} .
d) Prove that 0  R3 is an irregular boundary point (for Brownian motion) of the 3-dimensional region

U = {(x1, x2, x3)  R3, x21 + x22 + x32 < 1} \ {(x1, 0, 0); x1  0} .

Exercises 191

9.8. a) Find an It^o diffusion Xt and a measurable set G which is semipolar but not polar for Xt.
b) Find an It^o diffusion Xt and a countable family of thin sets Hk;

k = 1, 2, . . . such that Hk is not thin.
k=1
9.9. a) Let Xt be an It^o diffusion in Rn and assume that g is a non-constant locally bounded real Xt-harmonic function on a connected open set G  Rn. Prove that g satisfies the following weak form of the maximum principle: g does not have a (local or global) maximum at any point of G. (Similarly g satisfies the minimum principle).
b) Give an example to show that a non-constant bounded Xt-harmonic function g can have a (non-strict) global maximum. (Hint: Consider uniform motion to the right.)

9.10. Find the (stochastic) solution f (t, x) of the boundary value problem

  K(x)e-t +

f t

+

x

f x

+

1 2



2

x2

 

2f x2

=0

for x > 0, 0 < t < T

 f (T, x) = e-T (x)

for x > 0

where K,  are given functions and T, , ,  are constants,  > 0, T > 0.
(Hint: Consider dYt = (dt, dXt) where Xt is a geometric Brownian motion).

9.11. a) The Poisson kernel is defined by

Pr ()

=

1 - r2 1 - 2r cos  + r2

=

1 - |z|2 |1 - z|2

where r  0,   [0, 2], z = rei  C

 (i = -1 ).

The Poisson formula states that if D denotes the open unit disk in

the plane R2 = C and h  C( D ) satisfies h = 0 in D then

2

h(rei )

=

1 2

Pr(t - )h(eit)dt .

0

192 9. Applications to Boundary Value Problems

Prove that the probability that Brownian motion, starting from z  D, first exits from D at a set F  D is given by

1 2

Pr(t - )dt , where z = rei .

F

b) The function

w

=

(z)

=

i

1 1

+ -

z z

maps the disc D = {|z| < 1} conformally onto the half plane H = {w = u+iv; v > 0}, (D) = R and (0) = i. Use Example 8.5.9 to prove that if µ denotes the harmonic measure for Brownian motion at the point i = (0, 1) for the half plane H then

2

f ()dµ()

=

1 2

f ((eit))dt

=

1 2i

f

((z)) z

dz

.

R

0

D

c)

Substitute

w

=

(z)

(i.e.

z

= (w): = -1(w) =

w-i w+i

)

in

the

inte-

gral above to show that



f ()dµ()

=

1 

f

(w)

dw |w - i|2

=

1 

f

(x)

dx x2 +

1

.

R

H

-

d) Show that the harmonic measure µHw for Brownian motion in H at the point w = u + iv  H is given by

dµHw (x)

=

1 

·

(x

-

v u)2

+

v2 dx

.

9.12. (A Feynman-Kac formula for boundary value problems) Let Xt be an It^o diffusion on Rn whose generator coincides with a given partial differential operator L on C02(Rn). Let D,  and g be as in Theorem 9.3.3 and let q(x)  0 be a continuous function on Rn.

Exercises 193

Consider the boundary value problem: Find h  C2(D)  C( D ) such that
Lh(x) - q(x)h(x) = -g(x) on D

lim h(x) = (y) ;
xy

y  D .

Show that if a bounded solution h exists, then

h(x) = Ex

D
e-

t 0

q(Xs)dsg(Xt)dt

+

e-

D 0

q(Xs

)ds

(XD

)

.

0

(Compare with the Feynman-Kac formula.) Hint: Proceed as in the proof of Theorem 8.2.1 b).

For more information on stochastic solutions of boundary value problems see Freidlin (1985).

9.13. Let D = (a, b) be a bounded interval. a) For x  R define

Xt = Xtx = x + µt + Bt ;

t0

where µ,  are constants,  = 0. Use Corollary 9.1.2 to compute

w(x): = Ex[(XD )] + Ex

D
g(Xt)dt
0

when : {a, b}  R and g: (a, b)  R are given functions, g bounded and continuous. b) Use the results in a) to compute the Green function G(x, y) of the process Xt. (Hint: Choose  = 0 and proceed as in Example 9.3.6.)

9.14. Let D = (a, b)  (0, ) be a bounded interval and let

dXt = rXtdt + XtdBt ;
be a geometric Brownian motion. a) Use Corollary 9.1.2 to find

X0 = x  (a, b)

Qx[XD = b] .
(Hint: Choose g = 0 and (a) = 0, (b) = 1.) b) Use Corollary 9.1.2 to compute

w(x) = Ex[(XD )] + Ex

D
g(Xt)dt
0

194 9. Applications to Boundary Value Problems

for given functions : {a, b}  R and g: (a, b)  R, g bounded and continuous. (Hint: The substitution t = ln x, w(x) = h(ln x) transforms the differential equation

1 2

2x2w

(x) + rxw (x) = -g(x) ;

into the differential equation

x>0

1 2

2

h

(t)

+

(r

-

1 2

2)h

(t)

=

-g(et)

;

t  R .)

9.15. a) Let D = (a, b)  R be a bounded interval and let Xt = Bt be 1-dimensional Brownian motion. Use Corollary 9.1.2 to compute

h(x) = Ex[e-D (BD )] + Ex

D
e-tBt2dt
0

for a given function : {a, b}  R, when  > 0 is constant. (Hint: Consider the It^o diffusion

dYt =

dYt(1) dYt(2)

=

dt dBt

=

1 0

dt +

0 1

dBt ;

Then

h(x) = w(0, x)

Y0 = y = (s, x) .

where

w(s, x) = w(y) = Ey[(YD )] + Ey

D
g(Yt)dt
0

with (y) = (s, x) = e-s(x) and g(y) = g(s, x) = e-sx2 .
Note that

D = inf{t > 0; Bt  (a, b)} = inf{t > 0; Yt(2)  (a, b)} = inf{t > 0; Yt  R × (a, b)} .

To find w(s, x) solve the boundary value problem





1 2w 2 x2

+

w s

=

-e-sx2

;

a<x<b

 w(s, a) = e-s(a) , w(s, b) = e-s(b) .

To this end, try w(s, x) = e-sh(x).) b) Use the method in a) to find Ex[e-D ].
(Compare with Exercise 7.19.)

10. Application to Optimal Stopping

10.1 The Time-Homogeneous Case

Problem 5 in the introduction is a special case of a problem of the following type:

Problem 10.1.1 (The optimal stopping problem). Let Xt be an It^o diffusion on Rn and let g (the reward function) be a given function on Rn, satisfying

a) g()  0 for all   Rn b) g is continuous.

(10.1.1)

Find a stopping time   =  (x, ) (called an optimal stopping time) for {Xt} such that

Ex[g(X )] = sup Ex[g(X )]


for all x  Rn ,

(10.1.2)

the sup being taken over all stopping times  for {Xt}. We also want to find the corresponding optimal expected reward

g(x) = Ex[g(X )] .

(10.1.3)

Here g(X ) is to be interpreted as 0 at the points    where  () =  and as usual Ex denotes the expectation with respect to the probability law Qx of the process Xt; t  0 starting at X0 = x  Rn.
We may regard Xt as the state of a game at time t, each  corresponds to one sample of the game. For each time t we have the option of stopping
the game, thereby obtaining the reward g(Xt), or continue the game in the hope that stopping it at a later time will give a bigger reward. The problem
is of course that we do not know what state the game is in at future times,
only the probability distribution of the "future". Mathematically, this means
that the possible "stopping" times we consider really are stopping times in
the sense of Definition 7.2.1: The decision whether   t or not should only
depend on the behaviour of the Brownian motion Br (driving the process X) up to time t, or perhaps only on the behaviour of Xr up to time t. So, among

196 10. Application to Optimal Stopping

all possible stopping times  we are asking for the optimal one,  , which gives the best result "in the long run", i.e. the biggest expected reward in the sense of (10.1.2).
In the following we will outline how a solution to this problem can be obtained using the material from the preceding chapter. Later in this chapter we shall see that our discussion of problem (10.1.2)­(10.1.3) also covers the apparently more general problems

g(s, x) = sup E(s,x)[g(, X )] = E(s,x)[g( , X )]

and

G(s, x) = sup E(s,x) f (t, Xt)dt + g(, X )
 0

= E(s,x) f (t, Xt)dt + g( , X )
0

(10.1.4) (10.1.5)

where f is a given reward rate function (satisfying certain conditions).

We shall also discuss possible extensions of problem (10.1.2)­(10.1.3) to cases where g is not necessarily continuous or where g may assume negative values.
A basic concept in the solution of (10.1.2)­(10.1.3) is the following:

Definition 10.1.2. A measurable function f : Rn  [0, ] is called supermeanvalued (w.r.t. Xt) if

f (x)  Ex[f (X )]

(10.1.6)

for all stopping times  and all x  Rn. If, in addition, f is also lower semicontinuous, then f is called l.s.c. su-
perharmonic or just superharmonic (w.r.t. Xt).

Note that if f : Rn  [0, ] is lower semicontinuous then by the Fatou

lemma

f (x)  Ex[ lim f (Xk )]  lim Ex[f (Xk )] ,

k

k

(10.1.7)

for any sequence {k} of stopping times such that k  0 a.s. P . Combining this with (10.1.6) we see that if f is (l.s.c.) superharmonic, then

f

(x)

=

lim
k

Ex[f

(Xk

)]

for all x ,

(10.1.8)

for all such sequences k. Remarks. 1) In the literature (see e.g. Dynkin (1965 II)) one often finds
a weaker concept of Xt-superharmonicity, defined by the supermeanvalued

10.1 The Time-Homogeneous Case 197

property (10.1.6) plus the stochastic continuity requirement (10.1.8). This

weaker concept corresponds to the Xt-harmonicity defined in Chapter 9. 2) If f  C2(Rn) it follows from Dynkin's formula that f is superhar-

monic w.r.t. Xt if and only if

Af  0

where A is the characteristic operator of Xt. This is often a useful criterion (See e.g. Example 10.2.1).
3) If Xt = Bt is Brownian motion in Rn then the superharmonic functions for Xt coincide with the (nonnegative) superharmonic functions in classical potential theory. See Doob (1984) or Port and Stone (1979).

We state some useful properties of superharmonic and supermeanvalued functions.

Lemma 10.1.3. a) If f is superharmonic (supermeanvalued) and  > 0,

then f is superharmonic (supermeanvalued).

b) If f1, f2 are superharmonic (supermeanvalued), then f1 + f2 is superharmonic (supermeanvalued).

c)

If {fj }jJ

is

a

family

of

supermeanvalued

functions,

then

f

(x):

=

inf
jJ

{fj

(x)}

is supermeanvalued if it is measurable (J is any set).

d) If f1, f2, · · · are superharmonic (supermeanvalued) functions and fk  f pointwise, then f is superharmonic (supermeanvalued).

e) If f is supermeanvalued and    are stopping times, then Ex[f (X)]  Ex[f (X )].

f ) If f is supermeanvalued and H is a Borel set, then f (x): = Ex[f (XH )] is supermeanvalued.

Proof of Lemma 10.1.3.

a) and b) are straightforward. c) Suppose fj is supermeanvalued for all j  J. Then

fj(x)  Ex[fj(X )]  Ex[f (X )] for all j .

So f (x) = inf fj(x)  Ex[f (X )], as required. d) Suppose fj is supermeanvalued, fj  f . Then

f (x)  fj(x)  Ex[fj(X )] for all j, so

f

(x)



lim
j

Ex[fj

(X

)]

=

Ex[f

(X

)]

,

by monotone convergence. Hence f is supermeanvalued. If each fj is also lower semicontinuous then if yk  x as k   we have

fj(x)  lim fj(yk)  lim f (yk)

k

k

for each j .

Hence, by letting j  ,

198 10. Application to Optimal Stopping

f (x)  lim f (yk) .
k
e) If f is supermeanvalued we have by the Markov property when t > s

Ex[f (Xt)|Fs] = EXs [f (Xt-s)]  f (Xs) ,

(10.1.9)

i.e. the process

t = f (Xt)

is a supermartingale w.r.t. the -algebras Ft generated by {Br; r  t}. (Appendix C). Therefore, by Doob's optional sampling theorem (see Gih-
man and Skorohod (1975, Theorem 6 p. 11)) we have

Ex[f (X)]  Ex[f (X )]
for all stopping times ,  with    a.s. Qx. f) Suppose f is supermeanvalued. By the strong Markov property (7.2.2)
and formula (7.2.6) we have, for any stopping time ,

Ex[f (X)] = Ex[EX [f (XH )]] = Ex[Ex[f (XH )|F]]

= Ex[f (XH )] = Ex[f (XH )]

(10.1.10)

where H = inf{t > ; Xt / H}. Since H  H we have by e)

Ex[f (X)]  Ex[f (XH )] = f (x) ,

so f is supermeanvalued.

The following concepts are fundamental:

Definition 10.1.4. Let h be a real measurable function on Rn. If f is a superharmonic (supermeanvalued) function and f  h we say that f is a superharmonic (supermeanvalued) majorant of h (w.r.t. Xt). The function

h(x) = inf f (x); x  Rn ,
f

(10.1.11)

the inf being taken over all supermeanvalued majorants f of h, is called the least supermeanvalued majorant of h.

Similarly, suppose there exists a function h such that

(i) h is a superharmonic majorant of h and (ii) if f is any other superharmonic majorant of h then h  f .

Then h is called the least superharmonic majorant of h. Note that by Lemma 10.1.3 c) the function h is supermeanvalued if it is
measurable. Moreover, if h is lower semicontinuous, then h exists and h = h.

10.1 The Time-Homogeneous Case 199

Later we will prove that if g is nonnegative (or lower bounded) and lower semicontinuous, then g exists and g = g (Theorem 10.1.7).
Let g  0 and let f be a supermeanvalued majorant of g. Then if  is a stopping time
f (x)  Ex[f (X )]  Ex[g(X )] .
So f (x)  sup Ex[g(X )] = g(x) .

Therefore we always have

g(x)  g(x) for all x  Rn .

(10.1.12)

What is not so easy to see is that the converse inequality also holds, i.e. that

in fact

g = g .

(10.1.13)

We will prove this after we have established a useful iterative procedure for calculating g. Before we give such a procedure let us introduce a concept which is related to superharmonic functions:

Definition 10.1.5. A lower semicontinuous function f : Rn  [0, ] is called excessive (w.r.t. Xt) if

f (x)  Ex[f (Xs)] for all s  0, x  Rn .

(10.1.14)

It is clear that a superharmonic function must be excessive. What is not so obvious, is that the converse also holds:

Theorem 10.1.6. Let f : Rn  [0, ]. Then f is excessive w.r.t. Xt if and only if f is superharmonic w.r.t. Xt.

Proof in a special case. Let L be the differential operator associated to
X (given by the right hand side of (7.3.3)), so that L coincides with the generator A of X on C02. We only prove the theorem in the special case when f  C2(Rn) and Lf is bounded: Then by Dynkin's formula we have

t
Ex[f (Xt)] = f (x) + Ex Lf (Xr)dr

for all t  0 ,

0

so if f is excessive then Lf  0. Therefore, if  is a stopping time we get

Ex[f (Xt )]  f (x) for all t  0 .

Letting t   we see that f is superharmonic.

A proof in the general case can be found in Dynkin (1965 II, p. 5). The first iterative procedure for the least superharmonic majorant g of g is the following:

200 10. Application to Optimal Stopping

Theorem 10.1.7. (Construction of the least superharmonic majo-

rant).

Let g = g0 be a nonnegative, lower semicontinuous function on Rn and define inductively

gn(x) = sup Ex[gn-1(Xt)] ,
tSn

(10.1.15)

where Sn = {k · 2-n; 0  k  4n}, n = 1, 2, . . . . Then gn  g and g is the least superharmonic majorant of g. Moreover, g = g.

Proof.

Note

that

{gn}

is

increasing.

Define

g(x)

=

lim
n

gn(x).

Then

g(x)  gn(x)  Ex[gn-1(Xt)] for all n and all t  Sn .

Hence

g(x)



lim
n

Ex[gn-1(Xt)]

=

Ex[g(Xt)]

(10.1.16)


for all t  S = Sn .
n=1
Since g is an increasing limit of lower semicontinuous functions (Lemma 8.1.4)

g is lower semicontinuous. Fix t  R and choose tk  S such that tk  t. Then by (10.1.16), the Fatou lemma and lower semicontinuity

g(x)  lim Ex[g(Xtk )]  Ex[ lim g(Xtk )]  Ex[g(Xt)] .

k

k

So g is an excessive function. Therefore g is superharmonic by Theorem 10.1.6 and hence g is a superharmonic majorant of g. On the other hand, if f is any supermeanvalued majorant of g, then clearly by induction

f (x)  gn(x) for all n
and so f (x)  g(x). This proves that g is the least supermeanvalued majorant g of g. So g = g.

It is a consequence of Theorem 10.1.7 that we may replace the finite sets Sn by the whole interval [0, ]:

Corollary 10.1.8. Define h0 = g and inductively

hn(x) = sup Ex[hn-1(Xt)] ;
t0

n = 1, 2, . . .

Then hn  g.

Proof. Let h = lim hn. Then clearly h  g = g. On the other hand, since g is excessive we have
g(x)  sup Ex[g(Xt)].
t0

So by induction

g  hn for all n .

Thus g = h and the proof is complete.

10.1 The Time-Homogeneous Case 201

We are now ready for our first main result on the optimal stopping problem. The following result is basically due to Dynkin (1963) (and, in a martingale context, Snell (1952)):

Theorem 10.1.9 (Existence theorem for optimal stopping). Let g denote the optimal reward and g the least superharmonic majorant of
a continuous reward function g  0.

a) Then

g(x) = g(x) .

(10.1.17)

b) For > 0 let

D = {x; g(x) < g(x) - } .

(10.1.18)

Suppose g is bounded. Then stopping at the first time  of exit from D is close to being optimal, in the sense that

|g(x) - Ex[g(X )]|  2
for all x. c) For arbitrary continuous g  0 let

(10.1.19)

D = {x; g(x) < g(x)} (the continuation region) .

(10.1.20)

For N = 1, 2, . . . define gN = g  N , DN = {x; gN (x) < gN (x)} and N = DN . Then DN  DN+1, DN  D  g-1([0, N )), D = DN . If
N
N <  a.s. Qx for all N then

g(x)

=

lim
N 

Ex[g(XN

)]

.

(10.1.21)

d) In particular, if D <  a.s. Qx and the family {g(XN )}N is uniformly integrable w.r.t. Qx (Appendix C), then

g(x) = Ex[g(XD )] and   = D is an optimal stopping time. Proof. First assume that g is bounded and define

g (x) = Ex[g(X )] for > 0 . Then g is supermeanvalued by Lemma 10.1.3 f). We claim that

(10.1.22)

g(x)  g (x) +

for all x .

(10.1.23)

To see this suppose

: = sup{g(x) - g (x)} > .
x

Then for all  > 0 we can find x0 such that

(10.1.24)

202 10. Application to Optimal Stopping

g(x0) - g (x0)   -  .

(10.1.25)

On the other hand, since g +  is a supermeanvalued majorant of g, we have

g(x0)  g (x0) +  . Combining (10.1.25) and (10.1.26) we get

(10.1.26)

g(x0)  g(x0) +  .

(10.1.27)

Consider the two possible cases:

Case 1:  > 0 a.s. Qx0 . Then by (10.1.27) and the definition of D

g(x0) +   g(x0)  Ex0 [g(Xt )]  Ex0 [(g(Xt) + )X{t< } ] for all t > 0 . Hence by the Fatou lemma and lower semicontinuity of g

g(x0) +   lim Ex0 [(g(Xt) + )X{t< }]
t0
 Ex0 [ lim(g(Xt) + )X{t< }]  g(x0) + .
t0
This is a contradiction if  < .
Case 2:  = 0 a.s. Qx0 . Then g (x0) = g(x0), so g(x0)  g (x0), contradicting (10.1.25) for  < .
Therefore (10.1.24) leads to a contradiction. Thus (10.1.23) is proved and we conclude that g + is a supermeanvalued majorant of g. Therefore

g  g + = E[g(X )] +  E[(g + )(X )] +  g + 2 and since was arbitrary we have by (10.1.12)

(10.1.28)

g = g .

If g is not bounded, let

gN = min(N, g) , N = 1, 2, . . .

and as before let gN be the least superharmonic majorant of gN . Then

g

 g N

= gN

h

as N   , where h  g

since h is a superharmonic majorant of g. Thus h = g = g and this proves (10.1.17) for general g. From (10.1.28) and (10.1.17) we obtain (10.1.19).
Finally, to obtain c) and d) let us again first assume that g is bounded. Then, since
  D as  0

10.1 The Time-Homogeneous Case 203

and D <  a.s we have Ex[g(X )]  Ex[g(XD )]
and hence by (10.1.28) and (10.1.17)

as  0 ,

(10.1.29)

g(x) = Ex[g(XD )] Finally, if g is not bounded define

if g is bounded .

(10.1.30)

h

=

lim
N 

gN

.

Then h is superharmonic by Lemma 10.1.3 d) and since gN  g for all N we have h  g. On the other hand gN  gN  h for all N and therefore g  h. Since g is the least superharmonic majorant of g we conclude that

h=g.

(10.1.31)

Hence by (10.1.30), (10.1.31) we obtain (10.1.21):

g(x)

=

lim
N 

gN

(x)

=

lim
N 

Ex[gN

(XN

)]



lim
N 

Ex[g(XN

)]



g(x)

.

Note that gN  N everywhere, so if gN (x) < gN (x) then gN (x) < N and therefore g(x) = gN (x) < gN (x)  g(x) and gN+1 (x) = gN (x) < gN (x)  gN+1 (x). Hence DN  D  {x; g(x) < N } and DN  DN+1 for all N . So by (10.1.31) we conclude that D is the increasing union of the sets DN ; N = 1, 2, . . . Therefore

D

=

lim
N 

N

.

So by (10.1.21) and uniform integrability we have

g(x)

=

lim
N 

gN

(x)

=

lim
N 

E

x

[gN

(XN

)]

=

E

x

[ lim
N 

gN

(XN

)]

=

Ex[g(XD )]

,

and the proof of Theorem 10.1.9 is complete.

Remarks.
1) Note that the sets D, D and DN are open, since g = g is lower semicontinuous and g is continuous.
2) By inspecting the proof of a) we see that (10.1.17) holds under the weaker assumption that g  0 is lower semicontinuous.
The following consequence of Theorem 10.1.9 is often useful:

Corollary 10.1.10. Suppose there exists a Borel set H such that

gH (x): = Ex[g(XH )] is a supermeanvalued majorant of g. Then

g(x) = gH (x) , so   = H is optimal .

204 10. Application to Optimal Stopping

Proof. If gH is a supermeanvalued majorant of g then clearly g(x)  gH (x) .
On the other hand we of course have

gH

(x)



sup


Ex[g(X

)]

=

g(x)

,

so g = gH by Theorem 10.1.7 and Theorem 10.1.9 a).

Corollary 10.1.11. Let

D = {x; g(x) < g(x)}

and put If g  g then g = g.

g(x) = gD (x) = Ex[g(XD )] .

Proof. Since XD / D we have g(XD )  g(XD ) and therefore g(XD ) = g(XD ), a.s. Qx. So g(x) = Ex[g(XD )] is supermeanvalued since g is, and the result follows from Corollary 10.1.10.

Theorem 10.1.9 gives a sufficient condition for the existence of an optimal stopping time  . Unfortunately,   need not exist in general. For example,
if
Xt = t for t  0 (deterministic)

and

g()

=

2 1 + 2

;

R

then g(x) = 1, but there is no stopping time  such that

Ex[g(X )] = 1 .
However, we can prove that if an optimal stopping time   exists, then the stopping time given in Theorem 10.1.9 is optimal:

Theorem 10.1.12 (Uniqueness theorem for optimal stopping). Define as before
D = {x; g(x) < g(x)}  Rn .
Suppose there exists an optimal stopping time   =  (x, ) for the problem (10.1.2) for all x. Then

   D for all x  D
and g(x) = Ex[g(XD )] for all x  Rn .
Hence D is an optimal stopping time for the problem (10.1.2).

(10.1.32) (10.1.33)

10.1 The Time-Homogeneous Case 205

Proof. Choose x  D. Let  be an Ft-stopping time and assume Qx[ < D] > 0. Since g(X ) < g(X ) if  < D and g  g always, we have

Ex[g(X )] =

g(X )dQx +

g(X )dQx

 <D

 D

<

g(X )dQx +

g(X )dQx = Ex[g(X )]  g(x) ,

 <D

 D

since g is superharmonic. This proves (10.1.32).

To obtain (10.1.33) we first choose x  D. Since g is superharmonic we

have by (10.1.32) and Lemma 10.1.3 e)

g(x) = Ex[g(X )]  Ex[g(X )]  Ex[g(XD )] = Ex[g(XD )]  g(x) , which proves (10.1.33) for x  D .

Next, choose x  D to be an irregular boundary point of D. Then D > 0 a.s. Qx. Let {k} be a sequence of stopping times such that 0 < k < D and k  0 a.s. Qx, as k  . Then Xk  D so by (10.1.32), (7.2.6) and the strong Markov property (7.2.2)

Ex[g(XD )] = Ex[k g(XD )] = Ex[EXk [g(XD )]] = Ex[g(Xk )] for all k .

Hence by lower semicontinuity and the Fatou lemma

g(x)  Ex[ lim g(Xk )]  lim Ex[g(Xk )] = Ex[g(XD )] .

k

k

Finally, if x  D is a regular boundary point of D or if x  D we have D = 0 a.s. Qx and hence g(x) = Ex[g(XD )].
Remark. The following observation is sometimes useful: Let A be the characteristic operator of X. Assume g  C2(Rn). Define

U = {x; Ag(x) > 0} .

(10.1.34)

Then, with D as before, (10.1.20),

U D.

(10.1.35)

Consequently, from (10.1.32) we conclude that it is never optimal to stop the process before it exits from U . But there may be cases when U = D, so that it is optimal to proceed beyond U before stopping. (This is in fact the typical situation.) See e.g. Example 10.2.2.
To prove (10.1.35) choose x  U and let 0 be the first exit time from a bounded open set W x, W  U . Then by Dynkin's formula, for u > 0

Ex[g(X0u)] = g(x) + Ex so g(x) < g(x) and therefore x  D.

0 u
Ag(Xs)ds
0

> g(x)

206 10. Application to Optimal Stopping

Example 10.1.13. Let Xt = Bt be a Brownian motion in R2. Using that Bt is recurrent in R2 (Example 7.4.2) one can show that the only (nonnegative) superharmonic functions in R2 are the constants (Exercise 10.2).
Therefore

g(x) = g : = sup{g(y); y  R2} for all x .
So if g is unbounded then g =  and no optimal stopping time exists. Assume therefore that g is bounded. The continuation region is

D = {x; g(x) < g } ,

so if D is a polar set i.e. cap (D) = 0, where cap denotes the logarithmic
capacity (see Port and Stone (1979)), then D =  a.s. and no optimal stopping exists. On the other hand, if cap(D) > 0 then D <  a.s. and

Ex[g(BD )] = g  = g(x) , so   = D is optimal. Example 10.1.14. The situation is different in Rn for n  3.

a) To illustrate this let Xt = Bt be Brownian motion in R3 and let the reward function be

g() =

||-1 1

for for

|| ||

 <

1 1

;

  R3 .

Then g is superharmonic (in the classical sense) in R3, so g = g everywhere and the best policy is to stop immediately, no matter where the starting point is. b) Let us change g to

h(x) =

|x|- 1

for |x|  1 for |x| < 1

for some  > 1. Let H = {x; |x| > 1} and define

h(x) = Ex[h(BH )] = P x[H < ] . Then by Example 7.4.2

h(x) =

1 |x|-1

if |x|  1 if |x| > 1 ,

i.e. h = g (defined in a)), which is a superharmonic majorant of h. Therefore by Corollary 10.1.10
h = h = g ,
H = D and   = H is an optimal stopping time.

10.2 The Time-Inhomogeneous Case 207

Reward Functions Assuming Negative Values

The results we have obtained so far regarding the problem (10.1.2)­(10.1.3) are based on the assumptions (10.1.1). To some extent these assumptions can be relaxed, although neither can be removed completely. For example, we have noted that Theorem 10.1.9 a) still holds if g  0 is only assumed to be lower semicontinuous.
The nonnegativity assumption on g can also be relaxed. First of all, note that if g is bounded below, say g  -M where M > 0 is a constant, then we can put
g1 = g + M  0
and apply the theory to g1. Since

Ex[g(X )] = Ex[g1(X )] - M if  <  a.s. ,

we have g(x) = g1(x) - M , so the problem can be reduced to the optimal stopping problem for the nonnegative function g1. (See Exercise 10.4.)
If g is not bounded below, then problem (10.1.2)­(10.1.3) is not well-

defined unless

Ex[g-(X )] <  for all 

(10.1.36)

where

g-(x) = - min(g(x), 0) .

If we assume that g satisfies the stronger condition that

the family {g-(X );  stopping time} is uniformly integrable (10.1.37)

then basically all the theory from the nonnegative case carries over. We refer to the reader to Shiryaev (1978) for more information. See also Theorem 10.4.1.

10.2 The Time-Inhomogeneous Case

Let us now consider the case when the reward function g depends on both time and space, i.e.

g = g(t, x): R × Rn  [0, ) , g is continuous .

(10.2.1)

Then the problem is to find g0(x) and   such that g0(x) = sup Ex[g(, X )] = Ex[g( , X )] .


(10.2.2)

To reduce this case to the original case (10.1.2)­(10.1.3) we proceed as follows: Suppose the It^o diffusion Xt = Xtx has the form

208 10. Application to Optimal Stopping

dXt = b(Xt)dt + (Xt)dBt ; t  0 , X0 = x

where b: Rn  Rn and : Rn  Rn×m are given functions satisfying the con-

ditions the It^o

of Theorem diffusion Yt

=5.2Y.t1(s,axn)dinBRt nis+m1 b-dyimensional

Brownian

motion.

Define

Yt =

s+t Xtx

;

t0.

(10.2.3)

Then

dYt =

1 b(Xt)

dt +

0 (Xt)

dBt = b(Yt)dt + (Yt)dBt

(10.2.4)

where

b() = b(t, ) =

1 b()

 Rn+1 ,





0···0

() = (t, ) =  - - - -   R(n+1)×m ,

()

with  = (t, )  R × Rn. So Yt is an It^o diffusion starting at y = (s, x). Let Ry = R(s,x) denote the
probability law of {Yt} and let Ey = E(s,x) denote the expectation w.r.t. Ry. In terms of Yt the problem (10.2.2) can be written

g0(x) = g(0, x) = sup E(0,x)[g(Y )] = E(0,x)[g(Y )]


(10.2.5)

which is a special case of the problem

g(s, x) = sup E(s,x)[g(Y )] = E(s,x)[g(Y )] ,


(10.2.6)

which is of the form (10.1.2)­(10.1.3) with Xt replaced by Yt. Note that the characteristic operator A of Yt is given by

A(s, x)

=

 s

(s,

x)

+

A(s,

x)

;

  C2(R × Rn)

(10.2.7)

where A is the characteristic operator of Xt (working on the x-variables).

Example 10.2.1. Let Xt = Bt be 1-dimensional Brownian motion and let the reward function be

g(t, ) = e-t+ ;

R

where ,   0 are constants. The characteristic operator A of Yts,x =

s+t Btx

is given by

Af (s, x)

=

f s

+

1 2

·

2f x2

;

f  C2 .

10.2 The Time-Inhomogeneous Case 209

Thus

Ag

=

(-

+

1 2



2)g

,

so if 2  2 then g = g and the best policy is to stop immediately. If 2 > 2 we have
U : = {(s, x); Ag(s, x) > 0} = R2

and therefore by (10.1.35) D = R2 and hence   does not exist. If 2 > 2 we can use Theorem 10.1.7 to prove that g = :

sup E(s,x)[g(Yt)] = sup E[e-(s+t)+Btx ]

tSn

tSn

=

sup

[e-(s+t)

·

ex+

] 1
2



2

t

(see the remark following (5.1.6))

tSn

=

sup
tSn

g(s, x)

·

e(-+

1 2



2

)t

=

g(s,

x)

·

exp((-

+

1 2



2

)2n)

,

so gn(s, x)   as n  . Hence no optimal stopping exists in this case.

Example 10.2.2. (When is the right time to sell the stocks?) We now return to a specified version of Problem 5 in the introduction:
Suppose the price Xt at time t of a person's assets (e.g. a house, stocks, oil ...) varies according to a stochastic differential equation of the form

dXt = rXtdt + XtdBt, X0 = x > 0 ,
where Bt is 1-dimensional Brownian motion and r,  are known constants. (The problem of estimating  and r from a series of observations can be approached using the quadratic variation X, X t of the process {Xt} (Exercise 4.7) and filtering theory (Example 6.2.11), respectively. Suppose that connected to the sale of the assets there is a fixed fee/tax or transaction cost a > 0. Then if the person decides to sell at time t the discounted net of the sale is
e-t(Xt - a) ,
where  > 0 is given discounting factor. The problem is to find a stopping time  that maximizes

E(s,x)[e- (X - a)] = E(s,x)[g(, X )] ,

where

g(t, ) = e-t( - a) .

The characteristic operator A of the process Yt = (s + t, Xt) is given by

Af (s, x)

=

f s

+

rx

f x

+

1 2

2

x2

2f x2

;

f  C2(R2) .

210 10. Application to Optimal Stopping

Hence Ag(s, x) = -e-s(x - a) + rxe-s = e-s((r - )x + a). So

U : = {(s, x); Ag(s, x) > 0} =

R × R+

if r  

{(s, x); x

<

a -r

}

if r <  .

So if r   we have U = D = R × R+ so   does not exist. If r >  then g =  while if r =  then

g(s, x) = xe-s .

(The proofs of these statements are left as Exercise 10.5.)

It remains to examine the case r < . (If we regard  as the sum of interest rate, inflation and tax etc., this is not an unreasonable assumption in applications.) First we establish that the region D must be invariant w.r.t. t, in the sense that

D + (t0, 0) = D To prove (10.2.8) consider

for all t0 .

(10.2.8)

D + (t0, 0) = {(t + t0, x); (t, x)  D} = {(s, x); (s - t0, x)  D} = {(s, x); g(s - t0, x) < g(s - t0, x)} = {(s, x); et0 g(s, x) < et0 g(s, x)} = {(s, x); g(s, x) < g(s, x)} = D ,

where we have used that

g(s - t0, x) = sup E(s-t0,x)[e- (X - a)] = sup E[e-(+(s-t0))(Xx - a)]





= et0 sup E[e-(+s)(Xx - a)] = et0 g(s, x) .


Therefore the connected component of D that contains U must have the form

D(x0) = {(t, x); 0 < x < x0}

for

some

x0



a -r

.

Note that D cannot have any other components, for if V is a component of D disjoint from U then Ag < 0 in V and so, if y  V ,


Ey[g(Y )] = g(y) + Ey Ag(Yt)dt < g(y)
0

for all exit times  bounded by the exit time from an x-bounded strip in V . From this we conclude by Theorem 10.1.9 c) that g(y) = g(y), which implies
V = .
Put  (x0) = D(x0) and let us compute

g(s, x) = gx0 (s, x) = E(s,x)[g(Y(x0))] .

(10.2.9)

10.2 The Time-Inhomogeneous Case 211

From Chapter 9 we know that f = g is the (bounded) solution of the bound-

ary value problem



f s

+

rx

f x

f+(s12,x20x)2=2xef2-=s(x00

-

for a) .

0 < x < x0  

(10.2.10)

(Note that R × {0} does not contain any regular boundary points of D w.r.t.
Yt = (s + t, Xt).) If we try a solution of (10.2.10) of the form

f (s, x) = e-s(x)

we get the following 1-dimensional problem

- + rx (x) +

1 2

2

x2

(x)

=

0

for 0 < x < x0

(x0) = x0 - a .

The general solution  of (10.2.11) is

(10.2.11)

(x) = C1x1 + C2x2 , where C1, C2 are arbitrary constants and

i = -2

1 2

2

-

r

±

(r

-

1 2

2)2

+

22

(i = 1, 2) , 2 < 0 < 1 .

Since (x) is bounded as x  0 we must have C2 = 0 and the boundary requirement (x0) = x0 - a gives C1 = x0-1 (x0 - a). We conclude that the bounded solution f of (10.2.10) is

gx0 (s, x) = f (s, x) = e-s(x0 - a)

x x0

1
.

(10.2.12)

If we fix (s, x) then the value of x0 which maximizes gx0 (s, x) is easily seen

to be given by

x0

=

xmax

=

a1 1 - 1

(10.2.13)

(note that 1 > 1 if and only if r < ). Thus we have arrived at the candidate gxmax (s, x) for g(s, x) =
sup E(s,x)[e- (X - a)]. To verify that we indeed have gxmax = g it would

suffice to prove that gxmax is a supermeanvalued majorant of g (see Corollary 10.1.10). This can be done, but we do not give the details here, since this

problem can be solved more easily by Theorem 10.4.1 (see Example 10.4.2).

The conclusion is therefore that one should sell the assets the first time

the price of them reaches the value xmax profit obtained from this strategy is

=

a1 1 -1

.

The

expected

discounted

212 10. Application to Optimal Stopping

g(s, x) = gxmax (s, x) = e-s

1 - 1 a

1 -1

x 1

1
.

Remark. The reader is invited to check that the value x0 = xmax is the only value of x0 which makes the function
x  gx0 (s, x) (given by (10.2.9))
continuously differentiable at x0. This is not a coincidence. In fact, it illustrates a general phenomenon which is known as the high contact (or smooth fit) principle. See Samuelson (1965), McKean (1965), Bather (1970) and Shiryaev (1978). This principle is the basis of the fundamental connection between optimal stopping and variational inequalities. Later in this chapter we will discuss some aspects of this connection. More information can be found in Bensoussan and Lions (1978) and Friedman (1976). See also Brekke and Øksendal (1991).

10.3 Optimal Stopping Problems Involving an Integral

Let

dYt = b(Yt)dt + (Yt)dBt , Y0 = y

(10.3.1)

be an It^o diffusion in Rk. Let g: Rk  [0, ) be continuous and let f : Rk 
[0, ) be Lipschits continuous with at most linear growth. (These conditions
can be relaxed. See (10.1.37) and Theorem 10.4.1.) Consider the optimal stopping problem: Find G(y) and   such that





G(y) = sup Ey f (Yt)dt + g(Y ) = Ey f (Yt)dt + g(Y ) . (10.3.2)



0

0

This problem can be reduced to our original problem (10.1.2)­(10.1.3) by proceeding as follows: Define the It^o diffusion Zt in Rk × R = Rk+1 by

dZt =

dYt dWt

:=

b(Yt) f (Yt)

dt +

(Yt) 0

dBt ;

Z0 = z = (y, w) . (10.3.3)

Then we see that

with

G(y) = sup E(y,0)[W + g(Y )] = sup E(y,0)[G(Z )]





(10.3.4)

G(z): = G(y, w): = g(y) + w ; z = (y, w)  Rk × R .

(10.3.5)

10.3 Optimal Stopping Problems Involving an Integral 213

This is again a problem of the type (10.1.2)­(10.1.3) with Xt replaced by Zt and g replaced by G. Note that the connection between the characteristic
operators AY of Yt and AZ of Zt is given by

AZ (z)

=

AZ (y, w)

=

AY

(y,

w)

+

f

(y)

 w

,

  C2(Rk+1) .

(10.3.6)

In particular, if G(y, w) = g(y) + w  C2(Rk+1) then

AZ G(y, w) = AY g(y) + f (y) .
Example 10.3.1. Consider the optimal stopping problem

(x) = sup Ex e-tXtdt + e- X ,
 0
where dXt = Xtdt + XtdBt ; X0 = x > 0
is geometric Brownian motion (, ,  constants,  > 0). We put

(10.3.7)

dYt =

dt dXt

=

1 Xt

dt +

0 Xt

dBt ;

Y0 = (s, x)

and



 

dZt =

dYt dWt

1

0

=  Xt  dt +  Xt  dBt ;

e-tXt

0

Z0 = (s, x, w) .

Then with

f (y) = f (s, x) = e-sx , g(y) = e-sx

and G(s, x, w) = g(s, x) + w = e-sx + w

we have

AZ G

=

G s

+

x

G x

+

1 2

2x2

2G x2

+

e-s

x

G w

=

(-

+



+

)e-sx

.

Hence

U = {(s, x, w); AZ G(s, x, w) > 0} =

R3 

if  <  +  if    +  .

From this we conclude (see Exercise 10.6):

If    +  then   = 0

and G(s, x, w) = G(s, x, w) = e-sx + w .

If  <  <  +  then   does not exist

and

G(s,

x,

w) =

x -

e-s +w

.

If    then   does not exist and G =  .

(10.3.8)
(10.3.9) (10.3.10)

214 10. Application to Optimal Stopping

10.4 Connection with Variational Inequalities

The `high contact principle' says, roughly, that ­ under certain conditions ­ the solution g of (10.1.2)­(10.1.3) is a C1 function on Rn if g  C2(Rn). This is a useful information which can help us to determine g. Indeed, this
principle is so useful that it is frequently applied in the literature also in cases
where its validity has not been rigorously proved.
Fortunately it turns out to be easy to prove a sufficiency condition of
high contact type, i.e. a kind of verification theorem for optimal stopping, which makes is easy to verify that a given candidate for g(that we may have found by guessing or intuition) is actually equal to g. The result below is a
simplified variant of a result in Brekke and Øksendal (1991): In the following we fix a domain V in Rk and we let

dYt = b(Yt)dt + (Yt)dBt ; be an It^o diffusion in Rk. Define

Y0 = y

(10.4.1)

T = T (y, ) = inf{t > 0; Yt() / V } . Let f : Rk  R, g: Rk  R be continuous functions satisfying

(10.4.2)

T
(a) Ey[ |f (Yt)|dt] < 
0
and

for all y  Rk

(10.4.3)

(b) the family {g-(Y );  stopping time,   T } is uniformly integrable

w.r.t. Ry (the probability law of Yt), for all y  Rk.

(10.4.4)

Consider the following problem: Find (y) and    T such that

(y) = sup J  (y) = J  (y) ,
 T

(10.4.5)

where


J  (y) = Ey f (Yt)dt + g(Y )

for   T .

0
Note that since J0(y) = g(y) we have

(y)  g(y) for all y  V .

(10.4.6)

We can now formulate the variational inequalities. As usual we let

L = LY

=

k i=1

bi(y)

 yi

+

1 2

k
(T
i,j=1

)ij

(y)



2 yi

yj

be the partial differential operator which coincides with the generator AY of Yt on C02(Rk).

10.4 Connection with Variational Inequalities 215

Theorem 10.4.1 (Variational inequalities for optimal stopping). Suppose we can find a function : V  R such that
(i)   C1(V )  C(V ) (ii)   g on V and  = g on V .
Define D = {x  V ; (x) > g(x)} .
Suppose Yt spends 0 time on D a.s., i.e.
T
(iii) Ey[ XD(Yt)dt] = 0 for all y  V
0
and suppose that (iv) D is a Lipschitz surface, i.e. D is locally the graph of a function
h: Rk-1  R such that there exists K <  with

|h(x) - h(y)|  K|x - y| for all x, y .

Moreover, suppose the following: (v)   C2(V \ D) and the second order derivatives of  are locally
bounded near D
(vi) L + f  0 on V \ D
(vii) L + f = 0 on D (viii) D: = inf{t > 0; Yt / D} <  a.s. Ry for all y  V
and (ix) the family {(Y );   D} is uniformly integrable w.r.t. Ry, for all
y  V.

Then

(y) = (y) = sup Ey f (Yt)dt + g(Y ) ;
 T 0
and   = D
is an optimal stopping time for this problem.

yV

(10.4.7) (10.4.8)

Proof. By (i), (iv) and (v) we can find a sequence of functions j  C2(V )  C(V ), j = 1, 2, . . ., such that
(a) j   uniformly on compact subsets of V , as j   (b) Lj  L uniformly on compact subsets of V \ D, as j   (c) {Lj}j=1 is locally bounded on V .
(See Appendix D).
For R > 0 put TR = min(R, inf {t > 0; |Yt|  R}) and let   T be a stopping time. Let y  V . Then by Dynkin's formula

216 10. Application to Optimal Stopping

Ey[j (YTR )] = j (y) + Ey

 TR
Lj (Yt )dt
0

Hence by (a), (b), (c) and (iii) and the Fatou lemma

(10.4.9)

(y) = lim Ey
j

 TR
-Lj (Yt)dt + j (YTR )
0

 TR

 Ey

-L(Yt)dt + (YTR ) .

0

(10.4.10)

Therefore, by (ii), (iii), (vi) and (vii),

(y)  Ey

 TR
f (Yt)dt + g(YTR ) .
0

Hence by the Fatou lemma and (10.4.3), (10.4.4)

 TR



(y)  lim Ey

f (Yt)dt + g(YTR )  Ey f (Yt)dt + g(Y ) .

R

0

0

Since   T was arbitrary, we conclude that

(y)  (y) for all y  V .

(10.4.11)

If y / D then (y) = g(y)  (y) so by (10.4.11) we have

(y) = (y) and  =  (y, ): = 0 is optimal for y / D . (10.4.12)

Next,

suppose

y



D.

Let

{Dk } k=1

be

an

increasing


sequence

of

open

sets

Dk

such that Dk  D, Dk is compact and D = Dk. Put k = inf{t > 0; Yt  Dk},

k=1

k = 1, 2, . . . By Dynkin's formula we have for y  Dk,

k TR

(y)

=

lim
j

j

(y)

=

lim Ey
j

-Lj (Yt)dt + j (YkTR )

0

k TR

k TR

= Ey

-L(Yt)dt + (YkTR ) = Ey

f (Yt)dt + (YkTR )

0

0

So by uniform integrability and (ii), (vii), (viii) we get

10.4 Connection with Variational Inequalities 217

k TR

(y) = lim Ey
R,k

f (Yt)dt + (YkTR )
0

D

= Ey f (Yt)dt + g(YD ) = J D (y)  (y) .

0

Combining (10.4.11) and (10.4.13) we get

(y)  (y)  JD (y) = (y)

(10.4.13)

so

(y) = (y) and  (y, ): = D is optimal when y  D . From (10.4.12) and (10.4.14) we conclude that

(10.4.14)

(y) = (y) for all y  V .

Moreover, the stopping time  defined by

 (y, ) =

0 D

for y / D for y  D

is optimal. By Theorem 10.1.12 we conclude that D is optimal also.

Example 10.4.2. To illustrate Theorem 10.4.1 let us apply it to reconsider Example 10.2.2:
Rather than proving (10.2.8) and the following properties of D, we now simply guess/assume that D has the form

D = {(s, x); 0 < x < x0}

for some x0 > 0, which is intuitively reasonable. Then we solve (10.2.11) for arbitrary x0 and we arrive at the following candidate  for g:

(s, x) =

e-s e-s

(x0 - a)( (x - a)

x x0

)1

for 0 < x < x0 for x  x0 .

The requirement that   C1 (Theorem 10.4.1 (i)) gives the value (10.2.13) for x0. It is clear that   C2 outside D and by construction L = 0 on D. Moreover, conditions (iii), (iv), (viii) and (ix) clearly hold. It remains to
verify that

(ii) (s, x) > g(s, x) for 0 < x < x0, i.e. (s, x) > e-s(x - a) for 0 < x < x0 and
(v) L(s, x)  0 for x > x0, i.e. Lg(s, x)  0 for x > x0.

This is easily done by direct calculation (assuming r < ). We conclude that  = g and   = D is optimal (with the value (10.2.13) for x0).

218 10. Application to Optimal Stopping

Exercises

10.1. In each of the optimal stopping problems below find the supremum

g and ­ if it exists ­ an optimal stopping time  . (Here Bt denotes 1-dimensional Brownian motion)

a) g(x) = sup Ex[B2]

b) g(x) = sup Ex[|B |p],

where p > 0. c) g(x) = sup Ex[e-B2 ]



d) g(s, x) = sup E(s,x)[e-(s+)cosh B ]



where



>

0

and

cosh

x

=

1 2

(ex

+

e-x).

10.2. a) Prove that the only nonnegative (Bt -) superharmonic functions in R2 are the constants.
(Hint: Suppose u is a nonnegative superharmonic function and that there exist x, y  R2 such that

u(x) < u(y) .

Consider

Ex[u(B )] ,

where  is the first hitting time for Bt of a small disc centered at y).

b) Prove that the only nonnegative superharmonic functions in R are the constants and use this to find g(x) when

g(x) =

xe-x 0

for x > 0 for x  0 .

c) Let   R, n  3 and define, for x  Rn,

f(x) =

|x| 1

for |x|  1 for |x| < 1 .

For what values of  is f(·) (Bt)-) harmonic for |x| > 1 ? Prove that f is superharmonic in Rn iff   [2 - n, 0] .

10.3. Find g,   such that
g(s, x) = sup E(s,x)[e-(s+)B2] = E(s,x)[e-(s+)B2 ] ,

where Bt is 1-dimensional Brownian motion,  > 0 is constant. Hint: First assume that the continuation region has the form

D = {(s, x); -x0 < x < x0} for some x0 and then try to determine x0. Then apply Theorem 10.4.1.

Exercises 219

10.4. Let Xt be an It^o diffusion on Rn and g: Rn  R+ a continuous reward function. Define

g (x) = sup{Ex[g(X )] ;  stopping time, Ex[ ] < } .

Show that g = g. (Hint: If  is a stopping time put k =   k for k = 1, 2, . . . and consider
Ex[g(X ) · X< ]  Ex[ lim g(Xk )]) .
k
10.5. With g, r,  as in Example 10.2.2 prove that a) if r >  then g = , b) if r =  then g(s, x) = xe-s.
10.6. Prove statements (10.3.8), (10.3.9), (10.3.10) in Example 10.3.1.
10.7. As a supplement to Exercise 10.4 it is worth noting that if g is not bounded below then the two problems

g(x) = sup{Ex[g(X )] ;  stopping time}

and

g (x) = sup{Ex[g(X )] ;  stopping time, Ex[ ] < }

need not have the same solution. For example, if g(x) = x, Xt = Bt  R prove that
g(x) =  for all x  R

while

g (x) = x for all x  R .

(See Exercise 7.4.)

10.8. Give an example with g not bounded below where Theorem 10.1.9 a) fails. (Hint: See Exercise 10.7.)

10.9. Solve the optimal stopping problem


(x) = sup Ex e-tBt2dt + e- B2 .
 0
10.10. Prove the following simple, but useful, observation, which can be regarded as an extension of (10.1.35): Let W = {(s, x);  with g(s, x) < E(s,x)[g(s + , X )]}. Then W  D.

220 10. Application to Optimal Stopping

10.11. Consider the optimal stopping problem

g(s, x) = sup E(s,x)[e-(s+)B+] ,

where Bt  R and x+ = max{x, 0}. a) Use the argument for (10.2.8) and Exercise 10.10 to prove that the
continuation region D has the form

D = {(s, x); x < x0}

for some x0 > 0. b) Determine x0 and find g. c) Verify the high contact principle:

g x

=

g x

where g(t, x) = e-tx+.

when (s, x) = (s, x0) ,

10.12. The first time the high contact principle was formulated seems to be in a paper by Samuelson (1965), who studied the optimal time for selling an asset, if the reward obtained by selling at the time t and when price is  is given by

g(t, ) = e-t( - 1)+ .

The price process is assumed to be a geometric Brownian motion Xt given by
dXt = rXtdt + XtdBt , X0 = x > 0 ,
where r < . In other words, the problem is to find g,   such that
g(s, x) = sup E(s,x)[e-(s+)(X -1)+] = E(s,x)[e-(s+)(X -1)+] .

a) Use the argument for (10.2.8) and Exercise 10.10 to prove that the continuation region D has the form

D = {(s, x); 0 < x < x0}

for

some

x0

>

 -r

.

b)

For

a

given

x0

>

 -r

solve

the

boundary

value

problem





f s

+

rx

f x

+

1 2

2

x2

2f x2

=0

for 0 < x < x0



f (s, 0) = 0 f (s, x0) = e-s(x0 - 1)+

by trying f (s, x) = e-s(x).

Exercises 221

c) Determine x0 by using the high contact principle, i.e. by using that

f x

=

g x

when x = x0 .

d) With f, x0 as in b), c) define

(s, x) =

f (s, x) ; e-s(x - 1)+ ;

x < x0 x  x0 .

Use Theorem 10.4.1 to verify that  = g and that   = D is optimal.

10.13. (A resource extraction problem)
Suppose the price Pt of one unit of a resource (e.g. gas, oil) at time t is varying like a geometric Brownian motion

dPt = Ptdt + PtdBt ; P0 = p

where Bt is 1-dimensional Brownian motion and ,  are constants. Let Qt denote the amount of remaining resources at time t. Assume that the rate of extraction is proportional to the remaining amount, so that
dQt = -Qtdt ; Q0 = q
where  > 0 is a constant. If the running cost rate is K > 0 and we stop the extraction at the time  =  () then the expected total discounted profit is given by


J  (s, p, q) = E(s,p,q) (PtQt - K)e-(s+t)dt + e-(s+)g(P , Q ) ,
0

where  > 0 is the discounting exponent and g(p, q) is a given bequest function giving the value of the remaining resource amount q when the price is p.

a) Write down the characteristic operator A of the diffusion process

 dt
dXt =  dPt  ; dQt

X0 = (s, p, q)

and formulate the variational inequalities of Theorem 10.4.1 corresponding to the optimal stopping problem

G(s, p, q) = sup J  (s, p, q) = J  (s, p, q) .


222 10. Application to Optimal Stopping

b) Assume that g(p, q) = pq and find the domain U corresponding to (10.1.34), (10.3.7), i.e.

U = {(s, p, q); A(e-sg(p, q)) + f (s, p, q) > 0} ,

where

f (s, p, q) = e-s(pq - K) .

Conclude that

(i) if    then   = 0 and G(s, p, q) = pqe-s

(ii)

if



<



then

D



{(s, p, q); pq

>

K -

}.

c) As a candidate for G when  <  we try a function of the form

(s, p, q) =

e-spq ;

0 < pq  y0

e-s(pq) ; pq > y0

for a suitable : R  R, and a suitable y0. Use Theorem 10.4.1 to determine , y0 and to verify that with this choice of , y0 we have  = G and   = inf{t > 0; PtQt  y0}, if  <  <  + . d) What happens if  +    ?

10.14. (Finding the optimal investment time (I)) Solve the optimal stopping problem

G(s, p) = sup E(s,p)



e-(s+t)Ptdt - Ce-(s+ ) ,


where

dPt = Ptdt + PtdBt ; P0 = p ,

Bt is 1-dimensional Brownian motion and , , , C are constants,

0 <  <  and C > 0. (We may interprete this as the problem of

finding the optimal time  for investment in a project. The profit rate

after investment is Pt and the cost of the investment is C. Thus G

gives the maximal expected discounted net profit.)







Hint: Write e-(s+t)Ptdt = e-s[ e-tPtdt - e-tPtdt]. Compute

 

0

0

E[ e-tPtdt] by using the solution formula for Pt (see Chapter 5) and

0

then apply Theorem 10.4.1 to the problem


(s, p) = sup E(s,p) - e-(s+t)Ptdt - Ce-(s+) .
 0

10.15. Let Bt be 1-dimensional Brownian motion and let  > 0 be constant.

Exercises 223

a) Show that the family

{e- B ;  stopping time}

is uniformly integrable w.r.t. P x. b) Solve the optimal stopping problem

g(s, x) = sup E(s,x)[e-(s+)(B - a)]

when a > 0 is constant. This may be regarded as a variation of Example 10.2.2/10.4.2 with the price process represented by Bt rather than Xt.
10.16. (Finding the optimal investment time (II)) Solve the optimal stopping problem

G(s, p) = sup E(s,p)



e-(s+t)Ptdt - Ce-(s+ )


where

dPt = µ dt +  dBt ; P0 = p

with µ,  = 0 constants. (Compare with Exercise 10.14.)

224 10. Application to Optimal Stopping

11. Application to Stochastic Control

11.1 Statement of the Problem

Suppose that the state of a system at time t is described by an It^o process Xt of the form

dXt = dXtu = b(t, Xt, ut)dt + (t, Xt, ut)dBt ,

(11.1.1)

where Xt  Rn, b: R × Rn × U  Rn, : R × Rn × U  Rn×m and Bt is mdimensional Brownian motion. Here ut  U  Rk is a parameter whose value we can choose in the given Borel set U at any instant t in order to control
the process Xt. Thus ut = u(t, ) is a stochastic process. Since our decision at time t must be based upon what has happened up to time t, the function   u(t, ) must (at least) be measurable w.r.t. Ft(m), i.e. the process ut must be Ft(m)-adapted. Thus the right hand side of (11.1.1) is well-defined as a stochastic integral, under suitable assumptions on the functions b and . At
the moment we will not specify the conditions on b and  further, but simply
assume that the process Xt satisfying (11.1.1) exists. See further comments on this in the end of this chapter.
Let {Xhs,x}hs be the solution of (11.1.1) such that Xss,x = x, i.e.

h

h

Xhs,x = x + b(r, Xrs,x, ur)dr + (r, Xrs,x, ur)dBr ;

s

s

hs

and let the probability law of Xt starting at x for t = s be denoted by Qs,x, so that

Qs,x[Xt1  F1, . . . , Xtk  Fk] = P 0[Xts1,x  F1, . . . , Xtsk,x  Fk] (11.1.2)
for s  ti, Fi  Rn; 1  i  k, k = 1, 2, . . . Let F : R×Rn ×U  R (the "utility rate" function) and K: R×Rn  R
(the "bequest" function) be given continuous functions, let G be a fixed domain in R × Rn and let T be the first exit time after s from G for the process {Xrs,x}rs, i.e.

T = T s,x() = inf{r > s; (r, Xrs,x()) / G}   .

(11.1.3)

226 11. Application to Stochastic Control

Suppose

E s,x

T
|F ur (r, Xr)|dr + |K(T , XT )|X{T <}
s

<

for all s, x, u (11.1.4)

where F u(r, z) = F (r, z, u). Then we define the performance function Ju(s, x) by

T
J u(s, x) = Es,x F ur (r, Xr)dr + K(T , XT )X{T <} .
s
To obtain an easier notation we introduce

(11.1.5)

Yt = (s + t, Xss+,xt) for t  0, Y0 = (s, x)

and we observe that if we substitute this in (11.1.1) we get the equation

dYt = dYtu = b(Yt, ut)dt + (Yt, ut)dBt .

(11.1.6)

(Strictly speaking, the u, b and  in (11.1.6) are slightly different from the u, b and  in (11.1.1).) The probability law of Yt starting at y = (s, x) for t = 0 is (with slight abuse of notation) also denoted by Qs,x = Qy.
Note that

T

T -s

T

F ur (r, Xr)dr =

F us+t (s + t, Xs+t)dt = F us+t (Yt)dt ,

s

0

0

where

T : = inf{t > 0; Yt / G} = T - s .

(11.1.7)

Moreover,

K(T , XT ) = K(YT -s) = K(YT ) .

Therefore the performance function may be written in terms of Y as follows, with y = (s, x),

T
J u(y) = Ey F ut (Yt)dt + K(YT )X{T <} .
0

(11.1.8)

(Strictly speaking this ut is a time shift of the ut in (11.1.6).) The problem is ­ for each y  G ­ to find the number (y) and a control
u = u(t, ) = u(y, t, ) such that

(y): = sup J u(y) = J u (y)
u(t,)

(11.1.9)

11.2 The Hamilton-Jacobi-Bellman Equation 227
where the supremum is taken over all Ft(m)-adapted processes {ut} with values in U . Such a control u ­ if it exists ­ is called an optimal control and  is called the optimal performance or the value function. Examples of types of control functions that may be considered are:
(1) Functions of the form u(t, ) = u(t) i.e. not depending on . These controls are sometimes called deterministic or open loop controls.
(2) Processes {ut} which are Mt-adapted, i.e. for each t the function   u(t, ) is Mt-measurable, where Mt is the -algebra generated by {Xru; r  t}. These controls are called closed loop or feedback controls.
(3) The controller has only partial knowledge of the state of the system. More precisely, to the controller's disposal are only (noisy) observations Rt of Xt, given by an It^o process of the form
dRt = a(t, Xt)dt + (t, Xt)dBt ,
where B is a Brownian motion (not necessarily related to B). Hence the control process {ut} must be adapted w.r.t. the -algebra Nt generated by {Rs; s  t}. In this situation the stochastic control problem is linked to the filtering problem (Chapter 6). In fact, if the equation (11.1.1) is linear and the performance function is integral quadratic (i.e. F and K are quadratic) then the stochastic control problem splits into a linear filtering problem and a corresponding deterministic control problem. This is called the Separation Principle. See Example 11.2.4. (4) Functions u(t, ) of the form u(t, ) = u0(t, Xt()) for some function u0: Rn+1  U  Rk. In this case we assume that u does not depend on the starting point y = (s, x): The value we choose at time t only depends on the state of the system at this time. These are called Markov controls, because with such u the corresponding process Xt becomes an It^o diffusion, in particular a Markov process. In the following we will not distinguish between u and u0. Thus we will identify a function u: Rn+1  U with the Markov control u(Y ) = u(t, Xt) and simply call such functions Markov controls.

11.2 The Hamilton-Jacobi-Bellman Equation

Let us first consider only Markov controls

u = u(t, Xt()) .

Introducing Yt = (s + t, Xs+t) (as explained earlier) the system equation

becomes

dYt = b(Yt, u(Yt))dt + (Yt, u(Yt))dBt .

(11.2.1)

For v  U and f  C02(R × Rn) define

228 11. Application to Stochastic Control

(Lvf )(y)

=

f s

(y)

+

n i=1

bi

(y,

v)

f xi

+

n i,j=1

aij

(y,

v)

2f xixj

(11.2.2)

where of the

aij

=

1 2

(T

)ij

,

y

=

(s, x)

function u the solution Yt

and x = Ytu

= is

(x1, . . . an It^o

, xn). Then for each choice diffusion with generator A

given by

(Af )(y) = (Lu(y)f )(y) for f  C02(R × Rn) (see Theorem 7.3.3) .
For v  U define F v(y) = F (y, v). The first fundamental result in stochastic control theory is the following:

Theorem 11.2.1 (The Hamilton-Jacobi-Bellman (HJB) equation (I)). Define
(y) = sup{Ju(y); u = u(Y ) Markov control} .
Suppose that   C2(G)  C(G ) satisfies


Ey |(Y)| + |Lv(Yt)|dt < 
0

for all bounded stopping times   T , all y  G and all v  U . Moreover, suppose that T <  a.s. Qy for all y  G and that an optimal Markov control u exists. Suppose G is regular for Ytu (Definition 9.2.8). Then

sup{F v(y) + (Lv)(y)} = 0
vU

for all y  G

(11.2.3)

and

(y) = K(y) for all y  G .

(11.2.4)

The supremum in (11.2.3) is obtained if v = u(y) where u(y) is optimal. In other words,

F (y, u(y)) + (Lu(y))(y) = 0 for all y  G .

(11.2.5)

Proof. The last two statements are easy to prove: Since u = u(y) is optimal we have

T
(y) = J u (y) = Ey F (Ys, u(Ys))ds + K(YT ) .
0
If y  G then T = 0 a.s. Qy (since G is regular) and (11.2.4) follows. By the solution of the Dirichlet-Poisson problem (Theorem 9.3.3)

(Lu(y))(y) = -F (y, u(y)) for all y  G ,

11.2 The Hamilton-Jacobi-Bellman Equation 229

which is (11.2.5). We proceed to prove (11.2.3). Fix y = (s, x)  G and choose a Markov control u. Let   T be a stopping time.
Since
T
J u(y) = Ey F u(Yr)dr + K(YT ) ,
0
we get by the strong Markov property (7.2.5), combined with (7.2.6) and (9.3.7)

T

Ey[J u(Y)] = Ey EY F u(Yr)dr + K(YT )

0 T

= Ey Ey  F u(Yr)dr + K(YT ) F

0 T

= Ey Ey F u(Yr)dr + K(YT )|F



T



= Ey F u(Yr)dr + K(YT ) - F u(Yr)dr

0
= J u(y) - Ey

0 
F u(Yr)dr .

0

So


J u(y) = Ey F u(Yr)dr + Ey[J u(Y)] .

(11.2.6)

0

Now let W  G be of the form W = {(r, z)  G; r < t1} where s < t1. Put

 = inf{t  0; Yt  W }. Suppose an optimal control u(y) = u(r, z) exists

and choose

u(r, z) =

v u(r, z)

if (r, z)  W if (r, z)  G \ W

where v  U is arbitrary. Then

(Y) = J u (Y) = J u(Y)

(11.2.7)

230 11. Application to Stochastic Control

and therefore, combining (11.2.6) and (11.2.7) we obtain


(y)  J u(y) = Ey F v(Yr)dr + Ey[(Y)] .
0
Since   C2(G) we get by Dynkin's formula

(11.2.8)


Ey[(Y)] = (y) + Ey (Lu)(Yr)dr ,
0

which substituted in (11.2.8) gives





(y)  Ey F v(Yr)dr + (y) + Ey (Lv)(Yr)dr

0

0

or


Ey (F v(Yr) + (Lv)(Yr))dr  0 .

0

So


Ey (F v(Yr) + (Lv)(Yr))dr

0
E y []

 0 for all such W .

Letting t1  s we obtain, since F v(·) and (Lv)(·) are continuous at y, that F v(y) + (Lv)(y)  0, which combined with (11.2.5) gives (11.2.3). That completes the proof.

Remark. The HJB (I) equation states that if an optimal control u exists, then we know that its value v at the point y is a point v where the function

v  F v(y) + (Lv)(y) ; v  U

11.2 The Hamilton-Jacobi-Bellman Equation 231

attains its maximum (and this maximum is 0). Thus the original stochastic control problem is associated to the easier problem of finding the maximum of a real function in U  Rk. However, the HJB (I) equation only states that it is necessary that v = u(y) is the maximum of this function. It is just as important to know if this is also sufficient: If at each point y we have found v = u0(y) such that F v(y) + (Lv)(y) is maximal and this maximum is 0, will u0(Y ) be an optimal control? The next result states that (under some conditions) this is actually the case:
Theorem 11.2.2 (The HJB (II) equation ­ a converse of HJB (I)).

Let  be a function in C2(G)  C(G ) such that, for all v  U , F v(y) + (Lv)(y)  0 ; y  G

(11.2.9)

with boundary values

and such that

lim
tT

(Yt)

=

K (YT

)

·

X{T

<}

a.s. Qy

(11.2.10)

{(Y )}T is uniformly Qy-integrable for all Markov

controls u and all y  G .

(11.2.11)

Then (y)  Ju(y) for all Markov controls u and all y  G .

(11.2.12)

Moreover, if for each y  G we have found u0(y) such that F u0(y)(y) + (Lu0(y))(y) = 0

(11.2.13)

then u0 = u0(y) is a Markov control such that (y) = J u0 (y)

and hence u0 must be an optimal control and (y) = (y).
Proof. Assume that  satisfies (11.2.9) and (11.2.10) above. Let u be a Markov control. Since Lu  -F u in G we have by Dynkin's formula
TR
Ey[(YTR )] = (y) + Ey (Lu)(Yr)dr
0 TR
 (y) - Ey F u(Yr)dr
0

232 11. Application to Stochastic Control

where

TR = min{R, T, inf{t > 0; |Yt|  R}}

for all R < . This gives, by (11.1.4), (11.2.10) and (11.2.11)

(11.2.14)

(y)  Ey  Ey

TR
F u(Yr)dr + (YTR )
0 T
F u(Yr)dr + K(YT )X{T <}
0

= J u(y)

as R  , which proves (11.2.12). If u0 is such that (11.2.13) holds, then the calculations above give equality and the proof is complete.

The HJB equations (I), (II) provide a very nice solution to the stochastic
control problem in the case where only Markov controls are considered. One
might feel that considering only Markov controls is too restrictive, but for-
tunately one can always obtain as good performance with a Markov control as with an arbitrary Ft(m)-adapted control, at least if some extra conditions are satisfied:

Theorem 11.2.3. Let

M (y) = sup{Ju(y); u = u(Y ) Markov control}

and a(y) = sup{J u(y); u = u(t, ) Ft(m)-adapted control} .

Suppose there exists an optimal Markov control u0 = u0(Y ) for the Markov control problem (i.e. M (y) = Ju0 (y) for all y  G) such that all the boundary points of G are regular w.r.t. Ytu0 and that M is a function in C2(G)C(G ) satisfying


Ey |M (Y)| + |LuM (Yt)|dt < 

(11.2.15)

0
for all bounded stopping times   T , all adapted controls u and all y  G. Then
M (y) = a(y) for all y  G .

Proof. Let  be a function in C2(G)  C(G ) satisfying (11.2.15) and

F v(y) + (Lv)(y)  0 for all y  G, v  U

(11.2.16)

and

(y) = K(y) for all y  G .

(11.2.17)

11.2 The Hamilton-Jacobi-Bellman Equation 233

Let ut() = u(t, ) be an Ft(m)-adapted control. Then Yt is an It^o process given by
dYt = b(Yt, ut)dt + (Yt, ut)dBt
so by Lemma 7.3.2, with TR as in (11.2.14),

where

TR
Ey[(YTR )] = (y) + Ey (Lu(t,))(Yt)dt ,
0

(Lu(t,))(y) =

=

 t

(y)

+

n i=1

bi(y,

u(t,

))

 xi

(y)

+

n
aij
i,j=1

(y,

u(t,

))

2 xixj

(y)

,

with

aij

=

1 2

(T

)ij

.

Thus

by

(11.2.16)

and

(11.2.17)

this

gives

TR
Ey[(YTR )]  (y) - Ey F (Yt, u(t, ))dt .
0

(11.2.18)

Letting R   we obtain

(y)  Ju(y) .

(11.2.19)

But by Theorem 11.2.1 the function (y) = M (y) satisfies (11.2.16) and (11.2.17). So by (11.2.19) we have M (y)  a(y) and Theorem 11.2.3 follows.

Remark. The theory above also applies to the corresponding minimum

problem

 (y) = inf J u(y) = J u (y) .
u

(11.2.20)

To see the connection we note that

T

 (y) = - sup{-Ju(y)} = - sup Ey -F u(Yt)dt - K(Yt)

u

u

0

so - coincides with the solution  of the problem (11.1.9), but with F replaced by -F and K replaced by -K. Using this, we see that the HJB equations apply to  also but with reverse inequalities. For example, equation (11.2.3) for  gets for  the form

inf {F v(y) + (Lv )(y)} = 0 for all y  G .
vU

(11.2.21)

We now illustrate the results by some examples:

234 11. Application to Stochastic Control

Example 11.2.4 (The linear stochastic regulator problem).
Suppose that the state Xt of the system at time t is given by a linear stochastic differential equation:

dXt = (HtXt + Mtut)dt + tdBt , t  s ; Xs = x

(11.2.22)

and the cost is of the form

t1
J u(s, x) = Es,x {XtT CtXt + uTt Dtut}dt + XtT1 RXt1 ,
s

s  t1

(11.2.23)

where all the coefficients Ht  Rn×n, Mt  Rn×k, t  Rn×m, Ct  Rn×n, Dt  Rk×k and R  Rn×n are t-continuous and deterministic. We assume that Ct and R are symmetric, nonnegative definite and Dt is symmetric, positive definite, for all t. We also assume that t1 is a deterministic time.
The problem is then to choose the control u = u(t, Xt)  Rk such that it minimizes Ju(s, x). We may interpret this as follows: The aim is to find a
control u which makes |Xt| small fast and such that the energy used ( uT Du) is small. The sizes of Ct and R reflect the cost of having large values of |Xt|, while the size of Dt reflects the cost (energy) of applying large values of |ut|.
In this case the HJB-equation for  (s, x) = inf Ju(s, x) becomes
u

0 = inf{F v(s, x) + (Lv )(s, x)}
v

=

 s

+ inf
v

xT

Csx

+

vT

Dsv

+

n
(Hsx
i=1

+

Msv)i

 xi

+

1 2

n
(ssT
i,j=1

)ij

2 xixj

for s < t1

(11.2.24)

and  (t1, x) = xT Rx .
Let us try to find a solution  of (11.2.24)­(11.2.25) of the form

(11.2.25)

(t, x) = xT Stx + at

(11.2.26)

where S(t) = St  Rn×n is symmetric, nonnegative definite, at  R and both at and St are continuously differentiable w.r.t. t (and deterministic). In order to use Theorem 11.2.2 we need to determine St and at such that

inf{F v(t, x) + (Lv)(t, x)} = 0
v

for t < t1

(11.2.27)

and

(t1, x) = xT Rx .

(11.2.28)

11.2 The Hamilton-Jacobi-Bellman Equation 235

To obtain (11.2.28) we put

Using (11.2.26) we get

St1 = R at1 = 0 .

(11.2.29) (11.2.30)

F v(t, x) + (Lv)(t, x) = xT Stx + at + xT Ctx + vT Dtv + +(Htx + Mtv)T (Stx + StT x) + (ttT )ij Sij ,
i,j

(11.2.31)

where

St

=

d dt

St

,

at

=

d dt

at.

The

minimum

of

this

expression

is

obtained

when

 vi

(F

v (t,

x)

+

(Lv )(t,

x))

=

0

;

i = 1, . . . , k

i.e. when

2Dtv + 2MtT Stx = 0

i.e. when

v = -Dt-1MtT Stx .

(11.2.32)

We substitute this value of v in (11.2.31) and obtain

F v(t, x) + (Lv)(t, x) = = xT Stx + at + xT Ctx + xT StMtDt-1DtDt-1MtT Stx +(Htx - MtDt-1MtT Stx)T 2Stx + tr(T S)t = xT (St + Ct - StMtDt-1MtT St + 2HtT St)x + at + tr(T S)t ,
where tr denotes the (matrix) trace. We obtain that this is 0 if we choose St such that

St = -2HtT St + StMtDt-1MtT St - Ct ;

t < t1

(11.2.33)

and at such that

at = -tr(T S)t ;

t < t1 .

(11.2.34)

We recognize (11.2.33) as a Riccati type equation from linear filtering the-

ory (see (6.3.4)). Equation (11.2.33) with boundary condition (11.2.29) de-

termines St uniquely. Combining (11.2.34) with the boundary condition (11.2.30) we obtain

t1

at = tr(T S)sds .

(11.2.35)

t

With such a choice of St and at we see that (11.2.27) and (11.2.28) hold, so by Theorem 11.2.2 we conclude that

u(t, x) = -Dt-1MtT Stx ,

t < t1

(11.2.36)

236 11. Application to Stochastic Control

is an optimal control and the minimum cost is

t1
 (s, x) = xT Ssx + tr(T S)tdt ,
s

s < t1 .

(11.2.37)

This formula shows that the extra cost due to the noise in the system is given by
t1
as = tr(T S)tdt .
s
The Separation Principle (see Davis (1977), Davis and Vinter (1985) or Fleming and Rishel (1975)) states that if we had only partial knowledge of the state Xt of the system, i.e. if we only had noisy observations

dZt = gtXtdt + tdBt

(11.2.38)

to our disposal, then the optimal control u(t, ) (required to be Gt-adapted, where Gt is the -algebra generated by {Zr; r  t}), would be given by

u(t, ) = -Dt-1MtT StXt() ,

(11.2.39)

where Xt is the filtered estimate of Xt based on the observations {Zr; r  t}, given by the Kalman-Bucy filter (6.3.3). Comparing with (11.2.36) we see that the stochastic control problem in this case splits into a linear filtering problem and a deterministic control problem.

An important field of applications of the stochastic control theory is economics and finance. Therefore we illustrate the results above by applying them to a simple case of optimal portfolio diversification. This problem has been considered in more general settings by many authors, see for example Markowitz (1976), Merton (1971), Harrison and Pliska (1981), Aase (1984), Karatzas, Lehoczky and Shreve (1987) and the survey article Duffie (1994) and the references therein.

Example 11.2.5 (An optimal portfolio selection problem).
Let Xt denote the wealth of a person at time t. Suppose that the person has the choice of two different investments. The price p1(t) at time t of one of the assets is assumed to satisfy the equation

dp1 dt

=

p1(a + Wt)

(11.2.40)

where Wt denotes white noise and a,  > 0 are constants measuring the average relative rate of change of p and the size of the noise, respectively. As we have discussed earlier we interpret (11.2.40) as the (It^o) stochastic differential equation

11.2 The Hamilton-Jacobi-Bellman Equation 237

dp1 = p1adt + p1dBt .

(11.2.41)

This investment is called risky, since  > 0. We assume that the price p2 of the other asset satisfies a similar equation, but with no noise:

dp2 = p2bdt .

(11.2.42)

This investment is called safe. So it is natural to assume b < a. At each
instant the person can choose how big fraction u of his wealth he will invest
in the risky asset, thereby investing the fraction 1 - u in the safe one. This gives the following stochastic differential equation for the wealth Xt = Xtu :

dXt = uXtadt + uXtdBt + (1 - u)Xtbdt = Xt(au + b(1 - u))dt + uXtdBt .

(11.2.43)

Suppose that, starting with the wealth Xt = x > 0 at time t, the person wants to maximize the expected utility of the wealth at some future time
t0 > t. If we allow no borrowing (i.e. require X  0) and are given a utility function N : [0, )  [0, ), N (0) = 0 (usually assumed to be increasing and concave) the problem is to find (s, x) and a (Markov) control u = u(t, Xt), 0  u  1, such that

(s, x) = sup{Ju(s, x); u Markov control, 0  u  1} = Ju (s, x) ,

where J u(s, x) = Es,x[N (XTu)]

(11.2.44)

and T is the first exit time from the region G = {(r, z); r < t0, z > 0}. This is a performance criterion of the form (11.1.6)/(11.1.8) with F = 0 and K = N . The differential operator Lv has the form (see (11.2.2))

(Lvf )(t, x)

=

f t

+ x(av

+

b(1

-

v))

f x

+

1 2

2v2

x2

2f x2

.

The HJB equation becomes

(11.2.45)

sup{(Lv)(t, x)} = 0 ,
v

for (t, x)  G ;

and

(11.2.46)

(t, x) = N (x) for t = t0 , (t, 0) = N (0) for t < t0 . (11.2.47)

Therefore, for each (t, x) we try to find the value v = u(t, x) which maximizes the function

(v)

=

Lv 

=

 t

+

x(b

+ (a -

b)v)

 x

+

1 2

2v2

x2

2 x2

.

(11.2.48)

If

x: =

 x

>

0

and

xx: =

2 x2

<

0,

the

solution

is

238 11. Application to Stochastic Control

v

=

u(t, x)

=

-

(a - x2

b)x xx

.

(11.2.49)

If we substitute this into the HJB equation (11.2.48) we get the following nonlinear boundary value problem for  :

t

+ bxx

-

(a - b)2x2 22xx

=

0

for t < t0, x > 0

(11.2.50)

(t, x) = N (x) for t = t0 or x = 0 .

(11.2.51)

The problem (11.2.50), (11.2.51) is hard to solve for general N . Important examples of increasing and concave functions are the power functions

N (x) = xr where 0 < r < 1 .

(11.2.52)

If we choose such a utility function N , we try to find a solution of (11.2.50), (11.2.51) of the form
(t, x) = f (t)xr .

Substituting we obtain

(t, x) = e(t0-t)xr ,

(11.2.53)

where



=

br

+

(a-b)2 r 22 (1-r)

.

Using (11.2.49) we obtain the optimal control

u(t, x)

=

a-b 2(1 - r)

.

(11.2.54)

If

a-b 2 (1-r)



(0, 1)

this

is

the

solution

to

the

problem,

in

virtue

of

Theo-

rem 11.2.2. Note that u is in fact constant.

Another interesting choice of the utility function is N (x) = log x, called

the Kelly criterion. As noted by Aase (1984) (in a more general setting)

we may in this case obtain the optimal control directly by evaluating

Es,x[log(XT )] using Dynkin's formula:

Es,x[log(XT )] = = log x + Es,x

T

{au(t,

Xt)

+

b(1

-

u(t,

Xt))

-

1 2

2u2(t,

Xt)}dt

s

since Lv(log x) = av + b(1 - v) - So it is clear that Ju(s, x) =

E21 s,2xv[l2o.g(XT )]

is

maximal

if

we

for

all

r, z

choose u(s, z) to have the value of v which maximizes

i.e. we choose

av

+

b(1

-

v)

-

1 2

2

v2

11.2 The Hamilton-Jacobi-Bellman Equation 239

v

=

u(t, Xt)

=

a-b 2

for all t,  .

(11.2.55)

So this is the optimal control if the Kelly criterion is used. Similarly, this direct method also gives the optimal control when N (x) = xr (See Exer-

cise 11.8).

Example 11.2.6. Finally we include an example which shows that even quite simple ­ and apparently innocent ­ stochastic control problems can lead us beyond the reach of the theory developed in this chapter:
Suppose the system is a 1-dimensional It^o integral

dXt = dXtu = u(t, )dBt , t  s; Xs = x > 0

(11.2.56)

and consider the stochastic control problem

(t, x) = sup Et,x[K(Xu)] ,
u

(11.2.57)

where  is the first exit time from G = {(r, z); r  t1, z > 0} for Yt = (s + t, Xss+,xt) and K is a given bounded continuous function.

Intuitively, we can think of the system as the state of a game which behaves like an "excited" Brownian motion, where we can control the size u of the excitation at every instant. The purpose of the control is to maximize the expected payoff K(Xt1 ) of the game at a fixed future time t1.
Assuming that   C2 and that u exists we get by the HJB (I) equation

sup
vR

 t

+

1 2

v2

2 x2

=0

for t < t1, (t1, x) = K(x) .

(11.2.58)

From this we see that we necessarily have

240 11. Application to Stochastic Control

2 x2



0

,

v

2 x2

=

0

and

 t

=

0

for t < t1 ,

(11.2.59)

where v is the value of v  R which gives the supremum in (11.2.58). But

if

 t

=

0,

then

(t, x)

=

(t1, x)

=

K (x).

However,

this

cannot

possibly

be

the

solution

in

general,

because

we

have

not

assumed

that

2K x2



0

­

in

fact,

K was not even assumed to be differentiable.

What went wrong? Since the conclusion of the HJB (I) equation was

wrong, the assumptions cannot hold. So either  is not C2 or u does not

exist, or both.

To simplify the problem assume that

K(x) =

x2 ; 1;

0x1 x>1.

Then considering the figure above and using some intuition we see that it
is optimal to excite as much as possible if Xt is in the strip 0 < x < 1 to avoid exiting from G in the interval {t1} × (0, 1). Using that Xt is just a time change of Brownian motion (see Chapter 8) we conclude that this optimal control leads to a process X which jumps immediately to the value 1 with
probability x and to the value 0 with probability 1 - x, if the starting point
is x  (0, 1). If the starting point is x  [1, ) we simply choose our control
to be zero. In other words, heuristically we should have

u(t, x) =

 if 0 if

x  (0, 1) x  [1, )

(11.2.60)

with corresponding expected payoff

(s, x) = Es,x[K(Xt1 )] =

x if 0  x  1 1 if x > 1 .

(11.2.61)

Thus we see that our candidate u for optimal control is not continuous (not even finite!) and the corresponding optimal process Xt is not an It^o diffusion (it is not even continuous). So to handle this case mathematically
it is necessary to enlarge the family of admissible controls (and the family of
corresponding processes). For example, one can prove an extended version of Theorem 11.2.2 which allows us to conclude that our choice of u above does
indeed give at least as good performance as any other Markov control u and that  given by (11.2.61) does coincide with the maximal expected payoff 
defined by (11.2.57).

This last example illustrates the importance of the question of existence in general, both of the optimal control u and of the corresponding solution
Xt of the stochastic differential equation (11.1.1). We briefly outline some results in this direction:

11.3 Stochastic control problems with terminal conditions 241

With certain conditions on b, , F, G and assuming that the set of control values is compact, one can show, using general results from nonlinear partial differential equations, that a smooth function  exists such that

sup{F v(y) + (Lv)(y)} = 0
v

for y  G

and (y) = K(y) for y  G .

Then by a measurable selection theorem one can find a (measurable) function

u(y) such that

F u (y) + (Lu )(y) = 0 ,

(11.2.62)

for a.a. y  G w.r.t. Lebesgue measure in Rn+1. Even if u is only known to be measurable, one can show that the corresponding solution Xt = Xtu of (11.1.1) exists (see Stroock and Varadhan (1979) for general results in this direction). Then by inspecting the proof of Theorem 11.2.2 one can see that it suffices to have (11.2.62) satisfied outside a subset of G with Green measure 0 (see Definition 9.3.4). Under suitable conditions on b and  one can in fact show that the Green measure is absolutely continuous w.r.t. Lebesgue measure. Thus by (11.2.62) (and a strengthened Theorem 11.2.2) u is an optimal control. We refer the reader to Fleming and Rishel (1975), Bensoussan and Lions (1978), Dynkin and Yushkevich (1979) and Krylov (1980) for details and further studies.

11.3 Stochastic control problems with terminal conditions

In many applications there are constraints on the types of Markov controls u to be considered, for example in terms of the probabilistic behaviour of Ytu at the terminal time t = T . Such problems can often be handled by applying
a kind of "Lagrange multiplier" method, which we now describe: Consider the problem of finding (y) and u(y) such that

where

(y) = sup J u(y) = J u (y)
uK
T

(11.3.1)

J u(y) = Ey F u(Ytu)dt + K(YTu) ,

(11.3.2)

0

and where the supremum is taken over the space K of all Markov controls u: Rn+1  U  Rk such that

Ey[Mi(YTu)] = 0 , i = 1, 2, . . . , l ,

(11.3.3)

242 11. Application to Stochastic Control

where M = (M1, . . . , Ml): Rn+1  Rl is a given continuous function,

Ey[|M (YTu)|] <  for all y, u .

(11.3.4)

Now we introduce a related, but unconstrained problem as follows:

For each   Rl and each Markov control u define

T
Ju(y) = Ey F u(Ytu)dt + K(YTu) +  · M (YTu)
0

(11.3.5)

where · denotes the inner product in Rl. Find (y) and u(y) such

that

(y)

=

sup
u

Ju(y)

=

Ju (y)

,

(11.3.6)

without terminal conditions.

Theorem 11.3.1. Suppose that we for all     Rl can find (y) and u solving the (unconstrained) stochastic control problem (11.3.5)­(11.3.6). Moreover, suppose that there exists 0   such that

Ey[M (YTu0 )] = 0 .

(11.3.7)

Then (y): = 0 (y) and u: = u0 solves the constrained stochastic control problem (11.3.1)­(11.3.3).

Proof. Let u be a Markov control,   . Then by the definition of u we have

T

Ey

F u (Ytu )dt + K(YTu ) +  · M (YTu ) = Ju (y)

0

T

 Ju(y) = Ey F u(Ytu)dt + K(YTu) +  · M (YTu) .

0

In particular, if  = 0 and u  K then

Ey[M (YTu0 )] = 0 = Ey[M (YTu)]

and hence by (11.3.8)

(11.3.8)

J u0 (y)  J u(y)

for all u  K .

Since u0  K the proof is complete. For an application of this result, see Exercise 11.11.

Exercises 243

Exercises

11.1. 11.2.

Write down the HJB equation for the problem

 (s, x) = inf Es,x
u


e-t(g(Xt) + u2t )dt
s

where

dXt = utdt + dBt ; Xt, ut, Bt  R ,

 > 0 is a constant and g: R  R is a given bounded, continuous

function. Show that if  satisfies the conditions of Theorem 11.2.1

and u exists then

u(t, x)

=

-

1 2

et

 x

.

Consider the stochastic control problem



0(s,

x)

=

inf
u

E s,x

e-tf (ut, Xt)dt ,

s

where

dXt = dXtu = b(ut, Xt)dt + (ut, Xt)dBt Xt  Rn, ut  Rk, Bt  Rm ,
f is a given bounded continuous real function,  > 0 and the inf is taken over all time-homogeneous Markov controls u, i.e. controls u of the form u = u(Xt). Prove that
0(s, x) = e-s(x) , where (x) =  (0, x) .
(Hint: By definition of Es,x we have

11.3.

E s,x





e-tf (u(Xt), Xt)dt] = E[ e-(s+t)f (u(Xss+,xt), Xss+,xt)dt

s

0

where E denotes expectation w.r.t. P .)

Define

dXt = rutXtdt + utXtdBt ; Xt, ut, Bt  R
and

(s, x) = sup Es,x e-tf (Xt)dt ,
u s

244 11. Application to Stochastic Control

11.4.

where r, ,  are constants,  > 0 and f is a bounded continuous real function. Assume that  satisfies the conditions of Theorem 11.2.1 and that an optimal Markov control u exists.
a) Show that

sup
vR

e-tf (x)

+

 t

+

rvx

 x

+

1 2

2v2

x2

2 x2

=0.

Deduce that

2 x2



0

.

b)

Assume

that

2 x2

< 0.

Prove

that

u(t,

x)

=

-

r

 x

2

x

2 x2

and that

22

e-tf

+

 t

2 x2

-

r2

 x

2
=0.

c)

Assume that

2 x2

= 0. Prove that

 x

= 0 and

e-tf (x)

+

 t

=

0

.

d) Assume that ut = u(Xt) and that b) holds. Prove that (t, x) = e-t(x) and 22(f - ) - r2( )2 = 0 .

(See Exercise 11.2)

The assumptions in Theorem 11.2.1 often fail (see e.g. Exercise 11.10),
so it is useful to have results in such cases also. For example, if we define a as in Theorem 11.2.3 then, without assuming that u exists and without smoothness conditions on , we have the Bellman
principle (compare with (11.2.6)­(11.2.7))

a(y) = sup Ey
u


F u(Yru)dr + a(Yu)
0

for all y  G and all stopping times   T , the sup being taken over all Ft(m)-adapted controls u. (See Krylov (1980, Th. 6, p. 150).) Deduce that if a  C2(G) then

F v(y) + Lva(y)  0 for all y  G, v  U .

Exercises 245

11.5. 11.6.

Assume that F = 0 in (11.1.8) and that an optimal Markov control u exists. Prove that the function  is superharmonic in G w.r.t. the process Ytu, for any Markov control u. (Hint: See (11.2.6)­(11.2.7).)
Let Xt denote your wealth at time t. Suppose that at any time t you have a choice between two investments: 1) A risky investment where the unit price p1 = p1(t, ) satisfies the
equation dp1 = a1p1dt + 1p1dBt .
2) A safer (less risky) investment where the unit price p2 = p2(t, ) satisfies dp2 = a2p2dt + 2p2dBt
where ai, i are constants such that
a1 > a2 , 1 > 2
and Bt, Bt are independent 1-dimensional Brownian motions. a) Let u(t, ) denote the fraction of the fortune Xt() which is
placed in the riskier investment at time t. Show that

dXt = dXt(u) = Xt(a1u+a2(1-u))dt+Xt(1udBt+2(1-u)dBt) . b) Assuming that u is a Markov control, u = u(t, Xt), find the gen-
erator Au of (t, Xtu). c) Write down the HJB equation for the stochastic control problem

11.7.

(s, x) = sup Es,x
u

(XT(u))

where T = min(t1, 0), 0 = inf{t > s; Xt = 0} and t1 is a given future time (constant),   (0, 1) is a constant. d) Find the optimal control u for the problem in c).

Consider the stochastic control problem

(system)

dXt = audt + udBt ; X0 = x > 0

where Bt  R, u  R and a  R is a given constant, and

(performance)

(s, x) = sup Es,x[(XT )r] ,
u

where 0 < r < 1 is constant and

T = inf{t > s; Xt = 0}  t1 ,
t1 being a given future time (constant). Show that this problem has the optimal control

246 11. Application to Stochastic Control

u(t, x)

=

ax 1-r

with corresponding optimal performance

(s, x) = xr exp

a2(t1 - s)r 2(1 - r)

.

11.8. Use Dynkin's formula to prove directly that

u(t, x) = min

a-b 2(1 - r)

,

1

11.9.

is the optimal control for the problem in Example 11.2.5, with utility function N (x) = xr. (Hint: See the argument leading to (11.2.55).)

In Benes (1974) the following stochastic control problem is considered:


 (s, x) = inf Es,x
u

e-tXt2dt ,

s

where

dXt = dXt(u) = autdt + dBt ;

Xt, Bt  R

and a,  are (known) constants,  > 0. Here the controls u are restricted to take values in U = [-1, 1].

a) Show that the HJB equation for this problem is

inf
v[-1,1]

e-sx2

+

 s

+

av

 x

+

1 2

·

2 x2

=0.

b) If   C2 and u exists, show that

u(x) = -sign(ax) ,

where

sign z =

1 if z > 0 -1 if z  0 .

(Hint:

Explain

why

x

>

0



 x

>

0

and

x

<

0



 x

<

0.)

11.10. Let

f (x) =

x2x

for 0  x  1 for x > 1

and put

T
J u(s, x) = Es,x e-tf (Xtu)dt ,
s

(s, x) = sup Ju(s, x)
u

Exercises 247

where

dXtu = utdBt ;

ts

with control values ut  R, Bt  R and

T = inf{t > s; Xtu  0} .

a) Define where

(s, x)

=

1 

e-sf

(x)

for x  0, s  R

f (x) =

x x

for 0  x  1 for x > 1 .

Prove that

Ju(s, x)  (s, x)

for all (Hint:

s, x and all (finite) Markov controls u.

Put

1(s, x)

=

1 

e-s

x

for

all

s, x

and

2(s, x)

=

1 

e-sx

for all s, x. Then

Ju(s, x)  i(s, x) for i = 1, 2

by Theorem 11.2.2.) b) Show that

(s, x) = (s, x) .

(Hint: Consider Juk (s, x), where

uk(x) =

k 0

for 0  x < 1 for x  1

and let k  ). Thus u does not exist and  is not a C2 function. Hence both conditions for the HJB (I) equation fail in this case.
11.11. Consider a 1-dimensional version of the stochastic linear regulator problem of Example 11.2.4:

 (s, x) = inf Es,x
uK

t1
((Xru)2 + u2r)dr
s

(11.3.9)

where

dXtu = utdt + dBt ; for t  s, Xs = x ,

ut, Bt  R, ,  constants,  > 0, the infinum being over the space K of all Markov controls u satisfying

Es,x[(Xtu1 )2] = m2 ,

where m is a constant .

(11.3.10)

248 11. Application to Stochastic Control

Solve this problem by using Theorem 11.3.1. (Hint: Solve for each   R the unconstrained problem

(s,

x)

=

inf
u

E s,x

t1
((Xru)2 + ur2)dr + (Xtu1 )2
s

with optimal control u. Then try to find 0 such that Es,x[ Xtu10 2] = m2 .)

11.12. Solve the stochastic control problem

 (s, x) = inf J u(s, x) = J u (s, x)
u

where


J u(s, x) = Es,x e-r(Xr2 + ur2)dr

s

and dXt = utdt + dBt ,

with ut, Bt  R and   R,  > 0,  > 0 are constants. (Hint: Try (s, x) = e-s(ax2 + b) for suitable constants a, b and apply Theorem 11.2.2.)

11.13. Consider the stochastic control problem

(s, x) = sup Es,x
u

T
e-tut dt
s

where the (1-dimensional) system Xt is given by

dXt = dXtu = (1 - ut)dt + dBt .

The control ut = ut() can assume any value in U = [0, 1] and

T = inf{t > s; Xtu  0} (the time of bankruptcy) .

Show that if   2 then the optimal control is

ut = 1 for all t

and the corresponding value function is

(s,

x)

=

e-s

1 

1 - e-2 x

;

x0.

12. Application to Mathematical Finance

12.1 Market, portfolio and arbitrage

In this chapter we describe how the concepts, methods and results in the previous chapters can be applied to give a rigorous mathematical model of finance. We will concentrate on the most fundamental issues and those topics which are most closely related to the theory in this book. We emphasize that this chapter only intends to give a brief introduction to this exciting subject, which has developed very fast during the last years and shows no signs of slowing down. For a more comprehensive treatment see for example Bingham and Kiesel (1998), Elliott and Kopp (1999), Duffie (1996), Karatzas (1997), Karatzas and Shreve (1998), Lamberton and Lapeyre (1996), Musiela and Rutkowski (1997), Kallianpur and Karandikar (2000), Merton (1990), Shiryaev (1999) and the references therein.
First we give the mathematical definitions of some fundamental finance concepts. We point out that other mathematical models are also possible and in fact actively investigated. Other models include more general (possibly discontinuous) semimartingale models (see e.g. Barndorff-Nielsen (1998)) and even models based on stochastic processes which are not semimartingales, such as fractional Brownian motion. See e.g. Cutland, Kopp and Willinger (1995), Lin (1995), Hu and Øksendal (1999).
Definition 12.1.1. a) A market is an Ft(m)-adapted (n + 1)-dimensional It^o process X(t) = (X0(t), X1(t), . . . , Xn(t)); 0  t  T which we will assume has the form

dX0(t) = (t, )X0(t)dt ; X0(0) = 1

(12.1.1)

and

m
dXi(t) = µi(t, )dt + ij(t, )dBj(t)
j=1
= µi(t, )dt + i(t, )dB(t) ; Xi(0) = xi ,

(12.1.2)

where i is row number i of the n × m matrix [ij]; 1  i  n  N. b) The market {X(t)}t[0,T ] is called normalized if X0(t)  1.

250 12. Application to Mathematical Finance

c) A portfolio in the market {X(t)}t[0,T ] is an (n + 1)-dimensional (t, )measurable and Ft(m)-adapted stochastic process
(t, ) = (0(t, ), 1(t, ), . . . , n(t, )); 0  t  T . (12.1.3)

d) The value at time t of a portfolio (t) is defined by

n
V (t, ) = V (t, ) = (t) · X(t) = i(t)Xi(t)
i=0
where · denotes inner product in Rn+1. e) The portfolio (t) is called self-financing if

(12.1.4)

T

n

m

|0(s)(s)X0(s)+ i(s)µi(s)|+

n

2

i(s)ij(s) ds <  a.s.

0

i=1

j=1 i=1

(12.1.5)

and

dV (t) = (t) · dX(t)

(12.1.6)

i.e.
t
V (t) = V (0) + (s) · dX(s) for t  [0, T ] .

(12.1.7)

0

Comments to Definition 12.1.1. a) We think of Xi(t) = Xi(t, ) as the price of security/asset number i at time t. The assets number 1, . . . , n are called risky because of the presence of their diffusion terms. They can for example represent stock investments. The asset number 0 is called safe because of the absence of a diffusion term (although (t, ) may depend on ). This asset can for example represent a bank investment. For simplicity we will assume that (t, ) is bounded. b) Note that we can always make the market normalized by defining

Xi(t) = X0(t)-1Xi(t); 1  i  n .

(12.1.8)

The market

X(t) = (1, X1(t), . . . , Xn(t))

is called the normalization of X(t). Thus normalization corresponds to regarding the price X0(t) of the safe
investment as the unit of price (the numeraire) and computing the other prices in terms of this unit. Since

X0(t) = exp

t
(s, )ds
0

12.1 Market, portfolio and arbitrage 251

we have
t
(t): = X0-1(t) = exp - (s, )ds > 0 for all t  [0, T ]
0
and

(12.1.9)

dXi(t) = d((t)Xi(t)) = (t)[(µi -Xi)dt+idB(t)]; 1  i  n (12.1.10)

or

dX(t) = (t)[dX(t) -(t)X(t)dt] .

(12.1.11)

c) The components 0(t, ), . . . , n(t, ) represent the number of units of the securities number 0, . . . , n, respectively, which an investor holds at time t. d) This is simply the total value of all investments held at time t. e) Note that condition (12.1.5) is required to make (12.1.7) well-defined. See Definition 3.3.2.
This part e) of Definition 12.1.1 represents a subtle point in the mathematical model. According to It^o's formula the equation (12.1.4) would lead to
dV (t) = (t) · dX(t) + X(t) · d(t) + d(t) · dX(t)

if (t) was also an It^o process. However, the requirement (12.1.6) stems
from the corresponding discrete time model: If investments (tk) are made at discrete times t = tk, then the increase in the wealth V (tk) = V (tk+1) - V (tk) should be given by

V (tk) = (tk) · X(tk)

(12.1.12)

where X(tk) = X(tk+1)-X(tk) is the change in prices, provided that no money is brought in or taken out from the system i.e. provided the portfolio
is self-financing. If we consider our continuous time model as a limit of the
discrete time case as tk = tk+1 - tk goes to 0, then (12.1.6) (with the It^o interpretation of the integral) follows from (12.1.12).
f ) Note that if  is self-financing for X(t) and

V (t) = (t) · X(t) = (t)V (t)

(12.1.13)

is the value process of the normalized market, then by It^o's formula and (12.1.11) we have

dV (t) = (t)dV (t) + V (t)d(t) = (t)(t)dX(t) - (t)(t)V (t)dt = (t)(t)[dX(t) - (t)X(t)dt] = (t)dX(t) .

(12.1.14)

252 12. Application to Mathematical Finance

Hence  is also self-financing for the normalized market.

Remark. Note that by combining (12.1.4) and (12.1.6) we get

n

t

nt

0(t)X0(t) + i(t)Xi(t) = V (0) + 0(s)dX0(s) +

i(s)dXi(s) .

i=1

0

i=1 0

Hence, if we put

Y0(t) = 0(t)X0(t) ,

then

dY0(t) = (t)Y0(t)dt + dA(t) ,

where

n
A(t) =
i=1

t
i(s)dXi(s) - i(t)Xi(t) .
0

This equation has the solution

(12.1.15)

t
(t)Y0(t) = 0(0) + (s)dA(s)
0
or
t
0(t) = 0(0) + (s)dA(s) .
0
Using integration by parts we may rewrite this as

t
0(t) = 0(0) + (t)A(t) - A(0) - A(s)d(s)
0
or
t
0(t) = V (0) + (t)A(t) + (s)A(s)(s)ds .
0
In particular, if  = 0 this gives

(12.1.16)

0(t) = V (0) + A(t).

(12.1.17)

Therefore, if 1(t), . . . , n(t) are chosen, we can always make the portfolio (t) = (0(t), 1(t), . . . , n(t)) self-financing by choosing 0(t) according to (12.1.16).
We now make the following definition

12.1 Market, portfolio and arbitrage 253

Definition 12.1.2. A portfolio (t) which satisfies (12.1.5) and which is self-financing is called admissible if the corresponding value process V (t) is
(t, ) a.s. lower bounded, i. e. there exists K = K() <  such that

V (t, )  -K for a.a. (t, )  [0, T ] ×  .

(12.1.18)

This is the analogue of a tame portfolio in the context of Karatzas (1996). The restriction (12.1.18) reflects a natural condition in real life finance: There must be a limit to how much debt the creditors can tolerate. See Example 12.1.4.
Definition 12.1.3. An admissible portfolio (t) is called an arbitrage (in the market {Xt}t[0,T ]) if the corresponding value process V (t) satisfies V (0) = 0 and

V (T )  0 a.s. and P [V (T ) > 0] > 0 .

In other words, (t) is an arbitrage if it gives an increase in the value from time t = 0 to time t = T a.s., and a strictly positive increase with positive probability. So (t) generates a profit without any risk of losing money.
Intuitively, the existence of an arbitrage is a sign of lack of equilibrium in the market: No real market equilibrium can exist in the long run if there are arbitrages there. Therefore it is important to be able to determine if a given market allows an arbitrage or not. Not surprisingly, this question turns out to be closely related to what conditions we pose on the portfolios that should be allowed to use. We have defined our admissible portfolios in Definition 12.1.2 above, where condition (12.1.18) was motivated from a modelling point of view. One could also obtain a mathematically sensible theory with other conditions instead, for example with L2-conditions which imply that

E[V 2(t)] <  for all t  [0, T ] .

(12.1.19)

In any case, some additional conditions are required on the self-financial portfolios: If we only require the portfolio to be self-financing (and satisfying (12.1.5)) we can generate virtually any final value V (T ), as the next example illustrates:
Example 12.1.4. Consider the following market

dX0(t) = 0, dX1(t) = dB(t), 0  t  T = 1 .

Let

t

Y (t) =

dB(s) 1-s

for 0  t < 1 .

0

By Corollary 8.5.5 there exists a Brownian motion B(t) such that

254 12. Application to Mathematical Finance

Y (t) = B(t) ,

where

t

t =

ds 1-s

=

ln

0

1 1-t

Let a  R be a given constant and define

for 0  t < 1 .

 : = a: = inf{t > 0; B(t) = a}

and Then

: = a: = inf{t > 0; Y (t) = a} .  <  a.s. (Exercise 7.4a))

and

 = ln

1 1-

,

so  < 1 a.s.

Let (t) = (0(t), 1(t)) be a self-financing portfolio with

1(t) =

11-t
0

for 0  t <  for   t  1 .

Then the corresponding value process is given by

t

V (t) =

dB(s) = Y (t  ) 1-s

0

if we assume that V (0) = 0. In particular,

for 0  t  1 ,

V (1) = Y () = a a.s.

In this case condition (12.1.5) reduces to

1
12(s)ds <  a.s.
0

Now

1



12(s)ds =

ds 1-s

=

ln

0

0

1 1-

= <

a.s. ,

so (12.1.5) holds. But (t) is not admissible, because V (t) = Y (t  ) =

B(ln(

1 1-t

))

is

not

(t, )-a.s.

lower

bounded

for

(t, )



[0, T ]

×

.

Note

that (t) does not satisfy (12.1.19) either, because

12.1 Market, portfolio and arbitrage 255

E[V 2(t)] = E[Y 2(t)] = E

t
ds 1-s
0

= E ln

1 1-t

as t  T (Exercise 7.4b).

 E[ ] = 

This example illustrates that with portfolios only required to be selffinancing and satisfy (12.1.5) one can virtually generate any terminal value V (T, ) from V0 = 0, even when the risky price process X1(t) is Brownian motion. This clearly contradicts the real life situation in finance, so a realistic mathematical model must put stronger restrictions than (12.1.5) on the portfolios allowed. One such natural restriction is (12.1.18), as we have adopted.

To emphasize the phenomenon illustrated by this example, we state the following striking result, which is due to Dudley (1977):

Theorem 12.1.5. Let F be an FT(m)-measurable random variable and let B(t) be m-dimensional Brownian motion. Then there exists   Wm such that
T

F () = (t, )dB(t) .

(12.1.20)

0

Note that  is not unique. See Exercise 3.4.22 in Karatzas and Shreve
(1991). See also Exercise 12.4. This implies that for any constant z there exists   Wm such that

T
F () = z + (t, )dB(t) .
0
Thus, if we let m = n and interprete B1(t) = X1(t), . . . , Bn(t) = Xn(t) as prices, and put X0(t)  1, this means that we can, with any initial fortune z, generate any FT(m)-measurable final value F = V (T ), as long as we are allowed to choose the portfolio  freely from Wm. This again underlines the need for some extra restriction on the family of portfolios allowed, like condition (12.1.18).

How can we decide if a given market {X(t)}t[0,T ] allows an arbitrage or not? The following simple result is useful:
Lemma 12.1.6. Suppose there exists a measure Q on FT(m) such that P  Q and such that the normalized price process {X(t)}t[0,T ] is a local martingale w.r.t. Q. Then the market {X(t)}t[0,T ] has no arbitrage.

256 12. Application to Mathematical Finance

Proof. Suppose (t) is an arbitrage for {X(t)}t[0,T ]. Let V (t) be the corresponding value process for the normalized market with V (0) = 0. Then V (t) is a lower bounded local martingale w.r.t. Q, by (12.1.14). Therefore V (t) is a supermartingale w.r.t. Q, by Exercise 7.12. Hence

EQ[V (T )]  V (0) = 0 .

(12.1.21)

But since V (T, )  0 a.s. P we have V (T, )  0 a.s. Q (because Q P ) and since P [V (T ) > 0] > 0 we have Q[V (T ) > 0] > 0 (because P Q). This implies that
EQ[V (T )] > 0 ,
which contradicts (12.1.21). Hence arbitrages do not exist for the normalized price process {X(t)}. It follows that {X(t)} has no arbitrage. (Exercise 12.1).

Definition 12.1.7. A measure Q  P such that the normalized process
{X(t)}t[0,T ] is a (local) martingale w.r.t. Q is called an equivalent (local) martingale measure.

Thus Lemma 12.1.6 states that if there exists an equivalent local martingale measure then the market has no arbitrage. In fact, then the market also satisfies the stronger condition "no free lunch with vanishing risk" (NFLVR). Conversely, if the market satisfies the NFLVR condition, then there exists an equivalent martingale measure. See Delbaen and Schachermayer (1994), (1995), (1997), Levental and Skorohod (1995) and the references therein. Here we will settle with a weaker result, which nevertheless is good enough for many applications:
Theorem 12.1.8. a) Suppose there exists a process u(t, )  Vm(0, T ) such that, with X(t, ) = (X1(t, ), . . . , Xn(t, )),

(t, )u(t, ) = µ(t, ) - (t, )X(t, ) for a.a. (t, ) (12.1.22)

and such that
T

E exp

1 2

u2(t, )dt

<.

0

Then the market {X(t)}t[0,T ] has no arbitrage.

(12.1.23)

b) (Karatzas (1996), Th. 0.2.4)
Conversely, if the market {X(t)}t[0.T ] has no arbitrage, then there exists an Ft(m)-adapted, (t, )-measurable process u(t, ) such that

(t, )u(t, ) = µ(t, ) - (t, )X(t, )

for a.a. (t, ).

12.1 Market, portfolio and arbitrage 257

Proof. a) We may assume that {X(t)} is normalized, i.e. that  = 0 (Exercise 12.1). Define the measure Q = Qu on FT(m) by

dQ() = exp

T

T

-

u(t,

)dB(t)

-

1 2

u2(t, )dt dP () .

0

0

(12.1.24)

Then Q  P and by the Girsanov theorem II (Theorem 8.6.4) the process

t
B(t): = u(s, )ds + B(t)
0

(12.1.25)

is a Q-Brownian motion and in terms of B(t) we have

dXi(t) = µidt + idB(t) = idB(t); 1  i  n .
Hence X(t) is a local Q-martingale and the conclusion follows from Lemma 12.1.6.
b) Conversely, assume that the market has no arbitrage and is normalized. For t  [0, T ],    let

Ft = =
=

{; the equation (12.1.22) has no solution} {; µ(t, ) does not belong to the linear span of the columns of (t, )} {; v = v(t, ) with T (t, )v(t, ) = 0 and v(t, ) · µ(t, ) = 0} .

Define

i(t, ) =

sign(v(t, ) · µ(t, ))vi(t, ) for   Ft

0

for   Ft

for 1  i  n and 0(t, ) according to (12.1.17). Since (t, ), µ(t, ) are Ft(m)-adapted and (t, )-measurable, it follows that we can choose (t, ) to be Ft(m)-adapted and (t, )-measurable also. Moreover, (t, ) is selffinancing and it generates the following gain in the value function

tn

V (t, ) - V (0) =

i(s, )dXi(s)

0 i=1

t

tm

= XFs ()|v(s, ) · µ(s, )|ds +

0

0 j=1

n
i(s, )ij(s, ) dBj(s)
i=1

258 12. Application to Mathematical Finance

t
= XFs ()|v(s, ) · µ(s, )|ds
0 t
+ sign(v(s, ) · µ(s, ))XFs ()T (s, )v(s, )dB(s)
0 t
= XFs ()|v(s, ) · µ(s, )|ds  0 for all t  [0, T ] .
0
Since the market has no arbitrage we must (by Exercise 12.1 b) have that

XFt () = 0 for a.a. (t, ) i.e. that (12.1.22) has a solution for a.a. (t, ). Example 12.1.9. a) Consider the price process X(t) given by

dX0(t) = 0, dX1(t) = 2dt + dB1(t), dX2(t) = -dt + dB1(t) + dB2(t) .

In this case we have

µ=

2 -1

,

=

10 11

and the system u = µ has the unique solution

u=

u1 u2

=

2 -3

.

From Theorem 12.1.8a) we conclude that X(t) has no arbitrage.

b) Next, consider the price process Y (t) given by

dY0(t) = 0 , dY1(t) = 2dt + dB1(t) + dB2(t) , dY2(t) = -dt - dB1(t) - dB2(t) .
Here the system of equations u = µ gets the form

11 -1 -1

u1 u2

=

2 -1

which has no solutions. So the market has an arbitrage, according to Theorem 12.1.8 b). Indeed, if we choose

we get

(t) = (0, 1, 1)

12.2 Attainability and Completeness 259
T
V (T ) = V (0) + 2dt + dB1(t) + dB2(t) - dt - dB1(t) - dB2(t)
0
= V (0) + T .
In particular, if we choose 0 constant such that V (0) = 0Y0(0) + Y1(0) + Y2(0) = 0 ,
then  will be an arbitrage (see Exercise 12.2).

12.2 Attainability and Completeness

We start this section by stating without proof the following useful result, which is a special case of Proposition 17.1 in Yor (1997):
Lemma 12.2.1. Suppose a process u(t, )  Vm(0, T )satisfies the condition

E exp

T

1 2

u2(s, )ds

0

<.

(12.2.1)

Define the measure Q = Qu on FT(m) by

dQ() = exp

T

T

-

u(t,

)dB(t)

-

1 2

u2(t, )dt dP () .

0

0

(12.2.2)

Then

t
B(t): = u(s, )ds + B(t)

(12.2.3)

0
is an Ft(m)-martingale (and hence an Ft(m)-Brownian motion) w.r.t. Q and any F  L2(FT(m), Q) has a unique representation

T
F () = EQ[F ] + (t, )dB(t) ,
0

(12.2.4)

where (t, ) is an Ft(m)-adapted, (t, )-measurable Rm-valued process such that
T

EQ 2(t, )dt <  .

(12.2.5)

0

260 12. Application to Mathematical Finance

Remark. a) Note that the filtration {Ft(m)} generated by {B(t)} is contained in {Ft(m)} (by (12.2.3)), but not necessarily equal to {Ft(m)}. Therefore the representation (12.2.4) is not a consequence of the It^o representation the-
orem (Theorem 4.2.3) or the Dudley theorem (Theorem 12.1.5), which in this setting would require that F be FT(m)-measurable.

b) To prove that B(t) is an Ft(m)-martingale w.r.t Q, we apply It^o's formula to the process
Y (t): = Z(t)B(t) ,

where

t

t

Z(t) = exp -

u(s,

)dB(s)

-

1 2

u2(s, )ds ,

0

0

and use the Bayes formula, Lemma 8.6.2. The details are left to the reader. (Exercise 12.5.)

Next we make the following simple, but useful observation:
Lemma 12.2.2. Let X(t) = (t)X(t) be the normalized price process, as in (12.1.8)­(12.1.11). Suppose (t) is an admissible portfolio for the market {X(t)} with value process

V (t) = (t) · X(t) .

(12.2.6)

Then (t) is also an admissible portfolio for the normalized market {X(t)} with value process

V (t): = (t) · X(t) = (t)V (t)

(12.2.7)

and vice versa. In other words,

t
V (t) = V (0) + (s)dX(s) ; 0  t  T
0

(12.2.8)

t
(t)V (t) = V (0) + (s)dX(s) ; 0  t  T
0

(12.2.9)

Proof. Note that V (t) is lower bounded if and only if V (t) is lower bounded
(since (t) is bounded). Consider first the market consisting of the price
process X(t). Let (t) be an admissible portfolio for this market with value process V (t). Then

V (t) = (t) · X(t) = (t)V (t)

(12.2.10)

12.2 Attainability and Completeness 261

and since (t) is self-financing for the market {X(t)} we have, by (12.1.14),

dV (t) = (t)dX(t) .

(12.2.11)

Hence

(t)

is

also

admissible

for

{X (t)}

and

V (t)

=

V (0) +

t
(s)dX (s),

0
which shows that (12.2.8) implies (12.2.9).

The argument goes both ways, so the lemma is proved.

Before we proceed we note the following useful result:

Lemma 12.2.3. Suppose there exists an m-dimensional process u(t, )  Vm(0, T ) such that, with X(t, ) = (X1(t, ), . . . , Xn(t, )),

(t, )u(t, ) = µ(t, ) - (t, )X(t, ) for a.a. (t, ) (12.2.12)

and
T

E exp

1 2

u2(s, )ds

<.

(12.2.13)

0

Define the measure Q = Qu and the process B(t) as in (12.2.2), (12.2.3), respectively. Then B is a Brownian motion w.r.t. Q and in terms of B we have the following representation of the normalized market X(t) = (t)X(t) :

dX0(t) = 0 dXi(t) = (t)i(t)dB(t) ;

1in.

(12.2.14) (12.2.15)

T
In particular, if EQ[2(t)i2(t)]dt < , then Q is an equivalent martingale
0
measure (Definition 12.1.7). In any case the normalized value process V (t) of an admissible portfolio
 is a local Q-martingale given by

n
dV (t) = (t) i(t)i(t)dB(t)
i=1

(12.2.16)

Proof. The first statement follows from the Girsanov theorem. To prove the representation (12.2.15) we compute

dXi(t) = d((t)Xi(t)) = (t)dXi(t) + Xi(t)d(t) = (t)[(µi(t) - (t)Xi(t))dt + i(t)dB(t)] = (t)[(µi(t) - (t)Xi(t))dt + i(t)(dB(t) - ui(t)dt)] = (t)i(t)dB(t) .

262 12. Application to Mathematical Finance
T
In particular, if EQ[2(t)i2(t)]dt <  , then Xi(t) is a martingale w.r.t. Q
0
by Corollary 3.2.6. Finally, the representation (12.2.16) follows from (12.2.11) and (12.2.15).

Note. From now on we assume that there exists a process u(t, )  Vm(0, T ) satisfying (12.2.12) and (12.2.13) and we let Q and B be as in (12.2.2), (12.2.3), as described in Lemma 12.2.3.

Definition 12.2.4. a) A (European) contingent T -claim (or just a T -claim or claim) is a lower bounded FT(m)-measurable random variable F ().
b) We say that the claim F () is attainable (in the market {X(t)}t[0,T ]) if there exists an admissible portfolio (t) and a real number z such that

T
F () = Vz(T ): = z + (t)dX(t) a.s.
0

and such that

t

n

V (t) = z + (s) i(s)i(s)dB(s) ;

0

i=1

0  t  T is a Q-martingale .

If such a (t) exists, we call it a replicating or hedging portfolio for F .

c) The market {X(t)}t[0,T ] is called complete if every bounded T -claim is attainable.

In other words, a claim F () is attainable if there exists a real number z such that if we start with z as our initial fortune we can find an admissible portfolio (t) which generates a value Vz(T ) at time T which a.s. equals F :
Vz(T, ) = F () for a.a.  .
In addition we require tht the corresponding normalized value process V (t), which has the representation (12.2.16), is a martingale and not just a local martingale w.r.t. Q.

Remark. a) The boundedness condition in part c) of Definition 12.2.1 is technically convenient, but other, related definitions are also possible. Note that if the market is complete in the sense of c), then it often follows that many unbounded claims are attainable as well. See Exercise 12.3.

b) If we drop the martingale condition in Definition 12.2.4b) then the replicating portfolio  need not be unique. See Exercise 12.4.

12.2 Attainability and Completeness 263

What claims are attainable? Which markets are complete? These are important, but difficult questions in general. We will give some partial answers.
We are now ready for the main result of this section:
Theorem 12.2.5. The market {X(t)} is complete if and only if (t, ) has a left inverse (t, ) for a.a. (t, ), i.e. there exists an Ft(m)-adapted matrix valued process (t, )  Rm×n such that

(t, )(t, ) = Im for a.a. (t, ) .

(12.2.17)

Remark. Note that the property (12.2.17) is equivalent to the property

rank (t, ) = m for a.a. (t, ) .

(12.2.18)

Proof of Theorem 12.2.5 . (i) Assume that (12.2.17) hold. Let Q and B be as in (12.2.2), (12.2.3). Let F be a bounded T -claim. We want to prove that there exists an admissible portfolio (t) = (0(t), . . . , n(t)) and a real number z such that if we put

t
Vz(t) = z + (s)dX(s) ;
0

0tT

then

V

 z

(t)

is

a

Q-martingale

and

Vz(T ) = F () a.s.

By (12.2.16) this is equivalent to

T

n

(T )F () = V (T ) = z + (t) i(t)i(t)dB(t) .

0

i=1

By Lemma 12.2.1 we have a unique representation

T

Tm

(T )F () = EQ[(T )F ] + (t, )dB(t) = EQ[(T )F ] +

j(t, )dBj(t)

0

0 j=1

for some (t, ) = (1(t, ), . . . , m(t, ))  Rm. Hence we put

z = EQ[(T )F ]

and we choose (t) = (1(t), . . . , n(t)) such that

n
(t) i(t)ij(t) = j(t) ;
i=1

1jm

264 12. Application to Mathematical Finance

i.e. such that

(t)(t)(t) = (t) .

By (12.2.17) this equation in (t) has the solution

(t, ) = X0(t)(t, )(t, ) .

By choosing 0 according to (12.1.16) the portfolio becomes self-financing.

t

t

Moreover, since (t)Vz(t) = z + (s)dX(s) = z + (s)dB(s), we get the

0

0

useful formula

(t)Vz(t) = EQ[(T )Vz(T )|Ft] = EQ[(T )F |Ft] .

(12.2.19)

In particular, Vz(t) is lower bounded. Hence the market {X(t)} is complete.

(ii) Conversely, assume that {X(t)} is complete. Then {X(t)} is com-
plete, so we may assume that  = 0. The calculation in part a) shows that the value process Vz(t) generated by an admissible portfolio (t) = (0(t), 1(t), . . . , n(t)) is

tm
Vz(t) = z +
0 j=1

n
iij
i=1

t
dBj = z +  dB ,
0

(12.2.20)

where (t) = (1(t), . . . , n(t)). Since {X(t)} is complete we can hedge any bounded T -claim. Choose

an

Ft(m)-adapted

process

(t, )



Rm

such

that

T
EQ[ 2(t, )dt]

<



and

0

T

define F (): = (t, )dB(t). Then EQ[F 2] <  so we can find a sequence

0

of bounded T -claims Fk() such that

Fk  F in L2(Q) and EQ[Fk] = 0 .

By completeness there exists for all k an admissible portfolio (k) = (0(k), (k))

such that V (k) (t) =

t
(k)dB is a Q-martingale and

0

T
Fk() = V (k) (T ) = (k) dB .
0

Then by the It^o isometry the sequence {(k)} k=1 is a Cauchy sequence in L2( × Q), where  denotes Lebesgue measure on [0, T ]. Hence there exists (t, ) = (1(t, ), . . . , m(t, ))  L2( × Q) such that

12.2 Attainability and Completeness 265

(k)   in L2( × Q) .

But then

t

t

t

dB = lim
k

(k)dB

=

lim
k

E[Fk

|

Ft(m)]

=

E[F

|

Ft(m)]

=

dB

0

0

0

a.s. for all t  [0, T ], where Ft(m) is the -algebra generated by B(s); s  t. Hence by uniqueness we have (t, ) = (t, ) for a.a. (t, ). By taking a
subsequence we obtain that for a.a. (t, ) there exists a sequence x(k)(t, ) =
(x1(k)(t, ), . . . , xm (k)(t, ))  Rm such that

x(k)(t, )(t, )  (t, ) as k   .

This implies that (t, ) belongs to the linear span of the rows {i(t, )}in=1 of (t, ). Since   L2( × Q) was arbitrary, we conclude that the linear span of {i(t, )}ni=1 is the whole of Rm for a.a. (t, ). So rank (t, ) = m and there exists (t, )  Rm×n such that

(t, )(t, ) = Im .

Corollary 12.2.6. (a) If n = m then the market is complete if and only if (t, ) is invertible for a.a. (t, ).

(b) If the market is complete, then

rank (t, ) = m for a.a. (t, ) .

In particular, n  m. Moreover, the process u(t, ) satisfying (12.2.12) is unique.

Proof. (a) is a direct consequence of Theorem 12.2.5, since the existence of a left inverse implies invertibility when n = m. The existence of a left inverse of an n × m matrix is only possible if the rank is equal to m, which again implies that n  m. Moreover, the only solution u(t, ) of (12.2.12) is given by
u(t, ) = (t, )[µ(t, ) - (t, )X(t, )] .
This shows (b).

Example 12.2.7. Define X0(t)  1 and



   

dX1(t)

1

1

 dX2(t)  =  2  dt +  0

dX3(t)

3

1

0 1 1

dB1(t) dB2(t)

.

Then  = 0 and the equation (12.2.12) gets the form

266 12. Application to Mathematical Finance





1 u = 0
1

0 1 1

u1 u2

1 =2
3

which has the unique solution u1 = 1, u2 = 2. Since u is constant, it is clear that (12.2.12) and (12.2.13) hold. It is immediate that rank  = 2, so

(12.2.18) holds and the market is complete by Theorem 12.2.5.

Since



1 0

0 1

0 0

1 0
1

0 1= 1

1 0

0 1

= I2 ,

we see that in this case

=

1 0

0 1

0 0

 10
is a left inverse of  =  0 1 .

11

Example 12.2.8. Let X0(t)  1 and

dX1(t) = 2dt + dB1(t) + dB2(t) .
Then µ = 2,  = (1, 1)  R1×2, so n = 1 < 2 = m. Hence this market cannot be complete, by Corollary 12.2.6. So there exist bounded T -claims which cannot be hedged. Can we find such a T -claim? Let (t) = (0(t), 1(t)) be an admissible portfolio. Then the corresponding value process Vz(t) is given by (see (12.2.20))

t
Vz(t) = z + 1(s)(dB1(s) + dB(s)) .
0
So if  hedges a T -claim F () we have

T
F () = z + 1(s)(dB1(s) + dB(s)) .
0

(12.2.21)

Choose F () = g(B1(T )), where g: R  R is bounded. Then by the It^o representation theorem applied to the 2-dimensional Brownian motion B(t) = (B1(t), B2(t)) there is a unique (t, ) = (1(t, ), 2(t, )) such that
T
g(B1(T )) = EQ[g(B1(T ))] + 1(s)dB1(s) + 2(s)dB2(s)
0

12.3 Option Pricing 267
and by the It^o representation theorem applied to B1(t), we must have 2 = 0, i.e.
T
g(B1(T )) = EQ[g(B1(T ))] + 1(s)dB1(s)
0
Comparing this with (12.2.21) we see that no such 1 exists. So F () = g(B1(T )) cannot be hedged.
Remark. There is a striking characterization of completeness in terms of equivalent martingale measures, due to Harrison and Pliska (1983) and Jacod (1979):
A market {X(t)} is complete if and only if there is one and only one equivalent martingale measure for the normalized market {X(t)}.
(Compare this result with the equivalent martingale measure characterization of markets with no arbitrage/NFLVR, stated after Definition 12.1.7!)

12.3 Option Pricing

European Options

Let F () be a T -claim. A European option on the claim F is a guarantee to be paid the amount F () at time t = T > 0. How much would you be willing to pay at time t = 0 for such a guarantee? You could argue as follows: If I ­ the buyer of the option ­ pay the price y for this guarantee, then I have an initial fortune -y in my investment strategy. With this initial fortune (debt) it must be possible to hedge to time T a value V-y(T, ) which, if the guaranteed payoff F () is added, gives me a nonnegative result:

V-y(T, ) + F ()  0 a.s. Thus the maximal price p = p(F ) the buyer is willing to pay is

(Buyer's price of the (European) contingent claim F )

(12.3.1)

p(F ) = sup{y; There exists an admissible portfolio 

T

such that V-y(T, ): = -y + (s)dX(s)  -F () a.s.}

0

On the other hand, the seller of this guarantee could argue as follows:
If I ­ the seller ­ receive the price z for this guarantee, then I can use
this as the initial value in an investment strategy. With this initial fortune it must be possible to hedge to time T a value Vz(T, ) which is not less than the amount F () that I have promised to pay to the buyer:

268 12. Application to Mathematical Finance

Vz(T, )  F () a.s. Thus the minimal price q = q(F ) the seller is willing to accept is

(Seller's price of the (European) contingent claim F )

(12.3.2)

q(F ) = inf{z; There exists an admissible portfolio 

T

such that Vz(T, ): = z + (s)dX(s)  F () a.s.}

0

Definition 12.3.1. If p(F ) = q(F ) we call this common value the price (at t = 0) of the (European) T -contingent claim F ().

Two important examples of European contingent claims are

a) the European call, where

F () = (Xi(T, ) - K)+
for some i  {1, 2, . . . , n} and some K > 0. This option gives the owner the right (but not the obligation) to buy one unit of security number i at the specified price K (the exercise price) at time T . So if Xi(T, ) > K then the owner of the option will obtain the payoff Xi(T, ) - K at time T , while if Xi(T.)  K then the owner will not exercise his option and the payoff is 0. b) Similarly, the European put option gives the owner the right (but not the obligation) to sell one unit of security number i at a specified price K at time T . This option gives the owner the payoff

F () = (K - Xi(T, ))+ .
Theorem 12.3.2. a) Suppose (12.2.12) and (12.2.13) hold and let Q be as in (12.2.2). Let F be a (European) T -claim such that EQ[(T )F ] < . Then

ess inf F ()  p(F )  EQ[(T )F ]  q(F )   .

(12.3.3)

b) Suppose, in addition to the conditions in a), that the market {X(t)} is complete. Then the price of the (European) T -claim F is

p(F ) = EQ[(T )F ] = q(F ) .

(12.3.4)

Proof. a) Suppose y  R and there exists an admissible portfolio  such that

T
V-y(T, ) = -y + (s)dX(s)  -F () a.s.
0

12.3 Option Pricing 269

i.e., using (12.2.7) and Lemma 12.2.4,

Tn

-y +

i(s)(s)i(s)dB(s)  -(T )F () a.s.

0 i=1

(12.3.5)

where B is defined in (12.2.3).

tn

Since

i(s)(s)i(s)dB(s) is a lower bounded local Q-martingale, it is

0 i=1

tn

a supermartingale, by Exercise 7.12. Hence EQ[ i(s)(s)i(s)dB(s)]  0

0 i=1

for all t  [0, T ]. Therefore, taking the expectation of (12.3.5) with respect

to Q we get

y  EQ[(T )F ] .

Hence

p(F )  EQ[(T )F ] ,

provided such a portfolio  exists for some y  R. This proves the second inequality in (12.3.3). Clearly, if y < F () for a.a. , we can choose  = 0. Hence the first inequality in (12.3.3) holds.
Similarly, if there exists z  R and an admissible portfolio  such that

then, as in (12.3.5)

T
z + (s)dX(s)  F () a.s.
0

Tn

z+

i(s)(s)i(s)dB(s)  (T )F () a.s.

0 i=1

Taking Q-expectations we get

z  EQ[(T )F ] ,
provided such z and  exist. If no such z,  exist, then q(F ) =  > EQ[(T )F ].
b) Next, assume in addition that the market is complete. Define

Fk() =

k

if F ()  k

F () if F () < k .

Then Fk is a bounded T -claim, so by completeness we can find (unique) yk  R and (k) such that

270 12. Application to Mathematical Finance

T
-yk + (k)(s)dX(s) = -Fk() a.s.
0
i.e. (by (12.2.7) and Lemma 12.2.4)

Tn

-yk +

i(k)(s)(s)i(s)dB(s) = -(T )Fk()

0 i=1

a.s. ,

which gives, since t n i(k)(s)(s)i(s)dB(s) is a Q-martingale (Definition
0 i=1
12.2.4c)), yk = EQ[(T )Fk] .
Hence

p(F )  p(Fk)  EQ[(T )Fk]  EQ[(T )F ] by monotone convergence .

as k  ,

Combined with a) this gives

p(F ) = EQ[(T )F ] . A similar argument gives that

q(F ) = EQ[(T )F ] .

How to Hedge an Attainable Claim

We have seen that if Vz(t) is the value process of an admissible portfolio (t)

for

the

market

{X (t)},

then

V

 z

(t):

=

 (t)Vz (t)

is

the

value

process

of

(t)

for the normalized market {X(t)} (Lemma 12.2.3). Hence we have

t

(t)Vz(t) = z + (s)dX(s) .

(12.3.6)

0

If (12.2.12) and (12.2.13) hold, then ­ if Q, B are defined as before ((12.2.2) and (12.2.3)) ­ we can rewrite this as (see Lemma 12.2.4)

tn

m

(t)Vz(t) = z +

i(s)(s) ij(s)dBj(s) .

0 i=1

j=1

(12.3.7)

Therefore, the portfolio (t) = (0(t), . . . , n(t)) needed to hedge a given T -claim F is given by

12.3 Option Pricing 271

(t, )(1(t), . . . , n(t))(t, ) = (t, ) ,

(12.3.8)

where (t, )  Rm is such that

T
(T )F () = z + (t, )dB(t)

(12.3.9)

0

(and 0(t) is given by (12.1.14)). In view of this it is of interest to find explicitly the integrand (t, )
when F is given. One way of doing this is by using a generalized version of the Clark-Ocone theorem from the Malliavin calculus. See Karatzas and Ocone (1991). A survey containing their result is in Øksendal (1996)). In the Markovian case, however, there is a simpler method, which we now describe. It is a modification of a method used by Hu (1995).
Let Y (t) be an It^o diffusion in Rn of the form

dY (t) = b(Y (t))dt + (Y (t))dB(t), Y (0) = y

(12.3.10)

where b: Rn  Rn and : Rn  Rn×m are given Lipschitz continuous func-

tions. Assume that Y (t) is uniformly elliptic, i.e. that there exists a constant

c > 0 such that

T (x)T (x)  c||2

(12.3.11)

for all   Rn, x  Rn. Suppose : Rn  R is a bounded Lipschitz continuous function. Let Z(t)
be the It^o diffusion in Rn given by

dZ(t) = (Z(t))Z(t)dt + (Z(t))dB(t) ; Z(0) = z .

(12.3.12)

Let h: Rn  R be a continuous function such that Ez[|h(Z(t))|] <  for all z and all t  [0, T ] and define

w(t, z) = Ez[h(Z(t))]

(12.3.13)

and g(t, z) = w(T - t, z) .
Then by uniform ellipticity it is known that w(t, z)  C1,2((0, ) × Rn) (see Dynkin 1965 II, Theorem 13.18 p. 53 and Dynkin 1965 I, Theorem 5.11 p. 162) and hence Kolmogorov's backward equation (Theorem 8.1.1) gives

w t

=

(z)

n i=1

zi

w zi

+

n

1 2

(T )ij(z) ·

i,j=1

2w zizj

.

Hence, if we apply It^o's formula to the process

(t): = g(t, Y (t)) = w(T - t, Y (t))

(12.3.14)

272 12. Application to Mathematical Finance

we get

d(t) =

g t

(t,

Y

(t))

n
+
i=1

g zi

(t,

Y

(t))bi(Y

(t))+

1 2

n i,j=1

2g zizj

(t,

Y

(t))

·

(T

)ij (Y

(t))

dt

+

n i=1

g zi

(t,

Y

(t))

m j=1

ij (Y

(t))dBj (t)

=

n i=1

g zi

(t,

Y

(t))

(bi(Y (t)) - (Y (t))Yi(t))dt

m

+ ij(Y (t))dBj(t) .

(12.3.15)

j=1

Suppose that for all y  Rn there exists u(y)  Rm such that

T

(y)u(y) = b(y) - (y)y and E exp

1 2

u2(Y (s))ds

0

<.

If we as usual define the measure Q = Qu on FT by

dQ() = exp

T

T

-

u(Y

(t))dB(t)

-

1 2

u2(Y (t))dt dP () ,

0

0

then

t
B(t) = u(Y (s))ds + B(t) .

0
is a Brownian motion with respect to Q and (12.3.15) gives

d(t)

=

n i=1

g zi

(t,

Y

(t))

m j=1

ij (Y

(t))dBj (t)

.

(12.3.16) (12.3.17) (12.3.18) (12.3.19)

Now by (12.3.14) we have

(T ) = w(0, Y (T )) = Ez[h(Z(0))]z=Y (T ) = h(z)z=Y (T ) = h(Y (T )) and
(0) = w(T, Y (0)) = Ey[h(Z(T ))] . Hence by (12.3.19)­(12.3.21)

(12.3.20) (12.3.21)

12.3 Option Pricing 273

T
h(Y (T )) = Ey[h(Z(T ))] + (g)T (t, Y (t))(Y (t))dB(t) .
0
By (12.3.10) and (12.3.18) Y (t) is a weak solution of

(12.3.22)

dY (t) = (Y (t))Y (t)dt + (Y (t))dB(t) .

Hence, by weak uniqueness (Lemma 5.3.1) we have

w(t, y) = Ey[h(Z(t))] = EQy [h(Y (t))] for all t .

(12.3.23)

Substituting this in (12.3.22) we get:

Theorem 12.3.3. Let Y (t) and Z(t) be as in (12.3.10) and (12.3.12), respectively, and assume that h: Rn  R is as in (12.3.13). Assume that (12.3.11) and (12.3.16) hold and define Q and B(t) by (12.3.17) and (12.3.18). Then
T
h(Y (T )) = EQy [h(Y (T ))] + (t, )dB(t) ,
0
where  = (1, . . . , m), with

j (t,

)

=

n i=1

 yi

(E y [h(Z (T

-t))])y=Y

(t)ij (Y

(t))

;

1  j  m . (12.3.24)

In particular, if  = b = 0 and  = Im then u = 0, P = Q and Y (t) = Z(t) = B(t). Hence we get the representation

h(B(T ))

=

Ey[h(B(T ))]

+

T 0

m j=1

 zj

E z [h(B (T

-

t))]z=B(t)dBj (t)

(12.3.25)

We summarize our results about pricing and hedging of European T claims as follows:

Theorem 12.3.4. Let {X(t)}t[0,T ] be a complete market. Suppose (12.2.12)

and (12.2.13) hold and let Q, B be as in (12.2.2), (12.2.3). Let F be a Eu-

ropean T -claim such that EQ[(T )F ] < . Then the price of the claim F is

p(F ) = EQ[(T )F ] .

(12.3.26)

Moreover, to find a replicating (hedging) portfolio (t) = (0(t), . . . , n(t)) for the claim F we first find (for example by using Theorem 12.3.3 if possible)   Wm such that

274 12. Application to Mathematical Finance

T
(T )F = EQ[(T )F ] + (t, )dB(t) .
0
Then we choose (t) = (1(t), . . . , n(t)) such that (t, )(t, )(t, ) = (t, )

(12.3.27) (12.3.28)

and we choose 0(t) as in (12.1.14).
Proof. (12.3.26) is just part b) of Theorem 12.3.2. The relation (12.3.28) follows from (12.3.8). Note that the equation (12.3.28) has the solution

(t, ) = X0(t)(t, )(t, )

(12.3.29)

where (t, ) is the left inverse of (t, ) (Theorem 12.2.5).

Example 12.3.5. Suppose the market is X0(t) = et, X1(t) = Y (t), where  > 0 is constant and Y (t) is an Ornstein-Uhlenbeck process

dY (t) = Y (t)dt + dB(t); Y (0) = y

where ,  are constants,  = 0. How do we hedge the claim

F () = exp(Y (T )) ?

The portfolio (t) = (0(t), 1(t)) that we seek is given by (12.3.29), i.e. 1(t, ) = et-1(t, )
where (t, ) and V (0) are uniquely given by (12.3.9), i.e.

T
(T )F () = z + (t, )dB(t) .

0
To find (t, ) explicitly we apply Theorem 12.3.3: In this case we choose h(y) = exp(y)e-T and dZ(t) = Z(t)dt + dB(t). Then (see Exercise 5.5)

t
Z(t) = Z(0)et +  e(t-s)dB(s) .

0
Hence

eT EQy [h(Y (T - t))] = eT Ey[h(Z(T - t))]
T -t
= Ey[exp(ye(T -t) +  e(T -t-s)dB(s))]

0

= exp

ye(T -t)

+

2 4

(e2(T

-t)

-

1)

if  = 0 .

12.3 Option Pricing 275

This gives

(t, )

=

 y

exp

ye(T -t)

+

2 4

(e2(T

-t)

-

1)

 e-T
y=Y (t)

= e-t exp

Y

(t)e(T -t)

+

2 4

(e2(T

-t)

-

1)

and hence, if  = 0,

1(t) = exp

Y

(t)e(T -t)

+

2 4

(e2(T

-t)

-

1)

.

If  = 0 then 1(t) = exp

Y

(t)

+

2 2

(T

-

t)

.

The Generalized Black & Scholes Model

Let us now specialize to a situation where the market has just two securities X0(t), X1(t) where X0, X1 are It^o processes of the form

dX0(t) = (t, )X0(t)dt (as before)

(12.3.30)

dX1(t) = (t, )X1(t)dt + (t, )X1(t)dB(t) , (12.3.31)

where B(t) is 1-dimensional and (t, ), (t, ) are 1-dimensional processes in W.
Note that the solution of (12.3.31) is

X1(t) = X1(0) exp

t

t

(s, )dB(s)+

((s,

)-

1 2

2(s,

))ds

0

0

. (12.3.32)

The equation (12.2.12) gets the form

X1(t)(t, )u(t, ) = X1(t)(t, ) - X1(t)(t, ) which has the solution
u(t, ) = -1(t, )[(t, ) - (t, )] if (t, ) = 0 .

(12.3.33)

So (12.2.13) holds iff

E exp

T

1 2

((s,

) - (s, 2(s, )

))2

ds

0

<.

(12.3.34)

In this case we have an equivalent martingale measure Q given by (12.2.2) and the market has no arbitrage, by Theorem 12.1.8. Moreover, the market is complete by Corollary 12.2.5. Therefore we get by Theorem 12.3.2 that

276 12. Application to Mathematical Finance

the price at t = 0 of a European option with payoff given by a contingent

T -claim F is

p(F ) = q(F ) = EQ[(T )F ] ,

(12.3.35)

provided this quantity is finite. Now suppose that (t, ) = (t) and (t, ) = (t) are deterministic and
that the payoff F () has the form

F () = f (X1(T, )) for some lower bounded function f : R  R such that

EQ[f (X1(T ))] <  .

Then by (12.3.35) the price p = p(F ) = q(F ) is, with x1 = X1(0),

T

T

p = (T )EQ f x1 exp

(s)dB(s) +

((s)

-

1 2



2

(s))ds

.

0

0

T
Under the measure Q the random variable Y = (s)dB(s) is normally
0 T
distributed with mean 0 and variance 2: = 2(t)dt and therefore we can
0
write down a more explicit formula for p. The result is the following:

Theorem 12.3.6 (The generalized Black & Scholes formula). Suppose X(t) = (X0(t), X1(t)) is given by

dX0(t) = (t)X0(t)dt ; X0(0) = 1

(12.3.36)

dX1(t) = (t, )X1(t)dt + (t)X1(t)dB(t) ; X1(0) = x1 > 0 (12.3.37)

where (t), (t) are deterministic and

E exp

1 2

T

((t,

) 2

- (t))2 (t)

dt

0

<.

a) Then the market {X(t)} is complete and the price at time t = 0 of the European T -claim F () = f (X1(T, )) where EQ[f (X1(T, ))] <  is

T

p = (T )  2

f

x1 exp

y+

((s)-

1 2



2

(s))ds

R

0

exp

-

y2 22

dy

(12.3.38)

T

T

where (T ) = exp(- (s)ds) and 2 = 2(s)ds.

0

0

12.3 Option Pricing 277

b) If , ,  = 0 are constants and f  C1(R), then the self-financing
portfolio (t) = (0(t), 1(t)) needed to replicate the T -claim F () = f (X1(T, )) is given by

1(t, ) =

1 2(T - t)

f

(X1(t, ) exp{x

+

(

-

1 2



2

)(T

-

t)})

R

· exp

x

-

x2 2(T -

t)

-

1 2



2

(T

-

t)

dx

(12.3.39)

and 0(t, ) is given by (12.1.14).
Proof. Part a) is already proved and part b) follows from Theorem 12.3.3 and Theorem 12.3.4: (Strictly speaking condition (12.3.11) is not satisfied for the process X1 (unless x is bounded away from 0), but in this case it can be verified directly that u(t, z) given by (12.3.13) belongs to C1,2((0, ) × R), so Theorem 12.3.3 is still valid.) The portfolio we seek is by (12.3.28) given by
1(t, ) = X0(t)(X1(t, ))-1(t, )
where (t, ) is given by (12.3.24) with h(y) = e-T f (y) and

Y

(t)

=

X1(t)

=

x1

exp{B(t)

+

(

-

1 2



2

)t}

and

Zy(t) = y exp

B(t) +



-

1 2

2

t

.

Hence

1(t,

)

=

et(X1(t,

))-1

 y

Ey[e-T f (Z(T

- t))]

y=Y (t) · X1(t, )

=

e(t-T

)

 y

E

f (y exp{B(T

- t) + ( -

1 2



2)(T

- t)})

y=Y (t)

=

e(t-T )E

f

(y exp{B(T

- t) + ( -

1 2

2

)(T

- t)})

· exp{B(T

- t) +

( -

1 2



2)(T

- t)}

y=Y (t)

=

e(t-T ) 2(T - t)

f

(Y

(t, ) exp{x

+

(

-

1 2

2)(T

-

t)})

· exp{x

R
+ (

-

1 2



2)(T

-

t)}e-

x2 2(T -t)

dx

,

which is (12.3.39).

American options
The difference between European and American options is that in the latter case the buyer of the option is free to choose any exercise time  before or at

278 12. Application to Mathematical Finance

the given expiration time T (and the guaranteed payoff may depend on both  and .) This exercise time  may be stochastic (depend on ), but only in such a way that the decision to exercise before or at a time t only depends on the history up to time t. More precisely, we require that for all t we have

{;  ()  t}  Ft(m) .
In other words,  must be an Ft(m)-stopping time (Definition 7.2.1).
Definition 12.3.7. An American contingent T -claim is an Ft(m)-adapted, (t, )-measurable and a.s. lower bounded continuous stochastic process F (t) = F (t, ); t  [0, T ],   . An American option on such a claim F (t, ) gives the owner of the option the right (but not the obligation) to choose any stopping time  ()  T as exercise time for the option, resulting in a payment F ( (), ) to the owner.

Let F (t) = F (t, ) be an American contingent claim. Suppose you were offered a guarantee to be paid the amount F ( (), ) at the (stopping) time  ()  T that you are free to choose. How much would you be willing to pay for such a guarantee? We repeat the argument preceding Definition 12.3.1:
If I ­ the buyer ­ pay the price y for this guarantee, then I will have an initial fortune (debt) -y in my investment strategy. With this initial fortune -y it must be possible to find a stopping time   T and an admissible portfolio  such that

V-y( (), ) + F ( (), )  0 a.s.

Thus the maximal price p = pA(F ) the buyer is willing to pay is

(Buyer's price of the American contingent claim F )

(12.3.40)

pA(F ) = sup{y; There exists a stopping time   T and an admissible portfolio  such that

 ()

V-y( (), ): = -y + (s)dX(s)  -F ( (), ) a.s.}

0

On the other hand, the seller could argue as follows: If I ­ the seller ­ receive the price z for such a guarantee, then with this initial fortune z it must be possible to find an admissible portfolio  which generates a value process which at any time is not less than the amount promised to pay to the buyer:

Vz(t, )  F (t, ) a.s. for all t  [0, T ] .

Thus the minimal price q = qA(F ) the seller is willing to accept is

12.3 Option Pricing 279

(Seller's price of the American contingent claim F ) qA(F ) = inf{z; There exists an admissible portfolio 
such that for all t  [0, T ] we have
t
Vz(t, ): = z + (s)dX(s)  F (t, ) a.s.}
0

(12.3.41)

We can now prove a result analogous to Theorem 12.3.2. The result is basically due to Bensoussan (1984) and Karatzas (1988).

280 12. Application to Mathematical Finance

Theorem 12.3.8 (Pricing formula for American options).
a) Suppose (12.2.12) and (12.2.13) and let Q be as in (12.2.2). Let F (t) = F (t, ); t  [0, T ] be an American contingent T -claim such that

sup EQ[( )F ( )] < 
 T

(12.3.42)

Then

pA(F )  sup EQ[( )F ( )]  qA(F )   .
 T

(12.3.43)

b) Suppose, in addition to the conditions in a), that the market {X(t)} is complete. Then

pA(F ) = sup EQ[( )F ( )] = qA(F ) .
 T

(12.3.44)

Proof. a) We proceed as in the proof of Theorem 12.3.2: Suppose y  R and there exists a stopping time   T and an admissible portfolio  such that


V-y(, ) = -y + (s)dX(s)  -F ( ) a.s.
0

Then as before we get

n

-y +

i(s)(s)i(s)dB(s)  -( )F ( ) a.s.

0 i=1

Taking expectations with respect to Q we get

y  EQ[( )F ( )]  sup EQ[( )F ( )] .
 T
Since this holds for all such y we conclude that

pA(F )  sup EQ[( )F ( )] .
 T

(12.3.45)

Similarly, suppose z  R and there exists an admissible portfolio  such that

t
Vz(t, ) = z + (s)dX(s)  F (t) a.s. for all t  [0, T ] .
0

Then, as above, if   T is a stopping time we get

n

z+

i(s)(s)i(s)dB(s)  ( )F ( ) a.s.

0 i=1

12.3 Option Pricing 281

Again, taking expectations with respect to Q and then supremum over   T we get
z  sup EQ[( )F ( )] .
 T
Since this holds for all such z, we get

qA(F )  sup EQ[( )F ( )] .
 T

(12.3.46)

b) Next, assume in addition that the market is complete. Choose a stopping time   T . Define

Fk(t) = Fk(t, ) =

k

if F (t, )  k

F (t, ) if F (t, ) < k

and put

Gk() = X0(T )( )Fk( ) .

Then Gk is a bounded T -claim, so by completeness we can find yk  R and a portfolio (k) such that

T
-yk + (k)(s)dX(s) = -Gk() a.s.
0

and such that

t
-yk + (k)(s)dX(s)

0

is a Q-martingale. Then, by (12.2.8)­(12.2.9),

T
-yk + (k)(s)dX(s) = -(T )Gk() = -( )Fk( )
0

and hence



T

-yk + (k)(s)dX(s) = EQ - yk + (k)(s)dX(s) | F(m)

0

0

= EQ[-( )Fk( ) | F(m)] = -( )Fk( ) .

From this we get, again by (12.2.8)­(12.2.9),


-yk + (k)(s)dX(s) = -Fk( ) a.s.
0

282 12. Application to Mathematical Finance

and yk = EQ[( )Fk( )] .
This shows that any price of the form EQ[( )Fk( )] for some stopping time   T would be acceptable for the buyer of an American option on the claim Fk(t, ). Hence
pA(F )  pA(Fk)  sup EQ[( )Fk( )] .
 T
Letting k   we obtain by monotone convergence

pA(F )  sup EQ[( )F ( )] .
 T
It remains to show that if we put

z = sup EQ[( )F ( )]
0 T

(12.3.47)

then there exists an admissible portfolio (s, ) which superreplicates F (t, ), in the sense that

t
z + (s, )dX(s)  F (t, )

for a.a. (t, )  [0, T ] ×  . (12.3.48)

0

The details of the proof of this can be found in Karatzas (1997), Theorem 1.4.3. Here we only sketch the proof:
Define the Snell envelope

S(t) = sup EQ[( )F ( )|Ft(m)] ;
t T

0tT .

Then S(t) is a supermartingale w.r.t. Q and {Ft(m)}, so by the Doob-Meyer decomposition we can write

S(t) = M (t) - A(t) ; 0  t  T

where M (t) is a Q, {Ft(m)}-martingale with M (0) = S(0) = z and A(t) is a nondecreasing process with A(0) = 0. It is a consequence of Lemma 12.2.1 that we can represent the martingale M as an It^o integral w.r.t B. Hence

t
z + (s, )dB(s) = M (t) = S(t) + A(t)  S(t) ;

0  t  T (12.3.49)

0

for some Ft(m)-adapted process (s, ). Since the market is complete, we know by Theorem 12.2.5 that (t, ) has a left inverse (t, ). So if we define  = (1, . . . , n) by

12.3 Option Pricing 283

(t, ) = X0(t)(t, )(t, ) then by (12.3.49) and Lemma 12.2.4 we get

t

tn

t

z +  dX = z +

iidB = z +  dB  S(t) ;

0

0 i=1

0

Hence, by Lemma 12.2.3,

t
z + (s, )dX(s)  X0(t)S(t)  X0(t)(t)F (t) = F (t) ;
0

0tT . 0tT .

The It^o Diffusion Case: Connection to Optimal Stopping

Theorem 12.3.8 shows that pricing an American option is an optimal stopping problem. In the general case the solution to this problem can be expressed in terms of the Snell envelope. See e.g. El Karoui (1981) and Fakeev (1970). In the It^o diffusion case we get an optimal stopping problem of the type discussed in Chapter 10. We now consider this case in more detail:
Assume the market is an (n + 1)-dimensional It^o diffusion X(t) = (X0(t), X1(t), . . . , Xn(t)); t  0 of the form (see (12.1.1)­(12.1.2))

dX0(t) = (t, X(t))X0(t)dt ; X0(0) = 1

(12.3.50)

and

m

dXi(t) = µi(t, X(t))dt + ij(t, X(t))dBj(t)

(12.3.51)

j=1

= µi(t, X(t))dt + i(t, X(t))dB(t) ; Xi(0) = xi ,

where , µi and ij are given functions satisfying the conditions of Theorem 5.2.1.
Further, assume that the conditions corresponding to (12.2.12)­(12.2.13) are satisfied, i.e. there exists u(t, x)  Rm×1 such that, for all t, x =
(x0, x1, . . . , xn),

i(t, x)u(t, x) = µi(t, x) - (t, x)xi for i = 1, . . . , n .

(12.3.52)

and
T

Ex exp

1 2

u2(t, X(t))dt

<

for all x

(12.3.53)

0

where as usual Ex denotes the expectation w.r.t. the law of Xt when starting at x = (1, x1, . . . , xn). For 0  t  T put

284 12. Application to Mathematical Finance

t

t

M (t) = M (t, ) = exp -

u(s,

X

(s))dB(s)

-

1 2

u2(s, X(s))ds

0

0

(12.3.54)

and define, as in (12.2.2), the probability measure Q on FT(m) by

dQ() = M (T, )dP () .

(12.3.55)

Now assume that F (t, ) is an American contingent T -claim of Markovian

type, i.e.

F (t, ) = g(t, X(t, ))

(12.3.56)

for some continuous, lower bounded function g: R × Rn+1  R. Then if
the market {X(t)}t[0,T ] is complete, the price pA(F ) of this claim is by Theorem 12.3.8 given by

pA(F ) = sup EQ[( )g(, X( ))] = sup E[M (T )( )g(, X( ))]

 T

 T

= sup E[E[M (T )( )g(, X( ))|F ]]
 T

= sup E[( )g(, X( ))E[M (T )|F ]]
 T

= sup E[M ( )( )g(, X( ))]
 T

(12.3.57)

where we have used that M (t) is a P -martingale and Doob's optional sampling theorem (see Gihman and Skorohod (1975, Theorem 6, p. 11)). Define

t
K(t) = M (t)(t) = exp - u(s, X(s)dB(s)

0

t

-

1 2

u2(s,

X

(s))

+

(s, X(s))

ds

.

0

(12.3.58)

Then

dK(t) = -(t, X(t))K(t)dt - u(t, X(t))K(t)dB(t) .

Hence if we define the (n + 3) ­ dimensional It^o diffusion Y (t) by

 dt

 1

0

dY

(t)

=

 

dt dK dX

(t) (t)

 

=



dK (t)
dX0(t) dX1(t)
...



=

-µX...1K0

dt

+

-u0...1K

dB(t)

;

Y (0) = y

dXn(t)

µn

n

(12.3.59)

12.3 Option Pricing 285

we see that where

pA(F ) = sup E[G(Y ( ))] ,
 T

(12.3.60)

G(y) = G(s, k, x) = kg(s, x) ; y = (s, k, x)  R × R × Rn+1 .

We have proved:
Theorem 12.3.9. The price pA(F ) of an American contingent T -claim F of the Markovian form (12.3.56) is the solution of the optimal stopping problem (12.3.60), with It^o diffusion Y (t) given by (12.3.59).
We recognize (12.3.60) as a special case of the optimal stopping problem considered in Theorem 10.4.1. We can therefore use the method there to evaluate pA(F ) in special cases.
Example 12.3.10. Consider the Black and Scholes market

dX0(t) = X0(t)dt ; X0(0) = 1 dX1(t) = X1(t)dt + X1(t)dB(t) ;

X1(0) = x1 > 0 .

where , ,  are constants,  = 0. Then equation (12.3.52) becomes

x1u(x1) = x1 - x1

i.e.

u(x1)

=

u

=

- 

for all x1 .

Hence

K(t) = exp

-



- 

 B(t)

-

1 2

- 

2
+

t

.

Suppose the American claim is given by

F (t, ) = g(t, X1(t))
for some continuous lower bounded function g(t, x1). Then the price of the American option is

pA(F ) = sup E[K( )g(, X1( ))] .
 T

If we regard this price pA(F ) as a function (s, k, x) of the starting point y = (s, k, x) of the process dY (t) = (dt, dK(t), dX(t)), then to find  it suffices to find a function (s, k, x) which satisfies the conditions of Theorem 10.4.1.
In this case f = 0 and

286 12. Application to Mathematical Finance

L(s, k, x)

=

 s

-

k

 k

+

x0

 x0

+

x1

 x1

+

1 2

- 

2
k2

2 k2

- (

-

)kx1

2 kx1

+

1 2

2x21

 

2 x12

.

If T <  then we cannot factor out the dependence on time s as we often did in Chapter 10. Therefore the problem of finding  is much harder in this case. To illustrate the difficulty let us simplify even further by assuming that

 =  (so that P = Q)

and that

g(t, x1) = (a - x1)+ where a > 0 is a constant . Then the problem becomes to find the American put option price

pA(F ) = sup E[e- (a - X1( ))+] ,
 T

(12.3.61)

which is related to the finite horizon version of Example 10.2.2 (and Exam-
ple 10.4.2). A description of the American put option is as follows: The owner
of this option has the right (but not the obligation) to sell one stock at a
specified price a at any time  he chooses before or at the terminal time T . If
he sells at a time   T when the market price is X1( ) < a, he increases his fortune with the difference a - X1( ). Thus (12.3.61) represents the maximal expected discounted payoff to the owner of the option.
In this case we can disregard the variables k and x0, so we search for a function (s, x1)  C1(R2) satisfying the variational inequalities (see Theorem 10.4.1)

(s, x1)  e-s(a - x1)+

 s

+

x1

 x1

+

1 2

2x12

2 x12



0

for all s, x1 outside D

(12.3.62) (12.3.63)

and where

 s

+

x1

 x1

+

1 2



2x12

 

2 x12

=

0

on D ,

D = {(s, x1); (s, x1) > e-s(a - x1)+}

(12.3.64) (12.3.65)

is the continuation region. If such a  is found, and the additional assumptions of Theorem 10.4.1
hold, then we can conclude that

(s, x1) = (s, x1) and hence pA(F ) = (0, x1) is the option price at time t = 0. Moreover,

12.3 Option Pricing 287

  = D = inf{t > 0; (s + t, X1(t))  D}
is the corresponding optimal stopping time, i.e. the optimal time to exercise the American option. Unfortunately, even in this case it seems that an explicit analytic solution is very hard (possibly impossible) to find. However, there are interesting partial results and good approximation procedures. See e.g. Barles et al. (1995), Bather (1997), Jacka (1991), Karatzas (1997), Musiela and Rutkowski (1997) and the references therein. For example, it is known (see Jacka (1991)) that the continuation region D has the form

D = {(t, x1)  (0, T ) × R , x1 > f (t)} ,
i.e. D is the region above the graph of f , for some continuous, increasing function f : (0, T )  R. Thus the problem is to find the function f . In Barles et al. (1995) it is shown that

f (t)  a - a (T - t)| ln(T - t)| as t  T - ,

in the sense that

f (t) - a

1

-a (T - t)| ln(T - t)|

as t  T - .

This indicates that the continuation region has the shape shown in the figure. But its exact form is still unknown.

For the corresponding American call option the situation is much simpler. See Exercise 12.14.

288 12. Application to Mathematical Finance

Exercises

12.1. a) Prove that the price process {X(t)}t[0,T ] has an arbitrage iff the
normalized price process {X(t)}t[0,T ] has an arbitrage. b) Suppose {X(t)}t[0,T ] is normalized. Prove that {X(t)}t[0,T ] has
an arbitrage iff there exists an admissible portfolio  such that

V (0)  V (T ) a.s. and P [V (T ) > V (0)] > 0 . (12.3.66)

In other words, in normalized markets it is not essential that we require V (0) = 0 for an arbitrage , only that the gains V (T ) - V (0) is nonnegative a.s. and positive with positive probability.
(Hint: If  is as in (12.3.66) define (t) = (0(t), . . . , n(t)) as follows: Let i(t) = (t) for i = 1, . . . , n; t  [0, T ]. Then choose 0(0) such
that V (0) = 0 and define 0(t) according to (12.1.15) to make  self-financing. Then

t

t

V (t) = (t) · X(t) = (s)dX(s) = (s)dX(s) = V (t) - V (0) .)

0

0

12.2. Let (t) = (0, . . . , n) be a constant portfolio. Prove that  is self-financing.

12.3. Suppose {X(t)} is a complete normalized market and that (12.2.12) and (12.2.13) hold. Suppose n = m and that  is invertible with a bounded inverse. Then any lower bounded claim F such that

EQ[F 2] < 

is attainable. (Hint: Use the argument in the proof of Theorem 12.2.5: Choose bounded T -claims Fk such that

Fk  F in L2(Q) and E[Fk] = E[F ] .

By completeness there exist admissible portfolios (k) = (0(k), . . . , n(k)) and constants Vk(0) such that

T

T

Fk() = Vk(0) + (k)(s)dX(s) = Vk(0) + (k)(s)(s)dB(s)

0

0

where (k) = (1(k), . . . , n(k)). It follows that Vk(0) = EQ[Fk]  EQ[F ] as k  .

Exercises 289

By the It^o isometry the sequence {(k)}k is a Cauchy sequence in L2( × Q) and hence converges in this space. Conclude that there exists an admissible  such that

T
F () = EQ[F ] + (s)dX(s) .)
0

12.4. Let B(t) be 1-dimensional Brownian motion. Show that there exist 1(t, ), 2(t, )  W such that if we define

t
V1(t) = 1+ 1(s, )dB(s),
0

t
V2(t) = 2+ 2(s, )dB(s) ;
0

t  [0, 1]

then

V1(1) = V2(1) = 0

and V1(t)  0 , V2(t)  0

for a.a. (t, ).

Therefore both 1(t, ) and 2(t, ) are admissible portfolios for the claim F () = 0 in the normalized market with n = 1 and X1(t) = B(t). In particular, if we drop the martingale condition in Definition 12.2.4b)

we have no uniqueness of replicating portfolios, even if we require the

portfolio to be admissible. (Note, however, that we have uniqueness if

we require that   V(0, 1), by Theorem 4.3.3).

(Hint: Use Example 12.1.4 with a = -1 and with a = -2. Then define,

for i = 1, 2,

1

i(t) =

1-t
0

for 0  t < -i for -i  t  1

and
t

Vi(t) = i + i(s)dB(s) = i + Y (t  -i) ; 0  t  1 .)

0

12.5. Prove the first part of Lemma 12.2.2, i.e. that B(t) given by (12.2.3) is an Ft(m)-martingale (see the Remark b) following this lemma).
12.6. Determine if the following normalized markets {X(t)}t[0,T ] allow an arbitrage. If so, find one.
a) (n = m = 2) dX1(t) = 3dt + dB1(t) + dB2(t), dX2(t) = -dt + dB1(t) - dB2(t).

290 12. Application to Mathematical Finance
b) (n = 2, m = 3) dX1(t) = dt + dB1(t) + dB2(t) - dB3(t) dX2(t) = 5dt - dB1(t) + dB2(t) + dB3(t)
c) (n = 2, m = 3) dX1(t) = dt + dB1(t) + dB2(t) - dB3(t) dX2(t) = 5dt - dB1(t) - dB2(t) + dB3(t)
d) (n = 2, m = 3) dX1(t) = dt + dB1(t) + dB2(t) - dB3(t) dX2(t) = -3dt - 3dB1(t) - 3dB2(t) + 3dB3(t)
e) (n = 3, m = 2) dX1(t) = dt + dB1(t) + dB2(t) dX2(t) = 2dt + dB1(t) - dB2(t) dX3(t) = 3dt - dB1(t) + dB2(t)
f) (n = 3, m = 2) dX1(t) = dt + dB1(t) + dB2(t) dX2(t) = 2dt + dB1(t) - dB2(t) dX3(t) = -2dt - dB1(t) + dB2(t)
12.7. Determine which of the nonarbitrage markets {X(t)}t[0,T ] of Exercise 12.6 a)­f) are complete. For those which are not complete, find a T -claim which is not attainable.
12.8. Let Bt be 1-dimensional Brownian motion. Use Theorem 12.3.3 to find z  R and (t, )  V(0, T ) such that
T
F () = z + (t, )dB(t)
0
in the following cases: (i) F () = B2(T, ) (ii) F () = B3(T, ) (iii) F () = exp B(T, ).
(Compare with the methods you used in Exercise 4.14.)
12.9. Let Bt be n-dimensional Brownian motion. Use Theorem 12.3.3 to find z  R and (t, )  Vn(0, T ) such that
T
F () = z + (t, )dB(t)
0
in the following cases (i) F () = B2(T, ) (= B12(T, ) + · · · + Bn2 (T, )) (ii) F () = exp(B1(T, ) + · · · + Bn(T, )).

Exercises 291

12.10. Let X(t) be a geometric Brownian motion given by

dX(t) = X(t)dt + X(t)dB(t) ,

where  and  are constants. Use Theorem 12.3.3 to find z  R and (t, )  V(0, T ) such that

T
X(T, ) = z + (t, )dB(t) .
0
12.11. Suppose the market is given by

dX0(t) = X0(t)dt ; X0(0) = 1 dX1(t) = (m - X1(t))dt + dB(t) ;

X1(0) = x1 > 0 .

(the mean-reverting Ornstein-Uhlenbeck process) where  > 0, m > 0 and  = 0 are constants.
a) Find the price EQ[(T )F ] of the European T -claim

F () = X1(T, ) .

b) Find the replicating portfolio (t) = (0(t), 1(t)) for this claim. (Hint: Use Theorem 12.3.4, as in Example 12.3.5.)

12.12. Consider a market (X0(t), X1(t))  R2 where

dX0(t) = X0(t)dt ; X0(0) = 1  > 0 constant) .

Find the price EQ[(T )F ] of the European T -claim

F () = B(T, )

and find the corresponding replicating portfolio (t) = (0(t), 1(t)) in the following cases a) dX1(t) = X1(t)dt + X1(t)dB(t); ,  constants,  = 0 b) dX1(t) = c dB(t) ; c = 0 constant c) dX1(t) = X1(t)dt +  dB(t) ; ,  constants,  = 0.
12.13. (The classical Black & Scholes formula). Suppose X(t) = (X0(t), X1(t)) is given by
dX0(t) = X0(t)dt ; X0(0) = 1 dX1(t) = X1(t)dt + X1(t)dB(t) ; X1(0) = x1 > 0
where , ,  are constants,  = 0. Moreover, suppose that the European T -claim is the European call, defined by

292 12. Application to Mathematical Finance

F () = (X1(T, ) - K)+ =

X1(T, ) - K if X1(T, ) > K

0

if X1(T, )  K

where K > 0 is a given constant (the exercise price). Prove that in

this case the option pricing formula (12.3.38) of Theorem 12.3.6 can

be written

 p = x1(u) - e-T K(u -  T )

(12.3.67)

where

u

(u) = 1

e-

x2 2

dx

2

-

(12.3.68)

is the distribution function of the standard normal density and

u=

ln(

x1 K

)

+

(

+

1 2



2

)T

.

T

(12.3.69)

This is the celebrated Black & Scholes formula (Black and Scholes (1973)), which is of fundamental importance in today's finance.
12.14. (The American call) Let X(t) = (X0(t), X1(t)) be as in Exercise 12.13. If the American T -claim is given by

F (t, ) = (X1(t, ) - K)+ , 0  t  T ,
then the corresponding option is called the American call. According to Theorem 12.3.8 the price of an American call is given by

pA(F ) = sup EQ[e- (X1( ) - K)+] .
 T

Prove that

pA(F ) = e-T EQ[(X1(T ) - K)+] ,

i.e. that it is always optimal to exercise the American call at the terminal time T , if at all. Hence the price of an American call option coincides with that of a European call option. (Hint: Define
Y (t) = e-t(X1(t) - K) .

a) Prove that Y (t) is a Q-submartingale (Appendix C), i.e.

Y (t)  EQ[Y (s)|Ft] for s > t . b) Then use the Jensen inequality (Appendix B) to prove that

Z(t): = e-t(X1(t) - K)+ is also a Q-submartingale.

Exercises 293

c) Complete the proof by using Doob's optional sampling theorem (see the proof of Lemma 10.1.3 e)).
12.15. (The perpetual American put) Solve the optimal stopping problem

where

(s, x) = sup Ex[e-(s+)(a - X( ))+]
 0

dX(t) = X(t)dt + X(t)dB(t) ; X(0) = x > 0 .

Here  > 0, a > 0,  and  = 0 are constants. If  =  then (s, x) gives the price of the American put option with infinite horizon (T = ). (Hint: Proceed as in Example 10.4.2.)

294 12. Application to Mathematical Finance

Appendix A: Normal Random Variables

Here we recall some basic facts which are used in the text.

Definition A.11. Let (, F, P ) be a probability space. A random variable X:   R is normal if the distribution of X has a density of the form

pX (x)

=

1  2

· exp

-

(x

- m)2 22

,

(A.1)

where  > 0 and m are constants. In other words,

P [X  G] = pX (x)dx ,
G
If this is the case, then

for all Borel sets G  R .

E[X] = XdP = xpX (x)dx = m

(A.2)



R

and

var[X] = E[(X - m)2] = (x - m)2pX (x)dx = 2 .

(A.3)

R
More generally, a random variable X:   Rn is called (multi-) normal N (m, C) if the distribution of X has a density of the form

pX (x1, · · · , xn)

=

|A| (2)n/2

·

exp

-

1 2

·

(xj - mj )ajk(xk - mk)

j,k

(A.4)

where m = (m1, · · · , mn)  Rn and C-1 = A = [ajk]  Rn×n is a symmetric positive definite matrix.

If this is the case then

E[X] = m

(A.5)

and

A-1 = C = [cjk] is the covariance matrix of X, i.e. cjk = E[(Xj - mj)(Xk - mk)] .

(A.6)

296 Appendix A: Normal Random Variables

Definition A.12. The characteristic function of a random variable X:   Rn is the function X : Rn  C (where C denotes the complex numbers) defined by

X (u1, · · · , un) = E[exp(i(u1X1 +· · ·+unXn))] = ei u,x ·P [X  dx] , (A.7)
Rn
where u, x = u1x1 + · · · + unxn (and i  C is the imaginary unit). In other words, X is the Fourier transform of X (or, more precisely, of the measure P [X  dx]). Therefore we have
Theorem A.13. The characteristic function of X determines the distribution of X uniquely.
It is not hard to verify the following:
Theorem A.14. If X:   Rn is normal N (m, C), then

X (u1, · · · , un) = exp

-

1 2

uj cjkuk + i

uj mj .

j,k

j

(A.8)

Theorem A.4 is often used as a basis for an extended concept of a normal random variable: We define X:   Rn to be normal (in the extended sense)
if X satisfies (A.8) for some symmetric non-negative definite matrix C = [cjk]  Rn×n and some m  Rn. So by this definition it is not required that C be invertible. From now on we will use this extended definition of normality.
In the text we often use the following result:

Theorem A.15. Let Xj:   R be random variables; 1  j  n. Then

X = (X1, · · · , Xn) is normal

if and only if

Y = 1X1 + · · · + nXn is normal for all 1, . . . , n  R .

Proof. If X is normal, then

E[exp(iu(1X1 + · · · + nXn))] = exp

-

1 2

uj cjkuk + i

uj mj

j,k

j

= exp

-

1 2

u2

j cjkk + iu

j mj ,

j,k

j

so Y is normal with E[Y ] = jmj, var[Y ] = jcjkk.

Conversely, if Y = 1X1 + · · · + nXn is normal with E[Y ] = m and var[Y ] = 2, then

Appendix A: Normal Random Variables 297

E[exp(iu(1X1

+

·

·

·

+

nXn))]

=

exp(-

1 2

u22

+

ium)

,

where

m=
j
=E

jE[Xj], 2 = E
j (Xj - mj)
j

2

j Xj - j E[Xj ]

j

j

2

= jkE[(Xj - mj)(Xk - mk)] ,

j,k

where mj = E[Xj]. Hence X is normal.
Theorem A.16. Let Y0, Y1, . . . , Yn be real, random variables on . Assume that X = (Y0, Y1, . . . , Yn) is normal and that Y0 and Yj are uncorrelated for each j  1, i.e

E[(Y0 - E[Y0])(Yj - E[Yj])] = 0 ; Then Y0 is independent of {Y1, · · · , Yn}. Proof. We have to prove that

1jn.

P [Y0  G0, Y1  G1, . . . , Yn  Gn] = P [Y0  G0] · P [Y1  G1, . . . , Yn  Gn] , (A.9)
for all Borel sets G0, G1, . . . , Gn  R. We know that in the first line (and the first column) of the covariance
matrix cjk = E[(Yj - E[Yj])(Yk - E[Yk])] only the first entry c00 = var[Y0], is non-zero. Therefore the characteristic function of X satisfies

X (u0, u1, . . . , un) = Y0 (uo) · (Y1,...,Yn)(u1, . . . , un) and this is equivalent to (A.9).

Finally we establish the following: Theorem A.17. Suppose Xk:   Rn is normal for all k and that Xk  X in L2(), i.e.
E[|Xk - X|2]  0 as k   . Then X is normal. Proof. Since |ei u,x - ei u,y | < |u| · |x - y|, we have

E[{exp(i u, Xk ) - exp(i u, X )}2]  |u|2 · E[|Xk - X|2]  0 as k   . Therefore

E[exp(i u, Xk )]  E[exp(i u, X )] as k   .
So X is normal, with mean E[X] = lim E[Xk] and covariance matrix C = lim Ck, where Ck is the covariance matrix of Xk.

298 Appendix A: Normal Random Variables

Appendix B: Conditional Expectation

Let (, F , P ) be a probability space and let X:   Rn be a random variable such that E[|X|] < . If H  F is a -algebra, then the conditional expectation of X given H, denoted by E[X|H], is defined as follows:

Definition B.1. E[X|H] is the (a.s. unique) function from  to Rn satisfying:

(1) E[X|H] is H-measurable

(2) E[X|H]dP = XdP , for all H  H.

H

H

The existence and uniqueness of E[X|H] comes from the Radon-Nikodym theorem: Let µ be the measure on H defined by

µ(H) = XdP ; H  H .
H
Then µ is absolutely continuous w.r.t. P |H, so there exists a P |H-unique H-measurable function F on  such that

µ(H) = F dP for all H  H .
H
Thus E[X|H]: = F does the job and this function is unique a.s. w.r.t. the measure P |H.
Note that (2) is equivalent to

(2)'

Z · E[X|H]dP = Z · XdP for all H-measurable Z .





We list some of the basic properties of the conditional expectation:

Theorem B.2. Suppose Y :   Rn is another random variable with E[|Y |] <  and let a, b  R. Then

a) E[aX + bY |H] = aE[X|H] + bE[Y |H] b) E[E[X|H]] = E[X] c) E[X|H] = X if X is H-measurable

300 Appendix B: Conditional Expectation

d) E[X|H] = E[X] if X is independent of H e) E[Y · X|H] = Y · E[X|H] if Y is H-measurable, where · denotes the usual
inner product in Rn.
Proof. d): If X is independent of H we have for H  H

XdP = X · XH dP = XdP · XH dP = E[X] · P (H) ,

H







so the constant E[X] satisfies (1) and (2). e): We first establish the result in the case when Y = XH (where X denotes
the indicator function), for some H  H. Then for all G  H

Y · E[X|H]dP = E[X|H]dP = XdP = Y XdP ,

G

GH

GH

G

so Y · E[X|H] satisfies both (1) and (2). Similarly we obtain that the result is true if Y is a simple function

m

Y=

cj XHj ,

j=1

where Hj  H .

The result in the general case then follows by approximating Y by such simple functions.

Theorem B.3. Let G, H be -algebras such that G  H. Then

E[X|G] = E[E[X|H]|G] .

Proof. If G  G then G  H and therefore

E[X|H]dP = XdP .

G

G

Hence E[E[X|H]|G] = E[X|G] by uniqueness.

The following useful result can be found in Chung (1974), Theorem 9.1.4:

Theorem B.4 (The Jensen inequality). If : R  R is convex and E[|(X)|] <  then

(E[X|H])  E[(X)|H] .

Corollary B.5. (i) |E[X|H]|  E[|X| | H] (ii) |E[X|H]|2  E[|X|2 | H] .
Corollary B.6. If Xn  X in L2 then E[Xn | H]  E[X | H] in L2.

Appendix C: Uniform Integrability and Martingale Convergence

We give a brief summary of the definitions and results which are the background for the applications in this book. For proofs and more information we refer to Doob (1984), Liptser and Shiryaev (1977), Meyer (1966) or Williams (1979).
Definition C.1. Let (, F , P ) be a probability space. A family {fj}jJ of real, measurable functions fj on  is called uniformly integrable if

lim sup
M  jJ

|fj |dP

{|fj |>M }

=0.

One of the most useful tests for uniform integrability is obtained by using the following concept:

Definition C.2. A function : [0, )  [0, ) is called a u.i. (uniform integrability) test function if  is increasing, convex (i.e. (x + (1 - )y)  (x) + (1 - )(y) for all x, y  [0, ),   [0, 1]) and

lim
x

(x) x

=



.

So for example (x) = xp is a u.i. test function if p > 1, but not if p = 1.

The justification for the name in Definition C.2 is the following:

Theorem C.3. The family {fj}jJ is uniformly integrable if and only if there is a u.i. test function  such that

sup (|fj|)dP <  .
jJ
One major reason for the usefulness of uniform integrability is the following result, which may be regarded as the ultimate generalization of the various convergence theorems in integration theory:
Theorem C.4. Suppose {fk}k=1 is a sequence of real measurable functions on  such that

302 Appendix C: Uniform Integrability and Martingale Convergence

lim
k

fk ( )

=

f

()

for a.a.  .

Then the following are equivalent: 1) {fk} is uniformly integrable 2) f  L1(P ) and fk  f in L1(P ), i.e. |fk - f |dP  0 as k  .

An important application of uniform integrability is within the conver-

gence theorems for martingales:

Let (, N , P ) be a probability space and let {Nt}t0 be an increasing family of -algebras, Nt  N for all t. A stochastic process Nt:   R is called a supermartingale (w.r.t. {Nt}) if Nt is Nt-adapted, E[|Nt|] <  for all t and

Nt  E[Ns|Nt] for all s > t .

(C.1)

Similarly, if (C.1) holds with the inequality reversed for all s > t, then Nt is called a submartingale. And if (C.1) holds with equality then Nt is called a martingale.
As in customary we will assume that each Nt contains all the null sets of N , that t  Nt() is right continuous for a.a. and that {Nt} is right continuous, in the sense that Nt = Ns for all t  0.
s>t

Theorem C.5 (Doob's martingale convergence theorem I). Let Nt be a right continuous supermartingale with the property that

sup E[Nt-] <  ,
t>0

where Nt- = max(-Nt, 0). Then the pointwise limit

N

()

=

lim
t

Nt()

exists for a.a.  and E[N -] < .

Note, however, that the convergence need not be in L1(P ). In order to obtain this we need uniform integrability:

Theorem C.6 (Doob's martingale convergence theorem II).
Let Nt be a right-continuous supermartingale. Then the following are equivalent:

1) {Nt}t0 is uniformly integrable 2) There exists N  L1(P ) such that Nt  N a.e. (P ) and Nt  N in
L1(P ), i.e. |Nt - N |dP  0 as t   . Combining Theorems C.6 and C.3 (with (x) = xp) we get

Appendix C: Uniform Integrability and Martingale Convergence 303

Corollary C.7. Let Mt be a continuous martingale such that

sup E[|Mt|p] < 
t>0

for some p > 1 .

Then there exists M  L1(P ) such that Mt  M a.e. (P ) and

|Mt - M |dP  0 as t   .

Finally, we mention that similar results can be obtained for the analogous discrete time super/sub-martingales {Nk, Nk}, k = 1, 2, . . .. Of course, no continuity assumptions are needed in this case. For example, we have the following result, which is used in Chapter 9:
Corollary C.8. Let Mk; k = 1, 2, . . . be a discrete time martingale and assume that
sup E[|Mk|p] <  for some p > 1 .
k
Then there exists M  L1(P ) such that Mk  M a.e. (P ) and

|Mk - M |dP  0 as k   .

Corollary C.9. Let X  L1(P ), let {Nk}k=1 be an increasing family of algebras, Nk  F and define N to be the -algebra generated by {Nk} k=1. Then
E[X|Nk]  E[X|N] as k   , a.e. P and in L1(P ).
Proof. Mk: = E[X|Nk] is a u.i. martingale, so there exists M  L1(P ) such that Mk  M a.e. P and in L1(P ), as k  . It remains to prove that M = E[X|N]: Note that
Mk - E[M |Nk] L1(P ) = E[Mk|Nk] - E[M |Nk] L1(P )  Mk - M L1(P )  0 as k   .
Hence if F  Nk0 and k  k0 we have

(X-M )dP = E[X-M |Nk]dP = (Mk-E[M |Nk])dP  0 as k   .

F

F

F

Therefore and hence

(X - M )dP = 0
F


for all F  Nk
k=1

E[X|N] = E[M |N] = M .

304 Appendix C: Uniform Integrability and Martingale Convergence

Appendix D: An Approximation Result

In this Appendix we prove an approximation result which was used in Theorem 10.4.1. We use the notation from that Theorem.
Theorem C.1. Let D  V  Rn be open sets such that

D is a Lipschitz surface

(C.1)

and let : V  R be a function with the following properties

  C1(V )  C(V )

(C.2)

  C2(V \ D) and the second order derivatives of  are locally bounded near D ,

(C.3)

Then there exists a sequence {j} j=1 of functions j  C2(V )  C(V ) such that

j   uniformly on compact subsets of V , as j  
Lj  L uniformly on compact subsets of V \ D, as j   {Lj}j=1 is locally bounded on V .

(C.4) (C.5) (C.6)

Proof. We may assume that  is extended to a continuous function on the whole of Rn. Choose a C function : Rn  [0, ) with compact support
such that

(y)dy = 1

(C.7)

and put

Rn
 (x) = -n x

for > 0, x  Rn .

(C.8)

Fix a sequence j  0 and define

j(x) = (   j )(x) = (x - z) j (z)dz = (y) j (x - y)dy , (C.9)

Rn

Rn

306 Appendix D: An Approximation Result
i.e. j is the convolution of  and  j . Then it is well-known that j(x)  (x) uniformly on compact subsets of any set in V where  is continuous. See e.g. Folland (1984), Theorem 8.14 (c). Note that since  has compact support we need not assume that  is globally bounded, just locally bounded (which follows from continuity).
We proceed to verify (D.4)­(D.6): Let W  V be open with a Lipschitz boundary. Put V1 = W  D, V2 = W \ D.

Then V1, V2 are Lipschitz domains and integration by parts gives, for i = 1, 2 and x  W \ D

(y)

2  yk 

y



j (x - y)dy

=

Vi

(y)

 y



j (x - y)nikd(y) -

 yk

(y)

 y



j (x - y)dy

,

Vi

Vi

(C.10)

where nik is component number k of the outer unit normal ni from Vi at Vi. (This outer normal exists a.e. with respect to the surface measure  on Vi since Vi is a Lipschitz surface.)
Another integration by parts yields

 yk

(y

)

 y



j (x - y)dy =

Vi

 yk

(y)

j (x

-

y)ni

d(y)

-

2  yk  y

(y)

j (x - y)dy .

Vi

Vi

(C.11)

Combining (D.10) and (D.11) we get

(y)

 yk

2
y



j (x - y)dy

=

Vi

Appendix D: An Approximation Result 307

(y)

 y



j

(x

-

y)nik

-

 yk

(y)

j (x

-

y)ni

Vi

+

2  yk  y

(y) j (x - y)dy ;

Vi

i = 1, 2 .

d(y)

(C.12)

Adding (D.12) for i = 1, 2 and keeping in mind that the outer unit normal for Vi is the inner unit normal for V1-i on V1  V2, we get

(y)

2  yk  y

 j (x - y)dy =

W

(y)

 y



j (x - y)Nk -

 yk

(y)

j (x - y)N

W

+

2  yk  y

(y)

j (x - y)dy

,

W

d(y)

(C.13)

where Nk, N are components number k, of the outer unit normal N from W at W .
If we fix x  W \ D then for j large enough we have  j (x - y) = 0 for all y outside W and for such j we get from (D.13)

(y)



2 yk 

y

 j (x - y)dy =

2  yk  y

(y)

j (x - y)dy .

Rn

Rn

In other words, we have proved that

(C.14)

2  xk  x

j(x) =

2  yk  y

 j

(x)

for x  V \ D .

(C.15)

Similarly, integration by parts applied to W gives, if j is large enough

(y)

 yk



j (x

-

y)dy

=

-

 yk

(y)

j (x

-

y)dy

W

W

from which we conclude that

 xk

j (x)

=

 yk





j

(x)

for x  V .

(C.16)

From (D.15) and (D.16), combined with Theorem 8.14 (c) in Folland (1984), we get that

j xk



 x

uniformly on compact subsets of V as j  

(C.17)

308 Appendix D: An Approximation Result

and

2j xkx



2  xk  x

uniformly on compact subsets of V \ D as j   .

(C.18)

Moreover,

j xk


and
j=1

 2 j  xk  x


are locally bounded on V , by (D.15),
j=1

(D.16) combined with the assumptions (D.2), (D.3).

We conclude that (D.4)­(D.6) hold.

Solutions and Additional Hints to Some of the Exercises

2.13.

P 0[Bt



D]

=

1

-

e-

2 2t

.







2.14. Ex XK (Bt)dt = P x[Bt  K]dt = (2t)-n/2

e dy -

(x-y)2 2t

dt = 0

for

0
all

x  Rn,

if

0
K  Rn

has

0
n-dimensional

K
Legesgue

measure

equal

to 0.

2.15. P [Bt1  F1, . . . , Btk  Fk] = P [Bt1  U -1F1, . . . , Btk  U -1Fk]

=

p(t1, 0, x1)p(t2-t1, x1, x2) · · · p(tk-tk-1, xk-1, xk)dx1 · · · dxk

U -1F1×···×U -1Fk

=

p(t1, 0, y1)p(t2 -t1, y1, y2) · · · p(tk -tk-1, yk-1, yk)dy1 · · · dyk

F1 ×···×Fk

= P [Bt1  F1, . . . , Btk  Fk] ,

by (2.2.1), using the substitutions yj = U xj and the fact that

|U xj - U xj-1|2 = |xj - xj-1|2.

2.17. a) E[(Yn(t, ·) - t)2] = E

2n -1 k=0

(Bk

)2

-

2

2n -1 k=0

2-nt

=E =E

2n -1

2

((Bk)2 - 2-nt)

k=0

2n -1
((Bj)2 - 2-nt)((Bk)2 -2-nt)

j,k=0

2n -1

=

E[((Bk)2 - 2-nt)2]

k=0

2n -1

=

E[(Bk)4 - 2 · 2-2nt2 - 2-2nt2]

k=0

2n -1

=

2 · 2-2nt2 = 2 · 2-nt2  0

as n   .

k=0

b) This follows from the following general result: If the quadratic variation of a real function over an interval is positive, then the total variation of the function over that interval is infinite.

310 Solutions and Additional Hints to Some of the Exercises

3.1.

tBt =

n-1 j=0

(sj Bj )

=

t

t

 sdBs + Bsds

0

0

n-1 j=0

sj Bj

+

n-1 j=0

Bj+1

sj

as n   .

3.4. The processes in (iii) and (iv) are martingales, but those in (i) and

(ii) are not.

T

3.9.

Bt



dBt

=

1 2

BT2

0

if B0 = 0 .

3.12. (i) a) b)
(ii) a)
b)

dXt

=

(

+

1 2

2)Xtdt

+

XtdBt

.

dXt

=

1 2

sin Xt[cos Xt

-

t2]dt

+

(t2

+

cos Xt)dBt

.

dXt

=

(r

-

1 2

2

)Xtdt

+

Xt



dBt

.

dXt = (2e-Xt - Xt3)dt + Xt2  dBt .

4.1. a) dXt = 2BtdBt + dt .

b)

dXt

= (1 +

1 2

eBt)dt

+

eBt

dBt

.

c) dXt = 2dt + 2B1dB1(t) + 2B2dB2(t) .

d) dxt =

dt dBt

=

1 0

dt +

0 1

dBt .

e) dX1(t) = dB1(t) + dB2(t) + dB3(t)

dX2(t) = dt - B3(t)dB1(t) + 2B2(t)dB2(t) - B1(t)dB3(t)

or





dXt =

dX1(t) dX2(t)

=

0 1

dt +

1 -B3(t)

1 2B2(t)

1 -B1(t)

dB1(t)  dB2(t) .
dB3(t)

4.5. 5.3.

E[Bt6] = 15t3

if B0 = 0 .
n

n

Xt = X0 · exp

r

-

1 2

k2 t +

k Bk (t)

k=1

k=1

(if B(0) = 0).

5.4. (i) X1(t) = X1(0) + t + B1(t) ,

t

t

X2(t) = X2(0) + X1(0)B2(t) + sdB2(s) + B1(s)dB2(s), as-

0

0

suming (as usual) that B(0) = 0.

t
(ii) Xt = etX0 + et-sdBt .

0

(iii) Xt = e-tX0 + e-tBt (assuming B0 = 0).

t

5.6.

Yt

=

exp(Bt

-

1 2

2t)[Y0

+

r

exp(-Bs

+

1 2

2s)ds]

(B0 = 0).

0

t

5.7. a) Xt = m + (X0 - m)e-t +  es-tdBs .

0

b) E[Xt] = m + (X0 - m)e-t.

Var[Xt]

=

2 2

[1

-

e-2t]

.

5.8.

X(t) =

X1(t) X2(t)

t
= exp(tJ)X(0)+exp(tJ) exp(-sJ)M dB(s), where
0

Solutions and Additional Hints to Some of the Exercises 311

J=

0 -1

1 0

,

M=

 0

0 

,

dB(s) =

dB1(s) dB2(s)

and

exp(tJ )

=

I

+

tJ

+

t2 2

J2

+

·

·

·

+

tn n!

J

n

+

·

·

·



R2×2

.

Using that J2 = -I this can be rewritten as

t

X1(t) = X1(0) cos(t) + X2(0) sin(t) +  cos(t - s)dB1(s)

0

t

+  sin(t - s)dB2(s) ,

0

t

X2(t) = -X1(0) sin(t) + X2(0) cos(t) -  sin(t - s)dB1(s)

0

t

+ cos(t - s)dB2(s) .

0

t

t

5.11.

Hint: To prove that

lim(1 - t)

t1

0

dBs 1-s

=0

a.s., put Mt =
0

dBs 1-s

for

0  t < 1 and apply the martingale inequality to prove that

P [sup{(1 - t)|Mt|; t  [1 - 2-n, 1 - 2-n-1]} > ]  2 -2 · 2-n .
Hence by the Borel-Cantelli lemma we obtain that for a.a.  there exists n() <  such that

where

n  n()   / An ,

An

=

{;

sup{(1

-

t)|Mt|;

t



[1

-

2-n,

1

-

2-n-1]}

>

2-

n 4

}

.

5.16.

c)

Xt

=

exp(Bt

-

1 2

2

t)

t
x2 + 2 exp(-2Bs + 2s)ds

1/2
.

0

7.1.

a)

Af (x)

=

µxf

(x)

+

1 2

2

f

(x);

f  C02(R).

b)

Af (x)

=

rxf

(x)

+

1 2

2

x2f

(x);

f  C02(R).

c)

Af (y)

=

rf

(y)

+

1 2

2y2f

(y);

f  C02(R).

d)

Af (t, x) =

f t

+

µx

f x

+

1 2



2

2f x2

;

f  C02(R2).

e)

Af (x1, x2) =

f x1

+

x2

f x2

+

1 2

e2x1

; 2f
 x22

f  C02(R2).

f) g)

Af Af

(x1 (x1

, ,

x2) ...,

=

f x1

xn) =

+

1 2

n

k=1

2f  x21

+

1 2

x12

 

rk xk

f xk

+

; 2f
x22 n

f



C02(R2).
n

1 2

xixj ( ik

i,j=1

k=1

j

k

)



2f xi  xj

;

f



C02(Rn

). 

7.2. a) dXt = dt + 2 dBt .

312 Solutions and Additional Hints to Some of the Exercises

b) dX(t) =

dX1(t) dX2(t)

=

1 cX2(t)

dt +

0 X2(t)

dBt .

c) dX(t) =

dX1(t) dX2(t)

=

2X2(t) ln(1+X12(t)+X22(t))

dt+

X1(t) 1

1 0

(Several other diffusion coefficients are possible.)

dB1(t) dB2(t)

.

7.4. a), b). Let k = inf{t > 0; Btx = 0 or Btx = k}; k > x > 0 and put

k = P x[Bk = k] .

Then by Dynkin's formula applied to f (y) = y2 for 0  y  k we get

Ex[k] = k2pk - x2 .

(S1)

On the other hand, Dynkin's formula applied to f (y) = y for 0  y  k

gives

kpk = x .

(S2)

Combining these two identities we get that

Ex[

]

=

lim
k

E x [k ]

=

lim
k

x(k

-

x))

=



.

(S3)

Moreover, from (S2) we get

P x[t

<



with

Bt

=

0]

=

lim
k

P

x

[Bk

=

0]

=

lim (1
k

-

pk

)

=

1

,

(S4)

so  <  a.s. P x.

7.18.

c) p = . exp(-

2bx 2

)-exp(-

2ab 2

)

exp(-

2b2 2

)-exp(-

2ab 2

)

8.1. a) g(t, x) = Ex[(Bt)] .

b) u(x) = Ex[ e-t(Bt)dt] .
0

8.12. dQ() = exp(3B1(T ) - B2(T ) - 5T )dP () .

9.1.

a) dXt =

 0

dt +

0 

dBt .

b) dXt =

a b

dt +

1 0

0 1

dBt .

c) dXt = Xtdt + dBt .

d) dXt = dt + XtdBt .

e) dXt =

dX1(t) dX2(t)

=

ln(1+X12(t)) X2(t)

 dt + 2

X2(t) X1(t)

0 X1(t)

dB1(t) dB2(t)

.

9.3. a) u(t, x) = Ex[(BT -t)] . b) u(t, x) = Ex[(Bt)] .

Solutions and Additional Hints to Some of the Exercises 313

9.8. a) Let Xt  R2 be uniform motion to the right, as described in Example 9.2.1. Then each one-point set {(x1, x2)} is thin (and hence semipolar) but not polar.
b) With Xt as in a) let Hk = {(ak, 1)}; k = 1, 2, . . . where {ak} k=1 is the set of rational numbers. Then each Hk is thin but Q(x1,1)[TH = 0] = 1 for all x1  R .
9.10. Let Yt = Yts,x = (s + t, Xtx) for t  0, where Xt = Xtx satisfies

dXt = Xtdt + XtdBt ; t  0, X0 = x > 0 .

Then the generator A of Yt is given by

Af (s, x)

=

f s

+

x

f x

+

1 2



2

x2

2f x2

;

f  C02(R2) .

Moreover, with D = {(t, x); x > 0 and t < T } we have

D: = inf[t > 0; Yt / D} = inf{t > 0; s + t > T } = T - s .

Hence

YD = (T, XT -s) .

Therefore, by Theorem 9.3.3 the solution is

T -s

f (s, x) = E e-T (XTx-s) +

e-(s+t)K(Xtx)dt .

0

10.1. a) g(x) = ,   does not exist.

b) g(x) = ,   does not exist.

c) g(x) = 1,   = inf{t > 0; Bt = 0}.

d)

If  <

1 2

then

g(s, x) = 

and  

does

not

exist.

If





1 2

then

g(s, x)

=

g(s, x)

=

e-s cosh x

and



=

0

.

10.3. x0 > 0 is given implicitly by the equation

x0 =



2 

2 2 x0
·e e2 2 x0

+1 -1

,

and g(s, x) = e-sx02 ccoosshh((22xx0)) for -x0  x  x0, where

cosh 

=

1 2

(e

+ e-)

.

10.9.

If

0

<





1

then

(x)

=

1 

x2

+

1 2

but



does

not

exist.

If



>

1

then

(x) =

1 

x2

+

1 2

+

C

cosh(2 x)

for |x|  x

x2

for |x| > x

where C > 0, x > 0 are the unique solutions of the equations

314 Solutions and Additional Hints to Some of the Exercises

C cosh(

2 x) =

1

-

1 

(x)2

-

1 2

C

2 sinh(

2 x) = 2

1

-

1 

x .

10.12.

If  =

> r then inf{t > 0;

g(s, x) = Xt  x0},

e-s(x0 where

-

1)+(

x x0

)

and

 = -2

1 2

2

-

r

+

(

1 2

2

-

r)2

+

22

and

x0

=



 -1

10.13. If    then   = 0 . If  <  <  +  then

( > 1   > r) .

G(s, p, q) =

e-spq ;

if 0 < pq < y0

e-s(C1(pq)1

+

 +-

·

pq

-

K 

)

;

if pq  y0

where

1 = -2

1 2

2

+



-



-

(

1 2

2

+



-

)2

+

22

y0

=

(-1)K( +  - ) (1 - 1)( - )

>

0

<0,

and

C1

=

( - )y01-1 (-1)( +  - )

.

The continuation region is

D = {(s, p, q); pq > y0} .

If  +    then G =  .

11.6.

u

=

a1 -a2 -22 (1- ) (12 +22 )(1- )

(constant),

(s, x) = e(t-t1)x

for t < t1, x > 0

where



=

1 2

(1

-

)[12(u)2

+

22(1

-

u)2]

-

[a1u

+

a2(1

-

u)]

.

Solutions and Additional Hints to Some of the Exercises 315

11.11. Additional hints: For the solution of the unconstrained problem try a function (s, x) of the form (s, x) = a(s)x2 + b(s) ,
for suitable functions a(s), b(s) with   R fixed. By substituting this into the HJB equation we arrive at the equations

a(s)

=

1 

a2 (s)

-

1

a(t1) = 

for s < t1

and

b(s) = -2a(s) b(t1) = 0 ,

for s < t1

with Now

optimal control substitute this

u(s, x) into the

=

-

1 

a(s)x

equation for

. Xtu

and

use

the

terminal

condition to determine 0 .

If we put s = 0 for simplicity, then  = 0 can be chosen as any

solution of the equation

A3 + B2 + C + D = 0 ,

where

A = m2(et1 - e-t1 )2 , B = m2(e2t1 + 2 - 3e-2t1 ) - 2(et1 - e-t1 )2 , C = m2(-e2t1 + 2 + 3e-2t1 ) - 4x2 - 22(1 - e-2t1 ) D = -m2(et1 + e-t1 )2 + 4x2 + 2(e2t1 - e-2t1 ) .

12.6. a) no arbitrage b) no arbitrage c) (t) = (0, 1, 1) is an arbitrage d) no arbitrage e) arbitrages exist f) no arbitrage.
12.7. a) complete b) not complete. For example, the claim

T

F () =

B3(t)dB3(t)

=

1 2

B32

(T

)

-

1 2

T

0

cannot be hedged.

316 Solutions and Additional Hints to Some of the Exercises

c) (arbitrages exist) d) not complete e) (arbitrages exist) f) complete.

12.12.

c)

EQ[(T

)F

]

=

-1x1(1

-

 

)(1

-

e-T

).

The

replicating

portfolio

is

(t) = (0(t), 1(t)), where

1(t) = -1

1

-

 

(1

-

e(t-T ))

and 0(t) is determined by (12.1.14).

12.15.

(s, x) =

e-s(a - x)

e-s(a

-

x)(

x x

)

for x  x for x > x

where

 = -2

1 2



2

-



-

1 2



2

-

2

+ 22

<0

and

x

=

a -1



(0, a)

.

Hence it is optimal to stop the first time X(t)  x. If  =  this simplifies to



=

-

2 2

and

x

=

a2 2 + 2

.

References
1. Aase, K.K. (1982): Stochastic continuous-time model reference adaptive systems with decreasing gain. Advances in Appl. Prop. 14, 763­788
2. Aase, K.K. (1984): Optimum portfolio diversification in a general continuous time model. Stoch. Proc. and their Applications 18, 81­98
3. Adler, R.J. (1981): The Geometry of Random Fields. Wiley & Sons 4. Andersen, E.S., Jessen, B. (1948): Some limit theorems on set-functions. Danske
Vid. Selsk. Mat.-Fys. Medd. 25, #5, 1­8 5. Arnold, L. (1973): Stochastische Differentialgleichungen. Theorie und Anwen-
dung. Oldenbourgh Verlag 6. Barles, G., Burdeau, J., Romano, M., Samsoen, N. (1995): Critical stock price
near expiration. Math. Finance 5, 77­95 7. Barndorff-Nielsen, O.E. (1998): Processes of normal inverse Gaussian type. Fi-
nance and Stochastics 2, 41­68 8. Bather, J.A. (1970): Optimal stopping problems for Brownian motion. Advances
in Appl. Prob. 2, 259­286 9. Bather, J.A. (1997): Bounds on optimal stopping times for the American put.
Preprint, University of Sussex 10. Benes, V.E. (1974): Girsanov functionals and optimal bang-bang laws for final-
value stochastic control. Stoch. Proc. and Their Appl. 2, 127­140 11. Bensoussan, A. (1984): On the theory of option pricing. Acta Appl. Math. 2,
139­158 12. Bensoussan, A. (1992): Stochastic Control of Partially Observable Systems.
Cambridge Univ. Press 13. Bensoussan, A., Lions, J.L. (1978): Applications des in´equations variationelles
en controle stochastique. Dunod. (Applications of Variational Inequalities in Stochastic Control. North-Holland) 14. Bernard, A., Campbell, E.A., Davie, A.M. (1979): Brownian motion and generalized analytic and inner functions. Ann. Inst. Fourier 729, 207­228 15. Bers, L., John, F., Schechter, M. (1964): Partial Differential Equations. Interscience 16. Biais, B., Bjørk, T., Cvitanic, J., El Karoui, N., Jouini, E., Rochet, J.C. (1997): Financial Mathematics. Lecture Notes in Mathematics, Vol. 1656. SpringerVerlag 17. Bingham, N.H., Kiesel, R. (1998): Risk-Neutral Valuation. Springer-Verlag 18. Black, F., Scholes, M. (1973): The pricing of options and corporate liabilities. J. Political Economy 81, 637­654 19. Blumenthal, R.M., Getoor, R.K. (1968): Markov Processes and Potential Theory. Academic Press 20. Borodin, A.N., Salminen, P. (1996): Handbook of Brownian Motion ­ Facts and Formulae. Birkh¨auser

318 References
21. Brekke, K.A., Øksendal, B. (1991): The high contact principle as a sufficiency condition for optimal stopping. To appear in D. Lund and B. Øksendal (editors): Stochastic Models and Option Values. North-Holland
22. Brown, B.M., Hewitt, J.I. (1975): Asymptotic likelihood theory for diffusion processes. J. Appl. Prob. 12, 228­238
23. Bucy, R.S., Joseph, P.D. (1968): Filtering for Stochastic Processes with Applications to Guidance. Interscience
24. Chow, Y.S., Robbins, H., Siegmund, D. (1971): Great Expectations: The Theory of Optimal Stopping. Houghton Miffin Co
25. Chung, K.L. (1974): A Course in Probability Theory. Academic Press 26. Chung, K.L. (1982): Lectures from Markov Processes to Brownian Motion.
Springer-Verlag 27. Chung, K.L., Williams, R. (1990): Introduction to Stochastic Integration. Sec-
ond Edition. Birkh¨auser 28. Clark, J.M. (1970, 1971): The representation of functionals of Brownian motion
by stochastic integrals. Ann. Math. Stat. 41, 1282­1291 and 42, 1778 29. Csink, L., Øksendal, B. (1983): Stochastic harmonic morphisms: Functions
mapping the paths of one diffusion into the paths of another. Ann. Inst. Fourier 330, 219­240 30. Csink, L., Fitzsimmons, P., Øksendal, B. (1990): A stochastic characterization of harmonic morphisms. Math. Ann. 287, 1­18 31. Cutland, N.J., Kopp, P.E., Willinger, W. (1995): Stock price returns and the Joseph effect: A fractional version of the Black-Scholes model. In Bolthausen, Dozzi and Russo (editors): Seminar on Stochastic Analysis, Random Fields and Applications. Birkh¨auser, 327­351 32. Davis, M.H.A. (1977): Linear Estimation and Stochastic Control. Chapman and Hall 33. Davis, M.H.A. (1984): Lectures on Stochastic Control and Nonlinear Filtering. Tata Institute of Fundamental Research 75. Springer-Verlag 34. Davis, M.H.A. (1993): Markov Models and Optimization. Chapman & Hall, London 35. Davis, M.H.A., Vinter, R.B. (1985): Stochastic Modelling and Control. Chapman and Hall 36. Delbaen, F., Schachermayer, W. (1994): A general version of the fundamental theorem of asset pricing. Math. Ann. 300, 463­520 37. Delbaen, F., Schachermayer, W. (1995): The existence of absolutely continuous local martingale measures. Annals of Applied Probability 5, 926­945 38. Delbaen, F., Schachermayer, W. (1997): The fundamental theorem of asset pricing for unbounded stochastic processes. (To appear) 39. Dixit, A.K., Pindyck, R.S. (1994): Investment under Uncertainty. Princeton University Press 40. Doob, J.L. (1984): Classical Potential Theory and Its Probabilistic Counterpart. Springer-Verlag 41. Dudley, R.M. (1977): Wiener functionals as It^o integrals. Ann. Probability 5, 140­141 42. Duffie, D. (1994): Martingales, arbitrage, and portfolio choice. First European Congress of Mathematics, vol. II, Birkh¨auser, 3­21 43. Duffie, D. (1996): Dynamic Asset Pricing Theory. Second Edition. Princeton University Press 44. Durrett, R. (1984): Brownian Motion and Martingales in Analysis. Wadsworth Inc 45. Dynkin, E.B. (1963): The optimum choice of the instant for stopping a Markov process. Soviet Mathematics 4, 627­629

References 319
46. Dynkin, E.B. (1965 I): Markov Processes, vol. I. Springer-Verlag 47. Dynkin, E.B. (1965 II): Markov Processes, vol. II. Springer-Verlag 48. Dynkin, E.B., Yushkevich, A.A. (1979): Controlled Markov Processes. Springer-
Verlag 49. El Karoui (1981): Les aspects probabilistes du contro^l stochastique. Lecture
Notes in Math. 876, 73­238. Springer-Verlag 50. Elliott, R.J. (1982): Stochastic Calculus and Applications. Springer-Verlag 51. Elliott, R.J., Kopp, P.E. (1999): Mathematics of Financial Markets. Springer-
Verlag 52. Elworthy, K.D. (1982): Stochastic Differential Equations on manifolds. Cam-
bridge University Press 53. Emery, M. (1989): Stochastic Calculus in Manifolds. Springer-Verlag 54. Fakeev, A.G. (1970): Optimal stopping rules for processes with continuous pa-
rameter. Theory Probab. Appl. 15, 324­331 55. Fleming, W.H., Rishel, R.W. (1975): Deterministic and Stochastic Optimal
Control. Springer-Verlag 56. Fleming, W.H., Soner, H.M. (1993): Controlled Markov Processes and Viscosity
Solutions. Springer-Verlag 57. Folland, G.B. (1984): Real Analysis. J. Wiley & Sons 58. Freidlin, M. (1985): Functional Integration and Partial Differential Equations.
Princeton University Press 59. Friedman, A. (1975): Stochastic Differential Equations and Applications, vol.
I. Academic Press 60. Friedman, A. (1976): Stochastic Differential Equations and Applications, vol.
II. Academic Press 61. Fukushima, M. (1980): Dirichlet Forms and Markov Processes. North-
Holland/Kodansha 62. Gard, T.C. (1988): Introduction to Stochastic Differential Equations. Dekker 63. Gelb, A. (1974): Applied Optimal Estimation. MIT 64. Gihman, I.I., Skorohod, A.V. (1974a): Stochastic Differential Equations.
Springer-Verlag 65. Gihman, I.I., Skorohod, A.V. (1974b): The Theory of Stochastic Processes, vol.
I. Springer-Verlag 66. Gihman, I.I., Skorohod, A.V. (1975): The Theory of Stochastic Processes, vol.
II. Springer-Verlag 67. Gihman, I.I., Skorohod, A.V. (1979): Controlled Stochastic Processes. Springer-
Verlag 68. Grue, J. (1989): Wave drift damping of the motions of moored platforms by
the method of stochastic differential equations. Manuscript, University of Oslo 69. Harrison, J.M., Kreps, D. (1979): Martingales and arbitrage in multiperiod
securities markets. J. Economic Theory 20, 381­408 70. Harrison, J.M., Pliska, S. (1981): Martingales and stochastic integrals in the
theory of continuous trading. Stoch. Proc. and Their Applications 11, 215­260 71. Harrison, J.M., Pliska, S. (1983): A stochastic calculus model of continuous
trading: Complete markets. Stoch. Proc. Appl. 15, 313­316 72. He, S., Wang, J., Yan, J. (1992): Semimartingale Theory and Stochastic Cal-
culus. Science Press and CRC Press 73. Hida, T. (1980): Brownian Motion. Springer-Verlag 74. Hida, T., Kuo, H.-H,, Potthoff, J., Streit, L. (1993): White Noise. An Infinite
Dimensional Approach. Kluwer 75. Hoel, P.G., Port, S.C., Stone, C.J. (1972): Introduction to Stochastic Processes.
Waveland Press, Illinois 60070 76. Hoffmann, K. (1962): Banach Spaces of Analytic Functions. Prentice Hall

320 References
77. Holden, H., Øksendal, B., Ubøe, J., Zhang, T. (1996): Stochastic Partial Differential Equations. Birkh¨auser
78. Hu, Y. (1995): It^o-Wiener chaos expansion with exact residual and correlation, variance inequalities. (To appear)
79. Hu, Y., Øksendal, B. (1999): Fractional white noise calculus and applications to finance. Preprint, University of Oslo 1999
80. Ikeda, N., Watanabe, S. (1989): Stochastic Differential Equations and Diffusion Processes. Second Edition. North-Holland/Kodansha
81. Ito^, K. (1951): Multiple Wiener integral. J. Math. Soc. Japan 3, 157­169 82. Ito^, K., McKean, H.P. (1965): Diffusion Processes and Their Sample Paths.
Springer-Verlag 83. Jacka, S. (1991): Optimal stopping and the American put. Mathematical Fi-
nance 1, 1­14 84. Jacod, J. (1979): Calcul Stochastique et Problemes de Martingales. Springer
Lecture Notes in Math. 714 85. Jacod, J., Shiryaev, A.N. (1987): Limit Theorems for Stochastic Processes.
Springer-Verlag 86. Jaswinski, A.H. (1970): Stochastic Processes and Filtering Theory. Academic
Press 87. Kallianpur, G. (1980): Stochastic Filtering Theory. Springer-Verlag 88. Kallianpur, G., Karandikar, R.L. (2000): Introduction to Option Pricing The-
ory. Birkh¨auser 89. Karatzas, I. (1988): On the pricing of American options. Appl. Math. Opti-
mization 17, 37­60 90. Karatzas, I. (1997): Lectures on the Mathematics of Finance. American Math-
ematical Society 91. Karatzas, I., Lehoczky, J., Shreve, S.E. (1987): Optimal portfolio and consump-
tion decisions for a 'Small Investor' on a finite horizon. SIAM J. Control and Optimization 25, 1157­1186 92. Karatzas, I., Ocone, D. (1991): A generalized Clark representation formula, with application to optimal portfolios. Stochastics and Stochastics Reports 34, 187­220 93. Karatzas, I., Shreve, S.E. (1991): Brownian Motion and Stochastic Calculus. Second Edition. Springer-Verlag 94. Karatzas, I., Shreve, S.E. (1998): Methods of Mathematical Finance. SpringerVerlag 95. Karlin, S., Taylor, H. (1975): A First Course in Stochastic Processes. Second Edition. Academic Press 96. Kloeden, P.E., Platen, E. (1992): Numerical Solution of Stochastic Differential Equations. Springer-Verlag 97. Knight, F.B. (1981): Essentials of Brownian Motion. American Math. Soc. 98. Kopp, P. (1984): Martingales and Stochastic Integrals. Cambridge University Press 99. Krishnan, V. (1984): Nonlinear Filtering and Smoothing: An Introduction to Martingales, Stochastic Integrals and Estimation. J. Wiley & Sons 100. Krylov, N.V. (1980): Controlled Diffusion Processes. Springer-Verlag 101. Krylov, N.V., Zvonkin, A.K. (1981): On strong solutions of stochastic differential equations. Sel. Math. Sov. I, 19­61 102. Kushner, H.J. (1967): Stochastic Stability and Control. Academic Press 103. Lamperti, J. (1977): Stochastic Processes. Springer-Verlag 104. Lamberton, D., Lapeyre, B. (1996): Introduction to Stochastic Calculus Applied to Finance. Chapman & Hall

References 321
105. Levental, S., Skorohod, A.V. (1995): A necessary and sufficient condition for absence of arbitrage with tame portfolios. Ann. Appl. Probability 5, 906­925
106. Lin, S.J. (1995): Stochastic analysis of fractional Brownian motions. Stochastics 55, 121­140
107. Liptser, R.S., Shiryaev, A.N. (1977): Statistics of Random Processes, vol. I. Springer-Verlag
108. Liptser, R.S., Shiryaev, A.N. (1978): Statistics of Random Processes, vol. II. Springer-Verlag
109. McDonald, R., Siegel, D. (1986): The valueof waiting to invest. Quarterly J. of Economics 101, 707­727
110. McGarty, T.P. (1974): Stochastic Systems and State Estimation. J. Wiley & Sons
111. McKean, H.P. (1965): A free boundary problem for the heat equation arising from a problem of mathematical economics. Industrial managem. review 60, 32­39
112. McKean, H.P. (1969): Stochastic Integrals. Academic Press 113. Malliaris, A.G. (1983): It^o's calculus in financial decision making. SIAM Re-
view 25, 481­496 114. Malliaris, A.G., Brock, W.A. (1982): Stochastic Methods in Economics and
Finance. North-Holland 115. Markowitz, H.M. (1976): Portfolio Selection. Efficient Diversification of In-
vestments. Yale University Press 116. Maybeck, P.S. (1979): Stochastic Models, Estimation, and Control. Vols. 1­3.
Academic Press 117. Merton, R.C. (1971): Optimum consumption and portfolio rules in a
continuous-time model. Journal of Economic Theory 3, 373­413 118. Merton, R.C. (1990): Continuous-Time Finance. Blackwell Publishers 119. Metivier, M., Pellaumail, J. (1980): Stochastic Integration. Academic Press 120. Meyer, P.A. (1966): Probability and Potentials. Blaisdell 121. Meyer, P.A. (1976): Un cours sur les int´egrales stochastiques. Sem. de Prob.
X. Lecture Notes in Mathematics, vol. 511. Springer-Verlag, 245­400 122. Musiela, M., Rutkowski, M. (1997): Martingale Methods in Financial Mod-
elling. Springer-Verlag 123. Ocone, D. (1984): Malliavin's calculus and stochastic integral: representation
of functionals of diffusion processes. Stochastics 12, 161­185 124. Øksendal, B. (1984): Finely harmonic morphisms, Brownian path preserving
functions and conformal martingales. Inventiones math. 750, 179­187 125. Øksendal, B. (1990): When is a stochastic integral a time change of a diffusion?
Journal of Theoretical Probability 3, 207­226 126. Øksendal, B. (1996): An Introduction to Malliavin Calculus with Application
to Economics. Preprint, Norwegian School of Economics and Business Administration 127. Olsen, T.E., Stensland, G. (1987): A note on the value of waiting to invest. Manuscript CMI, N­5036 Fantoft, Norway 128. Pardoux, E. (1979): Stochastic partial differential equations and filtering of diffusion processes. Stochastics 3, 127­167 129. Port, S., Stone, C. (1979): Brownian Motion and Classical Potential Theory. Academic Press 130. Protter, P. (1990): Stochastic Integration and Differential Equations. SpringerVerlag 131. Ramsey, F.P. (1928): A mathematical theory of saving. Economic J. 38, 543­ 549

322 References
132. Rao, M. (1977): Brownian Motion and Classical Potential Theory. Aarhus Univ. Lecture Notes in Mathematics 47
133. Rao, M.M. (1984): Probability Theory with Applications. Academic Press 134. Revuz, D., Yor, M. (1991): Continuous Martingales and Brownian Motion.
Springer-Verlag 135. Rogers, L.C.G., Williams, D. (1994): Diffusions, Markov Processes, and Mar-
tingales. Vol. 1, 2nd edition. J. Wiley & Sons 136. Rogers, L.C.G., Williams, D. (1987): Diffusions, Markov Processes, and Mar-
tingales. Vol. 2. J. Wiley & Sons 137. Rozanov, Yu.A. (1982): Markov Random Fields. Springer-Verlag 138. Samuelson, P.A. (1965): Rational theory of warrant pricing. Industrial man-
agem. review 6, 13­32 139. Shiryaev, A.N. (1978): Optimal Stopping Rules. Springer-Verlag 140. Shiryaev, A.N. (1999): Essentials of Stochastic Finance. World Scientific 141. Simon, B. (1979): Functional Integration and Quantum Physics. Academic
Press 142. Snell, J.L. (1952): Applications of martingale system theorems. Trans. Amer.
Math. Soc. 73, 293­312 143. Stratonovich, R.L. (1966): A new representation for stochastic integrals and
equations. J. Siam Control 4, 362­371 144. Stroock, D.W. (1971): On the growth of stochastic integrals. Z. Wahr. verw.
Geb. 18, 340­344 145. Stroock, D.W. (1981): Topics in Stochastic Differential Equations. Tata Insti-
tute of Fundamental Research. Springer-Verlag 146. Stroock, D.W. (1993): Probability Theory, An Analytic View. Cambride Uni-
versity Press 147. Stroock, D.W., Varadhan, S.R.S. (1979): Multidimensional Diffusion Pro-
cesses. Springer-Verlag 148. Sussmann, H.J. (1978): On the gap between deterministic and stochastic or-
dinary differential equations. The Annals of Prob. 60, 19­41 149. Taraskin, A. (1974): On the asymptotic normality of vectorvalued stochas-
tic integrals and estimates of drift parameters of a multidimensional diffusion process. Theory Prob. Math. Statist. 2, 209­224 150. The Open University (1981): Mathematical models and methods, unit 11. The Open University Press 151. Topsøe, F. (1978): An information theoretical game in connection with the maximum entropy principle (Danish). Nordisk Matematisk Tidsskrift 25/26, 157­172 152. Turelli, M. (1977): Random environments and stochastic calculus. Theor. Pop. Biology 12, 140­178 153. Ubøe, J. (1987): Conformal martingales and analytic functions. Math. Scand. 60, 292­309 154. Van Moerbeke, P. (1974): An optimal stopping problem with linear reward. Acta Mathematica 132, 111­151 155. Williams, D. (1979): Diffusions, Markov Processes and Martingales. J. Wiley & Sons 156. Williams, D. (1981) (editor): Stochastic Integrals. Lecture Notes in Mathematics, vol. 851. Springer-Verlag 157. Williams, D. (1991): Probability with Martingales. Cambridge University Press 158. Wong, E. (1971): Stochastic Processes in Information and Dynamical Systems. McGraw-Hill

References 323
159. Wong, E., Zakai, M. (1969): Riemann-Stieltjes approximations of stochastic integrals. Z. Wahr. verw. Geb. 120, 87­97
160. Yeh, J. (1995): Martingales and Stochastic Analysis. World Scientific 161. Yong, J., Zhou, X.Y. (1999): Stochastic Controls: Hamiltonian Systems and
HJB Equations. Springer-Verlag 162. Yor, M. (1992): Some Aspects of Brownian Motion, Part I. ETH Lectures in
Math. Birkh¨auser 163. Yor, M. (1997): Some Aspects of Brownian Motion, Part II. ETH Lectures in
Math. Birkh¨auser

324 References

List of Frequently Used Notation and Symbols

Rn R+ Q Z Z+ = N C Rn×m AT |C | Rn Rn×1 Cn = C × · · · × C |x|2 = x2
x·y
x+ x-
sign x
C(U, V ) C(U ) C0(U ) Ck = Ck(U )
C0k = C0k(U ) C k+
C1,2(R × Rn)
Cb(U ) f |K A = AX A = AX

n-dimensional Euclidean space the non-negative real numbers the rational numbers the integers the natural numbers the complex plane the n × m matrices (real entries) the transposed of the matrix A the determinant of the n × n matrix C i.e. vectors in Rn are regarded as n × 1-matrices the n-dimensional complex space
n
x2i if x = (x1, . . . , xn)  Rn
i=1 n
the dot product xiyi if x = (x1, . . . , xn),
i=1
y = (y1, . . . , yn) max(x, 0) if x  R max(-x, 0) if x  R
1 if x  0 -1 if x < 0
the continuous functions from U into V the same as C(U, R) the functions in C(U ) with compact support the functions in C(U, R) with continuous derivatives up to order k the functions in Ck(U ) with compact support in U the functions in Ck whose k'th derivatives are Lipschitz continuous with exponent  the functions f (t, x): R × Rn  R which are C1 w.r.t. t  R and C2 w.r.t. x  Rn the bounded continuous functions on U the restriction of the function f to the set K the generator of an It^o diffusion X the characteristic operator of an It^o diffusion X

326 List of Frequently Used Notation and Symbols

L = LX
Bt (or (Bt, F , , P x)) DA  
L

the second order partial differential operator which

coincides with AX on C02 and with AX on C2 Brownian motion

the domain of definition of the operator A

the

gradient:

f

=

(

f x1

,

.

.

.

,

f xn

)

the Laplace operator: f =

i

2f xi2

a semielliptic second order partial differential oper-

ator of the form L =

i

bi

 xi

+

i,j

aij

2  xi  xj

R

the resolvent operator

iff

if and only if

a.a., a.e., a.s.

almost all, almost everywhere, almost surely

w.r.t.

with respect to

s.t.

such that

coincides in law with (see Section 8.5)

E[Y ] = Eµ[Y ] = Y dµ the expectation of the random variable Y w.r.t. the

measure µ

E[Y |N ]

the conditional expectation of Y w.r.t. N

F

the -algebra generated by Ft

t>0

B

the Borel -algebra

Ft, Ft(m)

the -algebra generated by {Bs; s  t}, Bs is mdimensional

F

the -algebra generated by {Bs ; s  0} ( is a

stopping time)



orthogonal to (in a Hilbert space)

Mt

the -algebra generated by {Xs; s  t} (Xt is an

It^o diffusion)

M

the -algebra generated by {Xs ; s  0} ( is a

stopping time)

G

the boundary of the set G

G

the closure of the set G

G  H

G is compact and G  H

d(y, K)

the distance from the point y  Rn to the set K 

Rn

G V(S, T ), Vn(S, T )

the first exit time from the set G of a process
Xt: G = inf{t > 0; Xt / G} Definition 3.3.1

W, Wn

Definition 3.3.2

(H )

Hunt's condition (Chapter 9)

HJB

the Hamilton-Jacobi-Bellman equation (Chapter 11)

In

the n × n identity matrix

XG

the indicator function of the set G XG(x) = 1 if

x  G, XG(x) = 0 if x / G

List of Frequently Used Notation and Symbols 327

Px P = P0 Qx R(s,x)
Qs,x
PQ
P Q Ex, E(s,x), Es,x
EQ E
st st T x ij t
(t) V (t)
Vz (t)
X (t) (t) := lim , lim ess inf f ess sup f

the probability law of Bt starting at x the probability law of Bt starting at 0 the probability law of Xt starting at x (X0 = x) the probability law of Yt = (s + t), Xtx)t0 with Y0 = (s, x) (Chapter 10) the probability law of Yt = (s + t, Xss+,xt)t0 with Y0 = (s, x) (Chapter 11) the measure P is absolutely continuous w.r.t. the
measure Q
P is equivalent to Q, i.e. P Q and Q P the expectation operator w.r.t. the measures Qx, R(s,x) and Qs,x, respectively
the expectation w.r.t. the measure Q
the expectation w.r.t. a measure which is clear from the context (usually P 0)
the minimum of s and t (= min(s, t))
the maximum of s and t (= max(s, t))
the transposed of the matrix 
the unit point mass at x
ij = 1 if i = j, ij = 0 if i = j the shift operator: t(f (Xs)) = f (Xt+s) (Chapter 7)
portfolio (see (12.1.3))
= (t) · X(t), the value process (see (12.1.4))
t
= z + (s)dX(s), the value generated at time t by
0
the self-financing portfolio  if the initial value is z
(see (12.1.7))
the normalized price vector (see (12.1.8)­(12.1.11))
the discounting factor (see (12.1.9))
equal to by definition
the same as lim inf, lim sup
sup{M  R ; f  M a.s.}
inf{N  R ; f  N a.s.}
end of proof

"increasing" is used with the same meaning as "nondecreasing", "decreasing" with the same meaning as "nonincreasing". In the strict cases "strictly increasing/strictly decreasing" are used.

328 List of Frequently Used Notation and Symbols

Index

adapted process 25 admissible portfolio 251 American call option 284, 289 American contingent T -claim 276 American options 275­284 American put option 283­284 American put option, perpetual 289 analytic functions (and Brownian
motion) 76, 150 arbitrage 251 attainable claim 260
Bayes' rule 152 (8.6.3) Bellman principle 241 Bessel process 49, 140 bequest function 223 Black and Scholes formula 4, 160, 274,
288 Borel sets, Borel -algebra 8 Borel-Cantelli lemma 16 Brownian bridge 75 Brownian motion, in Rn 3, 11­14 Brownian motion, complex 76 Brownian motion, on the ellipse 73 Brownian motion, on the unit circle
65, 121 Brownian motion, on the unit sphere
149 Brownian motion, on a Riemannian
manifold 150 Brownian motion, the graph of 118 Brownian motion, w.r.t. an increasing
family Ht of -algebras 70
capacity 163 carrying capacity 77 characteristic function 292 characteristic operator 120 change of time 145 change of variable in an It^o integral
148

Chebychev's inequality 16 coincide in law 140, 141 combined Dirichlet-Poisson problem
165­167, 182 complete market 260 complete probability space 8 complex Brownian motion 76 conditional expectation 295 conditioned Brownian motion 127 contingent T -claim (American) 276 contingent T -claim (European) 259 continuation region 201 continuous in mean square 40 control, deterministic (open loop) 225 control, feedback (closed loop) 225 control, Markov 225 control, optimal 224 convolution 302 covariance matrix 12, 291 cross-variation processes 152 crowded environment 77
density (of a random variable) 15 diffusion, It^o 107 diffusion, Dynkin 121 diffusion coefficient 107 Dirichlet problem 2, 167 Dirichlet problem (generalized) 174 Dirichlet problem (stochastic version)
170 Dirichlet-Poisson problem 165­167,
182 distribution (of a random variable) 9 distribution (of a process) 10 distribution function (of a random
variable) 15 Doob-Dynkin lemma 8­9 Doob-Meyer decomposition 279 drift coefficient 107 Dudley's theorem 253 Dynkin's formula 118

329

330 Index

eigenvalues (of the Laplacian) 187 elementary function/process 26 elliptic partial differential operator
165, 176 equivalent martingale measure 254,
264 estimate (linear/measurable) 85
estimation of a parameter 97 estimation, exact asymptotic 101, 102 European call option 4, 265, 288­289 European contingent T -claim 259 European option 265 European put option 266 events 8 excessive function 197 expectation 9 explosion (of a diffusion) 66, 78 exponential martingale 55
Feller-continuity 133 Feynman-Kac formula 135, 190 filtering problem, general 2, 79­81 filtering problem, linear 81­101 filtration 31, 38 finite-dimensional distributions (of a
stochastic process) 10 first exit distribution 130, 192 first exit time 111
Gaussian process 12 generalized (distribution valued)
process 21 generator (of an It^o diffusion) 115,
117 geometric Brownian motion 62 Girsanov's theorem 60, 153­158 Girsanov transformation 153 Green formula 184 Green function 163, 183, 191 Green function (classical) 183, 185 Green measure 18, 183, 238 Green operator 164 Gronwall inequality 68, 78
Hamilton-Jacobi-Bellman (HJB) equation 226­230 harmonic extension (w.r.t. an It^o
diffusion) 122 harmonic function (and Brownian
motion) 150 harmonic function (w.r.t. a diffusion)
169

harmonic measure (of Brownian motion) 124
harmonic measure (of a diffusion) 114, 115, 129
hedging portfolio 260 Hermite polynomials 38 high contact (smooth fit) principle
210, 212, 218 hitting distribution 114, 115 Ht-Brownian motion 70 h-transform (of Brownian motion)
127 Hunt's condition (H) 175
independent 9 independent increments 13, 22 innovation process 82, 86, 87, 90 integration by parts (stochastic) 46,
55 interpolation (smoothing) 103 irregular point 172, 188 iterated It^o integrals 38 iterated logarithm (law of) 64 It^o diffusion 107 It^o integral 24­37 It^o integral; multidimensional 34, 35 It^o interpretation (of a stochastic
differential equation) 36, 61, 79 It^o isometry 26, 29 It^o process 44, 48 It^o representation theorem 51 It^o's formula 44, 48
Jensen inequality 296
Kalman-Bucy filter 2, 95, 100 Kazamaki condition 55 kernel function 127 killing (a diffusion) 137 killing rate 138, 164 Kolmogorov's backward equation 131 Kolmogorov's continuity theorem 14 Kolmogorov's extension theorem 11 Kolmogorov's forward equation 159
Langevin equation 74 Laplace operator  3, 57 Laplace-Beltrami operator 150 law of iterated logarithm 64 least superharmonic majorant 196 least supermeanvalued majorant 196 Levy's characterization of Brownian
motion 152 Levy's theorem 151

Index 331

linear regulator problem 231 Lipschitz surface 213, 301 local martingale 126 local time 58, 59, 72 Lyapunov equation 103
Malliavin derivative 53 market 247 market, complete 260 market, normalized 247, 248 Markov control 225 Markov process 110 Markov property 109 martingale 31, 33, 298 martingale, local 126 martingale convergence theorem 298 martingale inequality 31 martingale problem 138 martingale representation theorem
49, 53 maximum likelihood 98 maximum principle 189 mean-reverting Ornstein-Uhlenbeck
process 74 mean square error 92 mean value property, classical 124 mean value property (for a diffusion)
114, 115 measurable function (w.r.t. a -algebra)
8 measurable sets (w.r.t. a -algebra) 8 measurable space 7 moving average, exponentially weighted
97
noise 1­4, 21­22, 61 normal distribution 12, 291 normalization (of a market process)
248 Novikov condition 55 numeraire 248
observation process 80 optimal control 224 optimal performance 224 optimal portfolio selection 4, 234 optimal stopping 3, 193­215 optimal stopping time 193, 199, 202,
213 optimal stopping existence theorem
199 optimal stopping uniqueness theorem
202 option pricing 4, 265­284

Ornstein-Uhlenbeck equation/process 74
orthogonal increments 82
path (of a stochastic process) 10 performance function 224 Perron-Wiener-Brelot solution 178 Poisson formula 189 Poisson kernel 189 Poisson problem 168 Poisson problem (generalized) 180 Poisson problem (stochastic version)
180 polar set 162, 175 population growth 1, 61, 77 portfolio 4, 236, 248­251 prediction 103 probability measure 7 probability space 8 p'th variation process 19
quadratic variation process 19, 56
random time change 145 random variable 9 recurrent 120 regular point 172­174, 188 replicating portfolio 260 resolvent operator 133 reward function 193 reward rate function 194 Riccati equation 93, 95, 101, 233
scaling (Brownian) 19 self-financing portfolio 248 semi-elliptic partial differential operator
165 semi-polar set 175 separation principle 225, 233 shift operator 113 Snell envelope 279 smoothing (interpolation) 103 stationary process 21, 22 stochastic control 4, 223­240 stochastic differential equation;
definition 61 stochastic differential equation;
existence and uniqueness of solution 66 stochastic differential equation; weak and strong solution 70 stochastic Dirichlet problem 170 stochastic integral 44 stochastic Poisson problem 180

332

View publication stats
Index

stochastic process 9 stopping time 57, 110 Stratonovich integral 24, 35­37, 39, 40 Stratonovich interpretation (of a
stochastic differential equation) 36, 62, 63, 64, 79 strong Feller process 177 strong Markov property 110­113 strong solution (of a stochastic differential equation) 70 strong uniqueness (of a stochastic differential equation) 67, 71 submartingale 298 superharmonic function 194 superharmonic majorant 196 supermartingale (126), 196, 253, 266, 279, 298 supermeanvalued function 194 supermeanvalued majorant 196 superreplicate 279 support (of a diffusion) 105
Tanaka's equation 71 Tanaka's formula 58, 59, 72 terminal conditions (in stochastic
control) 239­240, 245 thin set 175 time-homogeneous 108 time change formula It^o integrals 148 total variation process 19 transient 120 transition measure 184 transition operator 164 trap 121
uniformly elliptic partial differential operator 176, 269
uniformly integrable 297­298 utility function 4, 234
value function 224 value process 248 value process, normalized 249 variational inequalities (and optimal
stopping) 3, 212­215 version (of a process) (12), 14, 32 Volterra equation, deterministic 89 Volterra equation, stochastic 75
weak solution (of a stochastic differential equation) 70
weak uniqueness 71 well posed (martingale problem) 139 white noise 21, 61

Wiener criterion 174
X-harmonic 169
zero-one law 171
-algebra 7 -algebra, generated by a family of sets
8 -algebra, generated by a random
variable 8

